var wikiSidebar,quiz={},maxCombinations;
I18n.scoped("quizzes",function(h){function q(c){$(".question_holder:visible");var d=$.extend({},quiz.defaultQuestionData,{question_name:h.t("default_quesiton_name","Question")},c),f=$("#question_template").clone(true);f.attr("id","").find(".question").attr("id","question_new");f.fillTemplateData({data:d,except:["answers"]});f.find(".original_question_text").fillFormData(d);if(d.answers){d.answer_count=d.answers.length;c.answer_type=d.answer_type;d.anwer_type=quiz.answerTypeDetails(d.question_type)}for(var j=
0;j<d.answer_count;j++){var l={answer_weight:j==0?100:0};d.answers&&d.answers[j]&&$.extend(l,d.answers[j]);f.find(".answers").append(s(l))}f.toggleClass("group",!!(c&&c.quiz_group_id));f.show();return f}function s(c){c.answer_weight=c.weight||c.answer_weight;c.answer_comment=c.comments||c.answer_comment;c.answer_text=c.text||c.answer_text;c.answer_html=c.html||c.answer_html;c.answer_comment_html=c.comments_html||c.answer_comment_html;c.answer_match_left=c.left||c.answer_match_left;c.answer_match_left_html=
c.left_html||c.answer_match_left_html;c.answer_match_right=c.right||c.answer_match_right;c.answer_exact=c.exact||c.answer_exact;c.answer_error_margin=c.answer_error_margin||c.margin;c.answer_range_start=c.start||c.answer_range_start;c.answer_range_end=c.end||c.answer_range_end;var d=$.extend({},quiz.defaultAnswerData,c),f=$("#answer_template").clone(true).attr("id",""),j=d.answer_type;if(j=="numerical_answer")j="numerical_"+d.numerical_answer_type;f.addClass("answer_for_"+c.blank_id);f.find(".answer_type").hide().filter("."+
j).show();f.find("div.answer_text").showIf(!c.answer_html);f.find("div.answer_match_left").showIf(!c.answer_match_left_html);f.find("div.answer_match_left_html").showIf(c.answer_match_left_html);delete d.answer_type;d.answer_weight=parseFloat(d.answer_weight);if(isNaN(d.answer_weight))d.answer_weight=0;f.fillFormData({answer_text:d.answer_text});f.fillTemplateData({data:d,htmlValues:["answer_html","answer_match_left_html","answer_comment_html"]});if(!d.answer_comment||d.answer_comment==""||d.answer_comment==
h.t("answer_comments","Answer comments"))f.find(".answer_comment_holder").hide();if(d.answer_weight==100)f.addClass("correct_answer");else if(d.answer_weight>0)f.addClass("correct_answer");else d.answer_weight<0&&f.addClass("negative_answer");f.show();return f}function w(c){c=$.extend({},quiz.defaultAnswerData,c);var d=$("#form_answer_template").clone(true).attr("id","");d.find(".answer_type").hide().filter("."+c.answer_type).show();c.answer_weight=parseFloat(c.answer_weight);if(isNaN(c.answer_weight))c.answer_weight=
0;quiz.updateFormAnswer(d,c,true);d.find("input[placeholder]").placeholder();d.show();return d}function v(c){var d={questions:[],points_possible:0},f=$("#questions").find(".question");if(c)f=c;f.each(function(j){var l=$(this),a=l.getTemplateData({textValues:["question_name","question_points","question_type","answer_selection_type","assessment_question_id","correct_comments","incorrect_comments","neutral_comments","matching_answer_incorrect_matches","equation_combinations","equation_formulas"],htmlValues:["question_text",
"text_before_answers","text_after_answers","correct_comments_html","incorrect_comments_html","neutral_comments_html"]});a=$.extend(a,l.find(".original_question_text").getFormData());a.assessment_question_bank_id=$(".question_bank_id").text()||"";if(a.text_before_answers)a.question_text=a.text_before_answers;var b=[];l.find(".matching_answer_incorrect_matches_list li").each(function(){b.push($(this).text())});a.matching_answer_incorrect_matches=b.join("\n");var e=$.extend({},d.defaultQuestionData,
a);e.answers=[];var g={},k=false;if(e.question_type=="multiple_dropdowns_question"||e.question_type=="fill_in_multiple_blanks_question"){k=true;l.find(".blank_id_select option").each(function(){g[$(this).text()]=true})}if(e.question_type!="calculated_question")l.find(".answer").each(function(){var m=$(this).getTemplateData({textValues:["answer_exact","answer_error_margin","answer_range_start","answer_range_end","answer_weight","numerical_answer_type","blank_id","id","match_id","answer_text","answer_match_left",
"answer_match_right","answer_comment"],htmlValues:["answer_html","answer_match_left_html","answer_comment_html"]});m=$.extend({},d.defaultAnswerData,m);k&&m.blank_id&&!g[m.blank_id]||e.answers.push(m)});else{e.formulas=[];l.find(".formulas_holder .formulas_list > div").each(function(){e.formulas.push($.trim($(this).text()))});e.variables=[];l.find(".variable_definitions_holder .variable_definitions tbody tr").each(function(){var m=$(this).getTemplateData({textValues:["name","min","max","scale"]});
e.variables.push(m)});e.answers=[];l.find(".equation_combinations tbody tr").each(function(){var m={};m.variables=[];$(this).find("td:not(.final_answer)").each(function(n){var u={};u.name=e.variables[n].name;u.value=parseFloat($(this).text(),10)||0;m.variables.push(u)});m.answer_text=parseFloat($(this).find(".final_answer").text(),10)||0;e.answers.push(m)});e.formula_decimal_places=parseInt(l.find(".formula_decimal_places").text(),10)||0;e.answer_tolerance=parseFloat(l.find(".answer_tolerance").text(),
10)||0}e.position=j;e.question_points=parseFloat(e.question_points);if(isNaN(e.question_points))e.question_points=0;d.points_possible+=e.question_points;d.questions.push(e)});return d}function x(c){var d={},f;for(f in c)if(f.indexOf("questions[question_0]")==0){var j=f.replace("questions[question_0]","question");d[j]=c[f]}return d}function i(c){var d={},f=f||null;if(f)d["quiz[assignment_id]"]=f;d["quiz[title]"]=c.quiz_name;for(var j in c.questions){f=c.questions[j];var l="questions[question_"+j+"]";
d[l+"[question_name]"]=f.question_name;d[l+"[assessment_question_id]"]=f.assessment_question_id;d[l+"[question_type]"]=f.question_type;d[l+"[points_possible]"]=f.question_points;d[l+"[correct_comments]"]=f.correct_comments;d[l+"[incorrect_comments]"]=f.incorrect_comments;d[l+"[neutral_comments]"]=f.neutral_comments;d[l+"[question_text]"]=f.question_text;d[l+"[position]"]=f.position;d[l+"[text_after_answers]"]=f.text_after_answers;d[l+"[matching_answer_incorrect_matches]"]=f.matching_answer_incorrect_matches;
for(var a in f.formulas){var b=l+"[formulas][formula_"+a+"]";d[b]=f.formulas[a]}for(a in f.variables){b=l+"[variables][variable_"+a+"]";d[b+"[name]"]=f.variables[a].name;d[b+"[min]"]=f.variables[a].min;d[b+"[max]"]=f.variables[a].max;d[b+"[scale]"]=f.variables[a].scale}d[l+"[answer_tolerance]"]=f.answer_tolerance;d[l+"[formula_decimal_places]"]=f.formula_decimal_places;for(a in f.answers){var e=f.answers[a];b=l+"[answers][answer_"+a+"]";d[b+"[answer_text]"]=e.answer_text;d[b+"[answer_html]"]=e.answer_html;
d[b+"[answer_comments]"]=e.answer_comment;d[b+"[answer_comments_html]"]=e.answer_comment_html;d[b+"[answer_weight]"]=e.answer_weight;d[b+"[answer_match_left]"]=e.answer_match_left;d[b+"[answer_match_left_html]"]=e.answer_match_left_html;d[b+"[answer_match_right]"]=e.answer_match_right;d[b+"[numerical_answer_type]"]=e.numerical_answer_type;d[b+"[answer_exact]"]=e.answer_exact;d[b+"[answer_error_margin]"]=e.answer_error_margin;d[b+"[answer_range_start]"]=e.answer_range_start;d[b+"[answer_range_end]"]=
e.answer_range_end;d[b+"[blank_id]"]=e.blank_id;d[b+"[match_id]"]=e.match_id;d[b+"[id]"]=e.id;for(var g in e.variables){var k=b+"[variables][variable_"+g+"]";d[k+"[name]"]=e.variables[g].name;d[k+"[value]"]=e.variables[g].value}}}return d}function o(c,d,f){if((html=d[f+"_html"])&&html.length>0){c.find("."+f+"_html").html(html).css("display","inline-block");c.find("textarea").val(html);c.find("a,textarea").hide();c.removeClass("empty")}}quiz={uniqueLocalIDStore:{},init:function(){this.$questions=$("#questions");
this.$showDetailsWrap=$("#show_question_details_wrap").hide();return this},checkShowDetails:function(){this.$showDetailsWrap[this.$questions.find("fieldset:not(.essay_question, .text_only_question)").length?"show":"hide"](200)},generateUniqueLocalID:function(c){var d="object";if(c.attr("class"))d=c.attr("class").indexOf(" ")!=-1?c.attr("class").split(" ")[0]:c.attr("class");c=Math.floor(Math.random()*99999);for(c=d+"_"+c;quiz.uniqueLocalIDStore[c];){c=Math.floor(Math.random()*99999);c=d+"_"+c}quiz.uniqueLocalIDStore[c]=
true;return c},updateFormAnswer:function(c,d,f){var j=d.question_type;f=f?{}:c.getFormData();d=$.extend({},quiz.defaultAnswerData,f,d);c.find(".answer_type").hide().filter("."+d.answer_type).show();d.answer_weight=parseFloat(d.answer_weight);if(isNaN(d.answer_weight))d.answer_weight=0;c.fillFormData(d,{call_change:false});c.find(".select_answer input").showIf(!d.answer_html);c.find(".matching_answer .answer_match_left").showIf(!d.answer_match_left_html);c.find(".matching_answer .answer_match_left_html").showIf(d.answer_match_left_html);
if(d.answer_comment||d.answer_comment_html)c.find(".answer_comments").removeClass("empty");d.answer_selection_type=d.answer_selection_type||quiz.answerSelectionType(d.question_type);if(d.answer_selection_type=="any_answer")c.addClass("correct_answer");else if(d.answer_selection_type=="matching")c.removeClass("correct_answer");else if(d.answer_selection_type!="multiple_answer"){f=c.parent().find(".answer");f.find(".answer").filter(".correct_answer").not(":first").removeClass("correct_answer");f.filter(".correct_answer").length===
0&&f.filter(":first").addClass("correct_answer");f.find(".select_answer_link").attr("title",h.t("titles.click_to_set_as_correct","Click to set this answer as correct"))}else{c.filter(".correct_answer").find(".select_answer_link").attr("title",h.t("titles.click_to_unset_as_correct","Click to unset this answer as correct"));c.filter(":not(.correct_answer)").find(".select_answer_link").attr("title",h.t("titles.click_to_set_as_correct","Click to set this answer as correct"))}c.find(".numerical_answer_type").change();
f={answer_text:d.answer_text,id:d.id,match_id:d.match_id};f.comments_header=h.beforeLabel("comments_on_answer","Comments, if the user chooses this answer");f.short_answer_header=h.beforeLabel("possible_answer","Possible Answer");c.find(".comment_focus").attr("title",h.t("titles.click_to_enter_comments_on_answer","Click to enter comments for the student if they choose this answer"));if(j=="essay_question")f.comments_header=h.beforeLabel("comments_on_question","Comments for this question");else if(j==
"matching_question"){f.answer_match_left_html=d.answer_match_left_html;f.comments_header=h.beforeLabel("comments_on_wrong_match","Comments if the user gets this match wrong");c.find(".comment_focus").attr("title",h.t("titles.click_to_enter_comments_on_wrong_match","Click to enter comments for the student if they miss this match"))}else if(j=="missing_word_question")f.short_answer_header=h.beforeLabel("answer_text","Answer text");else if(j=="multiple_choice_question")f.answer_html=d.answer_html;else if(j==
"compare_fractions_question")f.answer_html=d.answer_html;else if(j=="locate_fractions_question")f.answer_html=d.answer_html;else if(j=="represent_fractions_question")f.answer_html=d.answer_html;else if(j=="multiple_answers_question"){f.answer_html=d.answer_html;f.short_answer_header=h.beforeLabel("answer_text","Answer text")}else if(j=="fill_in_multiple_blanks_question")f.blank_id=d.blank_id;else if(j=="multiple_dropdowns_question"){f.short_answer_header=h.t("answer_text","Answer text");f.blank_id=
d.blank_id}d.blank_id&&d.blank_id!="0"&&c.addClass("answer_for_"+d.blank_id);d.blank_index>=0&&c.addClass("answer_idx_"+d.blank_index);c.fillTemplateData({data:f,htmlValues:["answer_html","answer_match_left_html"]});o(c,d,"answer_comment");if(d.answer_weight>0){c.addClass("correct_answer");d.answer_selection_type=="multiple_answer"&&c.find(".select_answer_link").attr("title",h.t("titles.click_to_unset_as_correct","Click to unset this answer as correct"))}else d.answer_weight<0&&c.addClass("negative_answer");
j=="matching_question"&&c.removeClass("correct_answer")},questionContentCounter:0,showFormQuestion:function(c){if(!c.attr("id")){c.show();c.find(".question_content").attr("id","question_content_"+quiz.questionContentCounter++);c.find(".question_content").editorBox();c.find(".text_after_answers").attr("id","text_after_answers_"+quiz.questionContentCounter++);c.find(".text_after_answers").editorBox();c.hide()}return c.show()},answerTypeDetails:function(c){var d,f,j="one";if(c=="multiple_choice_question"){d=
"select_answer";f="multiple_choice_question"}else if(c=="compare_fractions_question"){d="select_answer";f="compare_fractions_question"}else if(c=="locate_fractions_question"){d="select_answer";f="locate_fractions_question"}else if(c=="represent_fractions_question"){d="select_answer";f="represent_fractions_question"}else if(c=="true_false_question"){d="select_answer";f="true_false_question"}else if(c=="short_answer_question"){d="short_answer";f="short_answer_question";j="all"}else if(c=="fill_in_multiple_blanks_question"){d=
"short_answer";f="fill_in_multiple_blanks_question";j="all"}else if(c=="essay_question"){d="comment";f="essay_question";j="none"}else if(c=="matching_question"){d="matching_answer";f="matching_question";j="all"}else if(c=="missing_word_question"){d="select_answer";f="missing_word_question"}else if(c=="multiple_dropdowns_question"){d="select_answer";f="multiple_dropdowns_question";j="multiple"}else if(c=="numerical_question"){d="numerical_answer";f="numerical_question";j="all"}else if(c=="multiple_answers_question"){d=
"select_answer";f="multiple_answers_question";j="multiple"}else if(c=="calculated_question"){d="numerical_answer";f="question_question"}return{question_type:f,answer_type:d,n_correct:j}},answerSelectionType:function(c){var d="single_answer";if(c!="multiple_choice_question")if(c!="compare_fractions_question")if(c!="locate_fractions_question")if(c!="represent_fractions_question")if(c!="true_false_question")if(c=="short_answer_question")d="any_answer";else if(c=="essay_question")d="none";else if(c==
"matching_question")d="matching";else if(c!="missing_word_question")if(c=="numerical_question")d="any_answer";else if(c=="calculated_question")d="any_answer";else if(c!="multiple_dropdowns_question")if(c=="fill_in_multiple_blanks_question")d="any_answer";else if(c=="multiple_answers_question")d="multiple_answer";else if(c=="text_only_question")d="none";return d},addExistingQuestion:function(c){var d=$("#group_top_"+c.quiz_group_id),f=null;if(d.length>0){for(f=d.next();f.length>0&&!f.hasClass("group_bottom");)f=
f.next();if(f.length==0)f=null}$.extend(c,c.question_data);d=q(c);$("#unpublished_changes_message").slideDown();f?f.before(d):$("#questions").append(d);quiz.updateDisplayQuestion(d.find(".question:first"),c,true)},updateDisplayQuestion:function(c,d,f){fillArgs={data:d,except:["answers"],htmlValues:[]};f?fillArgs.htmlValues.push("question_text"):fillArgs.except.push("question_text");c.fillTemplateData(fillArgs);c.find(".original_question_text").fillFormData(d);c.find(".question_correct_comment").toggleClass("empty",
!d.correct_comments&&!d.correct_comments_html);c.find(".question_incorrect_comment").toggleClass("empty",!d.incorrect_comments&&!d.incorrect_comments_html);c.find(".question_neutral_comment").toggleClass("empty",!d.neutral_comments&&!d.neutral_comments_html);c.find(".answers").empty();c.find(".equation_combinations").empty();c.find(".equation_combinations_holder_holder").css("display","none");c.find(".multiple_answer_sets_holder").css("display","none");c.find(".variable_definitions_holder").css("display",
"none").find("tbody").empty();c.find(".formulas_holder").css("display","none").find(".formulas_list").empty();c.find(".question_points").text(d.points_possible);var j=quiz.answerTypeDetails(d.question_type),l=j.answer_type,a=j.question_type,b=j.n_correct;c.attr("class","question display_question").addClass(a||"text_only_question");if(d.question_type=="fill_in_multiple_blanks_question")c.find(".multiple_answer_sets_holder").css("display","");else d.question_type=="multiple_dropdowns_question"&&c.find(".multiple_answer_sets_holder").css("display",
"");var e=$(document.createElement("select")).addClass("answer_select"),g=false;if(d.question_type=="calculated_question"){$.each(d.variables,function(y,t){var p=$("<tr/>"),r=$("<td class='name'/>");r.text(t.name);p.append(r);r=$("<td class='min'/>");r.text(t.min);p.append(r);r=$("<td class='max'/>");r.text(t.max);p.append(r);r=$("<td class='scale'/>");r.text(t.scale);p.append(r);c.find(".variable_definitions_holder").css("display","");c.find(".variable_definitions tbody").append(p)});$.each(d.formulas,
function(y,t){var p=$("<div/>");p.text(t.formula);c.find(".formulas_holder").css("display","").find(".formulas_list").append(p)});c.find(".formula_decimal_places").text(d.formula_decimal_places);if(d.answers.length>0){c.find(".equation_combinations").append($("<thead/>"));c.find(".equation_combinations").append($("<tbody/>"));j=$("<tr/>");for(var k in d.answers[0].variables){var m=$("<th/>");m.text(d.answers[0].variables[k].name);j.append(m)}m=$("<th/>");m.text(h.t("final_answer","Final Answer"));
j.append(m);c.find(".equation_combinations_holder_holder").css("display","");c.find(".equation_combinations thead").append(j).show();$.each(d.answers,function(y,t){var p=$("<tr/>"),r;for(r in t.variables){var z=$("<td/>");z.text(t.variables[r].value);p.append(z)}z=$("<td class='final_answer'/>");r=t.answer;if(d.answerDecimalPoints||d.answer_tolerance){var B=parseFloat(d.answer_tolerance);B=B||Math.pow(0.1,d.answerDecimalPoints);r=r+" <span style='font-size: 0.8em;'>+/-</span> "+B;c.find(".answer_tolerance").text(B)}z.html(r);
p.append(z);c.find(".equation_combinations tbody").append(p)})}}else{j=$(document.createElement("option"));j.val("").text(h.t("choose_option","[ Choose ]"));e.append(j);$.each(d.answers,function(y,t){t.answer_type=l;if(b=="all")t.answer_weight=100;else if(b=="one"&&g)t.answer_weight=0;else if(b=="none")t.answer_weight=0;if(t.answer_weight>0)g=true;var p=s(t,f);c.find(".answers").append(p);p=$(document.createElement("option"));p.val("option_"+y).text(t.answer_text);e.append(p)})}c.find(".blank_id_select").empty();
if(d.question_type=="missing_word_question"){j=c.find(".question_text");j.html("<span class='text_before_answers'>"+d.question_text+"</span> ");j.append(e);j.append(" <span class='text_after_answers'>"+d.text_after_answers+"</span>")}else if(d.question_type=="multiple_dropdowns_question"||d.question_type=="fill_in_multiple_blanks_question"){var n={};$.each(d.answers,function(y,t){n[t.blank_id]=true});c.find(".blank_id_select").empty();for(k in n)if((m=k)&&n[k]){j=$("<option/>");j.val(m).text(m);c.find(".blank_id_select").append(j)}}c.find(".after_answers").empty();
if(d.question_type=="matching_question"){j=c.find(".after_answers");m=[];if(d.matches&&d.answers){var u={};for(k in d.answers)u[d.answers[k].match_id]=true;for(k in d.matches)u[d.matches[k].match_id]||m.push(d.matches[k].text)}else{m=d.matching_answer_incorrect_matches||"";if(typeof m=="string")m=m.split("\n")}k="";for(var A in m)if(m[A])k=k+"<li>"+$.htmlEscape(m[A])+"</li>";k&&j.append(h.beforeLabel("other_incorrect_matches","Other Incorrect Match Options")+"<ul class='matching_answer_incorrect_matches_list'>"+
k+"</ul>")}c.find(".blank_id_select").change();c.fillTemplateData({question_type:a,answer_selection_type:l});c.show();if(c.attr("id")=="question_new")if(a!="text_only_question"){quiz.defaultQuestionData.question_type=a;quiz.defaultQuestionData.answer_count=Math.min(c.find(".answers .answer").length,4)}$("html,body").scrollTo({top:c.offset().top-10,left:0});c.find(".question_points_holder").showIf(!c.closest(".question_holder").hasClass("group")&&d.question_type!="text_only_question");c.find(".unsupported_question_type_message").remove();
quiz.updateDisplayComments();if(d.id){c.fillTemplateData({data:{id:d.id},id:"question_"+d.id,hrefValues:["id"]});c.find(".original_question_text").fillFormData(d);quiz.updateDisplayComments()}},updateFormQuestion:function(c){var d=c.find(".question"),f=d.find(":input[name='question_type']").val(),j={};j.answer_type="select_answer";j.answer_selection_type=quiz.answerSelectionType(f);j.textValues=["answer_weight","answer_text","answer_comment","blank_id","id","match_id"];j.htmlValues=["answer_html",
"answer_match_left_html","answer_comment_html"];j.question_type=f;d.find(".explanation").hide().filter("."+f+"_explanation").show();d.attr("class","question").addClass("selectable");d.find(".missing_word_after_answer").hide().end().find(".matching_answer_incorrect_matches_holder").hide().end().find(".question_comment").css("display","").end();$("#questions").hasClass("survey_quiz")&&d.find(".question_comment").css("display","none").end().find(".question_neutral_comment").css("display","");d.find(".question_header").text("Question:");
d.addClass(f);d.find(".question_points_holder").showIf(!d.closest(".question_holder").hasClass("group")&&f!="text_only_question");d.find("textarea.comments").each(function(){$(this).val($.trim($(this).val()));$(this).val()?$(this).parents(".question_comment").removeClass("empty"):$(this).parents(".question_comment").addClass("empty")});var l={addable:true};if(f!="multiple_choice_question")if(f!="compare_fractions_question")if(f!="locate_fractions_question")if(f!="represent_fractions_question")if(f==
"true_false_question"){l.addable=false;var a=d.find(".form_answers .answer");if(a.length<2)for(var b=0;b<2-a.length;b++){var e=w({answer_type:"fixed_answer",question_type:"true_false_question"});d.find(".form_answers").append(e)}else if(a.length>2)for(b=2;b<a.length;b++)a.eq(b).remove();a={question_type:"true_false_question",answer_type:"fixed_answer",answer_text:h.t("true","True")};quiz.updateFormAnswer(d.find(".answer:first"),a);a.answer_text=h.t("false","False");quiz.updateFormAnswer(d.find(".answer:last"),
a);j.answer_type="fixed_answer"}else if(f=="short_answer_question"){d.removeClass("selectable");j.answer_type="short_answer"}else if(f=="essay_question"){d.find(".answer").remove();d.removeClass("selectable");d.find(".answers_header").hide().end().find(".question_comment").css("display","none").end().find(".question_neutral_comment").css("display","").end();l.addable=false;j.answer_type="none";j.textValues=[];j.htmlValues=[]}else if(f=="matching_question"){d.removeClass("selectable");c.find(".matching_answer_incorrect_matches_holder").show();
j.answer_type="matching_answer";j.textValues=["answer_match_left","answer_match_right","answer_comment"]}else if(f=="missing_word_question"){c.find(".missing_word_after_answer").show();c.find(".question_header").text("Text to go before answers:");j.answer_type="select_answer"}else if(f=="numerical_question"){d.removeClass("selectable");j.answer_type="numerical_answer";j.textValues=["numerical_answer_type","answer_exact","answer_error_margin","answer_range_start","answer_range_end"];j.html_values=
[]}else if(f=="calculated_question"){d.removeClass("selectable");j.answer_type="numerical_answer";j.textValues=["answer_combinations"];j.html_values=[];d.formulaQuestion()}else if(f=="multiple_dropdowns_question"){j.answer_type="select_answer";d.multipleAnswerSetsQuestion()}else if(f=="fill_in_multiple_blanks_question"){j.answer_type="short_answer";d.multipleAnswerSetsQuestion()}else if(f!="multiple_answers_question")if(f=="text_only_question"){l.addable=false;d.find(".answer").remove();d.removeClass("selectable");
d.find(".answers_header").hide().end().find(".question_comment").css("display","none");d.find(".question_header").text(h.beforeLabel("message_text","Message Text"));c.find(":input[name='question_points']").val(0);j.answer_type="none";j.textValues=[];j.htmlValues=[]}d.find(".answer.hidden").remove();c.find("input[name='answer_selection_type']").val(j.answer_selection_type).change();c.find(".add_answer_link").showIf(l.addable);a=d.find(".form_answers .answer");if(a.length===0&&j.answer_type!="none"){d.find(".form_answers").append(w({answer_type:j.answer_type,
question_type:f}));d.find(".form_answers").append(w({answer_type:j.answer_type,question_type:f}));a=d.find(".form_answers .answer")}if(j.answer_selection_type=="any_answer")a.addClass("correct_answer");else if(j.answer_selection_type=="matching")a.removeClass("correct_answer");else if(j.answer_selection_type!="multiple_answer"){a.filter(".correct_answer").not(":first").removeClass("correct_answer");a.filter(".correct_answer").length===0&&a.filter(":first").addClass("correct_answer")}c.find(".answer").each(function(){var g=
0;if($(this).hasClass("correct_answer"))g=100;$(this).find(".answer_weight").text(g);quiz.updateFormAnswer($(this),j)});c.find(".answer_type").hide().filter("."+j.answer_type).show();return j},updateDisplayComments:function(){this.checkShowDetails();$(".question_holder > .question > .question_comment").each(function(){var d=$.trim($(this).find(".question_comment_text").html());$(this).css("display","").toggleClass("empty",!d)});$(".question_holder .answer_comment_holder").each(function(){var d=$.trim($(this).find(".answer_comment").html());
$(this).css("display","").toggleClass("empty",!d)});var c=0;$("#questions .question_holder:not(.group) .question:not(#question_new)").each(function(){var d=parseFloat($(this).find(".question_points:visible,.question_points.hidden").text());if(isNaN(d))d=0;c+=d});$("#questions .group_top:not(#group_top_new)").each(function(){var d=parseFloat($(this).find(".question_points").text());if(isNaN(d))d=0;var f=parseInt($(this).find(".pick_count").text(),10);if(isNaN(f))f=0;c+=d*f});c=Math.round(c*100)/100;
$("#quiz_options_form").find(".points_possible").text(c)},findContainerGroup:function(c){for(c=c.prev();c.length>0;){if(c.hasClass("group_top"))return c;else if(c.hasClass("group_bottom"))break;c=c.prev()}return null},parseInput:function(c,d){if(c.val()!="")if(d=="int"){var f=parseInt(c.val(),10);if(isNaN(f))f=0;c.val(f)}else if(d=="float"){f=Math.round(parseFloat(c.val())*100)/100;if(isNaN(f))f=0;c.val(f)}else if(d=="float_long"){f=Math.round(parseFloat(c.val())*1E4)/1E4;if(isNaN(f))f=0;c.val(f)}},
defaultQuestionData:{question_type:"compare_fractions_question",question_text:"",question_points:1,question_name:h.t("default_question_name","Question"),answer_count:4},defaultAnswerData:{answer_type:"select_answer",answer_comment:"",answer_weight:0,numerical_answer_type:"exact_answer",answer_exact:"",answer_error_margin:"",answer_range_start:"",answer_range_end:""}};$(document).ready(function(){quiz.init().updateDisplayComments();var c=$("#quiz_options_form");$.scrollSidebar();$(".datetime_field").datetime_field();
$("#questions").delegate(".group_top,.question,.answer_select","mouseover",function(){$(this).addClass("hover")}).delegate(".group_top,.question,.answer_select","mouseout",function(){$(this).removeClass("hover")});$("#questions").delegate(".answer","mouseover",function(){$("#questions .answer.hover").removeClass("hover");$(this).addClass("hover")}).delegate(".answer","mouseout",function(){});c.find("#extend_due_at").change(function(){$("#quiz_lock_after").showIf($(this).attr("checked"))}).change();
c.find("#multiple_attempts_option").change(function(){$("#multiple_attempts_suboptions").showIf($(this).attr("checked"));var a=$("#multiple_attempts_suboptions #quiz_allowed_attempts");a.val()=="-1"&&a.val("1")}).triggerHandler("change");c.find("#time_limit_option").change(function(){$(this).attr("checked")||$("#quiz_time_limit").val("")}).triggerHandler("change");$("#limit_attempts_option").change(function(){var a=$("#quiz_allowed_attempts");if($(this).attr("checked")){var b=parseInt(a.data("saved_value")||
a.val()||"2",10);if(b==-1||isNaN(b))b=1;a.val(b)}else{a.data("saved_value",$(this).val());a.val("--")}}).triggerHandler("change");$("#protect_quiz").change(function(){var a=$(this).attr("checked");$(".protected_options").showIf(a).find(":checkbox").each(function(){a||$(this).attr("checked",false).change()})}).triggerHandler("change");$("#quiz_require_lockdown_browser").change(function(){$("#lockdown_browser_suboptions").showIf($(this).attr("checked"));$("#quiz_require_lockdown_browser_for_results").attr("checked",
true).change()});$("#lockdown_browser_suboptions").showIf($("#quiz_require_lockdown_browser").attr("checked"));$("#ip_filter").change(function(){$("#ip_filter_suboptions").showIf($(this).attr("checked"));$(this).attr("checked")||$("#quiz_ip_filter").val("")}).triggerHandler("change");$("#ip_filters_dialog").delegate(".ip_filter","click",function(a){a.preventDefault();a=$(this).getTemplateData({textValues:["filter"]}).filter;$("#protect_quiz").attr("checked",true).triggerHandler("change");$("#ip_filter").attr("checked",
true).triggerHandler("change");$("#quiz_ip_filter").val(a);$("#ip_filters_dialog").dialog("close")});$(".ip_filtering_link").click(function(a){a.preventDefault();var b=$("#ip_filters_dialog");b.dialog("close").dialog({autoOpen:false,width:400,title:h.t("titles.ip_address_filtering","IP Address Filtering")}).dialog("open");if(!b.hasClass("loaded")){b.find(".searching_message").text(h.t("retrieving_filters","Retrieving Filters..."));a=$("#quiz_urls .filters_url").attr("href");$.ajaxJSON(a,"GET",{},
function(e){b.addClass("loaded");if(e.length){for(var g in e){var k=e[g],m=b.find(".ip_filter.blank:first").clone(true).removeClass("blank");m.fillTemplateData({data:k});b.find(".filters tbody").append(m.show())}b.find(".searching_message").hide().end().find(".filters").show()}else b.find(".searching_message").text(h.t("no_filters_found","No filters found"))},function(){b.find(".searching_message").text(h.t("errors.retrieving_filters_failed","Retrieving Filters Failed"))})}});$("#require_access_code").change(function(){$("#access_code_suboptions").showIf($(this).attr("checked"));
$(this).attr("checked")||$("#quiz_access_code").val("")}).triggerHandler("change");$("#never_hide_results").change(function(){$(".show_quiz_results_options").showIf($(this).attr("checked"));if(!$(this).attr("checked")){$("#hide_results_only_after_last").attr("checked",false);$("#quiz_show_correct_answers").attr("checked",false)}}).triggerHandler("change");$("#multiple_attempts_option,#limit_attempts_option,#quiz_allowed_attempts").bind("change",function(){var a=$("#multiple_attempts_option").attr("checked")&&
$("#limit_attempts_option").attr("checked"),b=parseInt($("#quiz_allowed_attempts").val(),10);if(a&&b&&b>0)$("#hide_results_only_after_last_holder").show();else{$("#hide_results_only_after_last").attr("checked",false);$("#hide_results_only_after_last_holder").hide()}}).triggerHandler("change");c.find(".save_quiz_button").click(function(){c.data("activator","save")});c.find(".publish_quiz_button").click(function(){c.data("activator","publish")});c.formSubmit({object_name:"quiz",required:["title"],processData:function(a){$(this).attr("method",
"PUT");$(this).data("submit_type")=="save_only"&&delete a.activate;a["quiz[description]"]=$("#quiz_description").editorBox("get_code");var b=1;if(a.multiple_attempts){b=parseInt(a.allowed_attempts,10);if(isNaN(b)||!a.limit_attempts)b=-1}a.allowed_attempts=b;a["quiz[allowed_attempts]"]=b;return a},beforeSubmit:function(){$(this).find(".button.save_quiz_button").attr("disabled",true);$(this).find(".button.publish_quiz_button").attr("disabled",true);$(this).data("activator")=="publish"?$(this).find(".button.publish_quiz_button").text(h.t("buttons.publishing",
"Publishing...")):$(this).find(".button.save_quiz_button").text(h.t("buttons.saving","Saving..."))},success:function(a){var b=$(this);$(this).find(".button.save_quiz_button").attr("disabled",false);$(this).find(".button.publish_quiz_button").attr("disabled",false);$(this).data("activator")=="publish"?$(this).find(".button.publish_quiz_button").text(h.t("buttons.published","Published!")):$(this).find(".button.save_quiz_button").text(h.t("buttons.saved","Saved!"));setTimeout(function(){b.find(".button.save_quiz_button").text(h.t("buttons.save_settings",
"Save Settings"))},2500);if(a.quiz.assignment){var e=a.quiz.assignment;if($("#assignment_option_"+e.id).length===0){if(e.assignment_group&&$("#assignment_group_optgroup_"+e.assignment_group_id).length===0){var g=e.assignment_group;$(document.createElement("optgroup")).attr("label",g.name).attr("id","assignment_group_optgroup_"+g.id)}g=$("#assignment_group_optgroup_"+e.assignment_group_id);var k=$(document.createElement("option"));k.attr("id","assignment_option_"+e.id).val(e.id).text(e.title);g.append(k)}}$(".show_rubric_link").showIf(a.quiz.assignment);
$("#quiz_assignment_id").val(a.quiz.quiz_type||"practice_quiz").change();if($(this).data("submit_type")=="save_and_publish")location.href=$(this).attr("action");else $.flashMessage(h.t("notices.quiz_data_saved","Quiz data saved"));quiz.updateDisplayComments()},error:function(a){$(this).formErrors(a);$(this).find(".button.save_quiz_button").attr("disabled",false);$(this).find(".button.publish_quiz_button").attr("disabled",false)}});c.find(".save_quiz_button").click(function(a){a.preventDefault();a.stopPropagation();
c.data("submit_type","save_only").submit()}).end().find(".publish_quiz_button").click(function(a){a.preventDefault();a.stopPropagation();c.data("submit_type","save_and_publish").submit()});$("#show_question_details").change(function(){$("#questions").toggleClass("brief",!$(this).attr("checked"))}).triggerHandler("change");$(".start_over_link").click(function(a){a.preventDefault();if(confirm(h.t("confirms.scrap_and_restart","Scrap this quiz and start from scratch?")))location.href+="?fresh=1"});$("#quiz_assignment_id").change(function(){var a=
$("#quiz_options").getTemplateData({textValues:["assignment_id","title"]}),b=$("#quiz_assignment_id").val(),e=$("#quiz_title_input").val();if(b){a=$("#quiz_assignment_id")[0];e=$(a.options[a.selectedIndex]).text()}else if(a.assignment_id)e=h.t("default_quiz_title","Quiz");$("#quiz_title").showIf(true);$("#quiz_options_form .quiz_survey_setting").showIf(b&&b.match(/survey/));$("#quiz_points_possible").showIf(b=="graded_survey");$("#survey_instructions").showIf(b=="survey"||b=="graded_survey");$("#quiz_assignment_group").showIf(b==
"assignment"||b=="graded_survey");$("#questions").toggleClass("survey_quiz",b=="survey"||b=="graded_survey");$("#quiz_display_points_possible").showIf(b!="survey"&&b!="graded_survey");$("#quiz_options_holder").toggleClass("survey_quiz",b=="survey"||b=="graded_survey");$("#quiz_urls .update_quiz_url").attr("href");$("#quiz_title_input").val(e);$("#quiz_title_text").text(e)}).change();$(".question_form :input").keycodes("esc",function(){$(this).parents("form").find("input[value='"+h.t("#buttons.cancel",
"Cancel")+"']").click()});$(document).delegate(".blank_id_select","change",function(){var a=$(this).val(),b=$(this)[0].selectedIndex;$(this).closest(".question").find(".answer").css("display","none");if(a){a!="0"&&$(this).closest(".question").find(".answer.answer_idx_"+b).filter(":not(.answer_for_"+a+")").each(function(){$(this).attr("class",$(this).attr("class").replace(/answer_for_[A-Za-z0-9]+/g,""));$(this).addClass("answer_for_"+a)});$(this).closest(".question").find(".answer.answer_for_"+a).css("display",
"")}else{$(this).closest(".question").find(".answer").css("display","");$(this).closest(".question").find(".answer.answer_idx_"+b).css("display","")}});$(".blank_id_select").change();$(document).delegate(".delete_question_link","click",function(a){a.preventDefault();$(this).parents(".question_holder").confirmDelete({url:$(this).parents(".question_holder").find(".update_question_url").attr("href"),message:h.t("confirms.delete_question","Are you sure you want to delete this question?"),success:function(){$(this).remove();
quiz.updateDisplayComments()}})});$(document).delegate(".edit_question_link","click",function(a){a.preventDefault();a=$(this).parents(".question");var b=a.getTemplateData({textValues:["question_type","correct_comments","incorrect_comments","neutral_comments","question_name","question_points","answer_selection_type","blank_id"],htmlValues:["question_text","correct_comments_html","incorrect_comments_html","neutral_comments_html"]});b.question_text=a.find("textarea[name='question_text']").val();var e=
[];a.find(".matching_answer_incorrect_matches_list li").each(function(){e.push($(this).text())});b.matching_answer_incorrect_matches=e.join("\n");b.question_points=parseFloat(b.question_points,10);if(isNaN(b.question_points))b.question_points=0;var g=$("#question_form_template").clone(true).attr("id",""),k=g.find(".question");g.fillFormData(b);o(g.find(".question_correct_comment"),b,"correct_comments");o(g.find(".question_incorrect_comment"),b,"incorrect_comments");o(g.find(".question_neutral_comment"),
b,"neutral_comments");k.addClass("selectable");g.find(".answer_selection_type").change().show();b.question_type!="missing_word_question"&&g.find("option.missing_word").remove();if(a.hasClass("missing_word_question")||b.question_type=="missing_word_question"){b=a.getTemplateData({textValues:["text_before_answers","text_after_answers"]});answer_data=a.find(".original_question_text").getFormData();b.text_before_answers=answer_data.question_text;b.text_after_answers=answer_data.text_after_answers;b.question_text=
b.text_before_answers;g.fillFormData(b)}var m=quiz.updateFormQuestion(g);g.find(".form_answers").empty();if(m.question_type=="calculated_question"){b=v(a).questions[0];g.find(".combinations_holder .combinations thead tr").empty();for(var n in b.variables){var u=$(g.find(".variables .variable."+b.variables[n].name));if(b.variables[n].name=="variable")u=$(g.find(".variables .variable").get(n));if(u&&u.length>0){u.find(".min").val(b.variables[n].min);u.find(".max").val(b.variables[n].max);u.find(".round").val(b.variables[n].scale)}u=
$("<th/>");u.text(b.variables[n].name);g.find(".combinations_holder .combinations thead tr").append(u)}u=$("<th class='final_answer'/>");u.text(h.t("final_answer","Final Answer"));g.find(".combinations_holder .combinations thead tr").append(u);for(n in b.formulas){g.find(".supercalc").val(b.formulas[n]);g.find(".decimal_places .round").val(b.formula_decimal_places);g.find(".save_formula_button").click()}b.answer_tolerance&&g.find(".combination_answer_tolerance").val(b.answer_tolerance);g.find(".combination_count").val(b.answers.length);
for(n in b.answers){u=$("<tr/>");for(var A in b.answers[n].variables){var y=$("<td/>");y.text(b.answers[n].variables[A].value);u.append(y)}var t=b.answers[n].answer_text;if(b.answer_tolerance)t=t+" <span style='font-size: 0.8em;'>+/-</span> "+b.answer_tolerance;y=$("<td class='final_answer'/>");y.html(t);u.append(y);g.find(".combinations tbody").append(u);g.find(".combinations_holder").show()}g.triggerHandler("settings_change",false);k.triggerHandler("recompute_variables",true)}else a.find(".answers .answer").each(function(){var p=
$(this).getTemplateData({textValues:m.textValues,htmlValues:m.htmlValues});p.answer_type=m.answer_type;p.question_type=m.question_type;p=w(p);g.find(".form_answers").append(p)});a.hasClass("essay_question")&&k.find(".comments_header").text(h.beforeLabel("comments_on_question","Comments for this question"));a.hide().after(g);quiz.showFormQuestion(g);g.attr("action",a.find(".update_question_url").attr("href")).attr("method","POST").find(".submit_button").text(h.t("buttons.update_question","Update Question"));
g.find(":input:visible:first").focus().select();$("html,body").scrollTo({top:g.offset().top-10,left:0});setTimeout(function(){k.find(".question_content").triggerHandler("change");k.addClass("ready")},100)});$(".question_form :input[name='question_type']").change(function(){quiz.updateFormQuestion($(this).parents(".question_form"))});$("#question_form_template .cancel_link").click(function(a){a.preventDefault();a=$(this).parents("form").prev();var b=a.attr("id")=="question_new";b||$(this).parents("form").remove();
a.show();$("html,body").scrollTo({top:a.offset().top-10,left:0});if(b){a.parent().remove();quiz.updateDisplayComments()}quiz.updateDisplayComments()});$(document).delegate("a.comment_focus","focus click",function(a){a.preventDefault();$(this).parents(".question_comment,.answer_comments").removeClass("empty").find("textarea.comments").focus().select()});$(document).delegate("textarea.comments","focus",function(){$(this).parents(".question_comment,.answer_comments").removeClass("empty")}).delegate("textarea.comments",
"blur",function(){$(this).val($.trim($(this).val()));$(this).val()==""&&$(this).parents(".question_comment,.answer_comments").addClass("empty")});$(document).delegate(".numerical_answer_type","change",function(){var a=$(this).val(),b=$(this).parents(".numerical_answer");b.find(".numerical_answer_text").hide();b.find("."+a).show()}).change();$(document).delegate(".select_answer_link","click",function(a){a.preventDefault();a=$(this).parents(".question");if(a.hasClass("selectable")){if(a.find(":input[name='question_type']").val()!=
"multiple_answers_question"){a.find(".answer:visible").removeClass("correct_answer");$(this).parents(".answer").addClass("correct_answer")}else{$(this).parents(".answer").toggleClass("correct_answer");$(this).parents(".answer").hasClass("correct_answer")?$(this).attr("title",h.t("titles.click_to_unset_as_correct","Click to unset this answer as correct")):$(this).attr("title",h.t("titles.click_to_set_as_correct","Click to set this answer as correct"))}$(this).blur()}});$(".question_form :input").change(function(){$(this).parents(".answer").length>
0&&$(this).parents(".answer").find(":input[name='"+$(this).attr("name")+"']").val($(this).val())});$(".question_form select.answer_selection_type").change(function(){$(this).val()=="single_answer"?$(this).parents(".question").removeClass("multiple_answers"):$(this).parents(".question").addClass("multiple_answers")}).change();$(".delete_answer_link").click(function(a){a.preventDefault();$(this).parents(".answer").remove()});$(".add_question_group_link").click(function(a){a.preventDefault();$(".question_form .submit_button:visible,.quiz_group_form .submit_button:visible").each(function(){$(this).parents("form").submit()});
a=$("#group_top_template").clone(true).attr("id","group_top_new");var b=$("#group_bottom_template").clone(true).attr("id","group_bottom_new");$("#questions").append(a.show()).append(b.show());a.find(".edit_group_link").click();a.find(".quiz_group_form").attr("action",$("#quiz_urls .add_group_url").attr("href")).attr("method","POST");a.find(".submit_button").text(h.t("buttons.create_group","Create Group"))});$(".add_question_link").click(function(a){a.preventDefault();$(".question_form:visible,.group_top.editing .quiz_group_form:visible").submit();
a=q();if($(this).parents(".group_top").length>0){for(var b=$(this).parents(".group_top").next();b.length>0&&!b.hasClass("group_bottom");)b=b.next();b.before(a.addClass("group"))}else $("#questions").append(a);a.find(".edit_question_link:first").click();b=a.parents(".question_holder").children("form");b.attr("action",$("#quiz_urls .add_question_url,#bank_urls .add_question_url").attr("href")).attr("method","POST").find(".submit_button").html(h.t("buttons.create_question","Create Question"));b.find("option.missing_word").remove();
a.find(".question_type").change();$("html,body").scrollTo({top:a.offset().top-10,left:0});a.find(":input:first").focus().select()});var d=$("#find_bank_dialog");$(".find_bank_link").click(function(a){a.preventDefault();d.data("form",$(this).closest(".quiz_group_form"));if(!d.hasClass("loaded")){d.data("banks",{});d.find(".find_banks").hide();d.find(".message").show().text(h.t("loading_question_banks","Loading Question Banks..."));a=d.find(".find_question_banks_url").attr("href");$.ajaxJSON(a,"GET",
{},function(b){d.find(".message").hide();d.find(".find_banks").show();d.addClass("loaded");for(idx in b){var e=b[idx].assessment_question_bank;e.title=$.truncateText(e.title);var g=d.find(".bank.blank:first").clone(true).removeClass("blank");g.fillTemplateData({data:e,dataValues:["id","context_type","context_id"]});d.find(".bank_list").append(g);g.data("bank_data",e);g.show()}},function(){d.find(".message").text(h.t("errors.loading_banks_failed","Question Banks failed to load, please try again"))})}d.find(".bank.selected").removeClass("selected");
d.find(".submit_button").attr("disabled",true);d.dialog("close").dialog({autoOpen:false,title:h.t("titles.find_question_bank","Find Question Bank"),width:600,height:400}).dialog("open")});d.delegate(".bank","click",function(){d.find(".bank.selected").removeClass("selected");$(this).addClass("selected");d.find(".submit_button").attr("disabled",false)}).delegate(".submit_button","click",function(){var a=d.find(".bank.selected:first").getTemplateData({textValues:["title"],dataValues:["id","context_id",
"context_type"]}),b=d.data("form");b.find(".bank_id").val(a.id);a.bank_name=a.title;var e=b.closest(".group_top").next(".assessment_question_bank");if(e.length==0){e=$("#group_top_template").next(".assessment_question_bank").clone(true);b.closest(".group_top").after(e)}e.show().fillTemplateData({data:a}).data("bank_data",a);d.dialog("close")}).delegate(".cancel_button","click",function(){d.dialog("close")});var f=$("#find_question_dialog");$(".find_question_link").click(function(a){a.preventDefault();
if(!f.hasClass("loaded")){f.data("banks",{});f.find(".side_tabs_table").hide();f.find(".message").show().text(h.t("loading_question_banks","Loading Question Banks..."));a=f.find(".find_question_banks_url").attr("href");$.ajaxJSON(a,"GET",{},function(b){f.find(".message").hide();f.find(".side_tabs_table").show();f.addClass("loaded");for(idx in b){var e=b[idx].assessment_question_bank;e.title=$.truncateText(e.title);var g=f.find(".bank.blank:first").clone(true).removeClass("blank");g.fillTemplateData({data:e});
f.find(".bank_list").append(g);g.data("bank_data",e);g.show()}f.find(".bank:not(.blank):first").click()},function(){f.find(".message").text(h.t("errors.loading_banks_failed","Question Banks failed to load, please try again"))})}f.data("add_source","");f.dialog("close").dialog({autoOpen:false,title:h.t("titles.find_quiz_question","Find Quiz Question"),open:function(){f.find(".selected_side_tab").length==0&&f.find(".bank:not(.blank):first").click()},width:600,height:400}).dialog("open")});var j=function(a){f.find(".quiz_group_select").find("option.group").remove();
f.find(".quiz_group_select_holder").show();$("#questions .group_top:visible").each(function(){var b={};b.id=$(this).attr("id").substring(10);b.name=$(this).getTemplateData({textValues:["name"]}).name;var e=$("<option/>");e.text($.truncateText(b.name));e.val(b.id);e.addClass("group");f.find(".quiz_group_select option.bottom").before(e)});a&&$("#quiz_group_select").val(a);$("#quiz_group_select").val()=="new"&&$("#quiz_group_select").val("none");$("#quiz_group_select").change()};$("#quiz_group_select").change(function(){if($(this).val()==
"new"){var a=$("#add_question_group_dialog"),b=[];f.find(".question_list :checkbox:checked").each(function(){b.push($(this).parents(".found_question").data("question_data").id)});a.find(".questions_count").text(b.length);a.find("button").attr("disabled",false).filter(".submit_button").text(h.t("buttons.create_group","Create Group"));a.dialog("close").dialog({width:400,autoOpen:false}).dialog("open")}});$("#add_question_group_dialog .submit_button").click(function(){var a=$("#add_question_group_dialog");
a.find("button").attr("disabled",true).filter(".submit_button").text(h.t("buttons.creating_group","Creating Group..."));var b=a.getFormData(),e=a.find(".add_question_group_url").attr("href");$.ajaxJSON(e,"POST",b,function(g){a.find("button").attr("disabled",false).filter(".submit_button").text(h.t("buttons.create_group","Create Group"));var k=$("#group_top_template").clone(true).attr("id","group_top_new"),m=$("#group_bottom_template").clone(true).attr("id","group_bottom_new");$("#questions").append(k.show()).append(m.show());
var n=g.quiz_group;k.fillTemplateData({data:n,id:"group_top_"+n.id,hrefValues:["id"]});k.fillFormData(g,{object_name:"quiz_group"});$("#unpublished_changes_message").slideDown();m.attr("id","group_bottom_"+n.id);quiz.updateDisplayComments();j(g.quiz_group.id);a.dialog("close")},function(){a.find("button").attr("disabled",false).filter(".submit_button").text(h.t("errors.creating_group_failed","Create Group Failed, Please Try Again"))})});$("#add_question_group_dialog .cancel_button").click(function(){$("#add_question_group_dialog").dialog("close");
$("#quiz_group_select").val("none")});var l=function(a){a=a.questions;var b=f.find(".bank.selected_side_tab"),e=b.data("bank_data");e=f.data("banks")[e.id];if(b.hasClass("selected_side_tab")){var g={};$(".display_question:visible").each(function(){var n=parseInt($(this).getTemplateData({textValues:["assessment_question_id"]}).assessment_question_id,10);if(n)g[n]=true});f.find(".page_link").showIf(e.pages&&e.last_page&&e.pages>e.last_page);j();b=$("<div/>");for(var k in a){e=a[k].assessment_question;
b.html(e.question_data.question_text);e.question_text=$.truncateText(b.text(),75);e.question_name=e.question_data.question_name;var m=f.find(".found_question.blank").clone(true).removeClass("blank");m.toggleClass("already_added",!!g[e.id]);m.fillTemplateData({data:e});m.find(":checkbox").attr("id","find_bank_question_"+e.id);m.find("label").attr("for","find_bank_question_"+e.id);m.data("question_data",e);f.find(".question_list").append(m);m.show()}}};$("#find_question_dialog").delegate(".bank","click",
function(a){a.preventDefault();a=$(this).getTemplateData({textValues:["id"]}).id;a=f.data("banks")[a];f.find(".bank").removeClass("selected");f.find(".selected_side_tab").removeClass("selected_side_tab");$(this).addClass("selected_side_tab");f.find(".page_link").data("page",0);a&&a.last_page&&f.find(".page_link").data("page",a.last_page);if(a){f.find(".found_question:visible").remove();l(a)}else{f.find(".found_question:visible").remove();f.find(".page_link").click();f.find(".question_list_holder").hide();
f.find(".question_message").show().text(h.t("loading_questions","Loading Questions..."))}}).delegate(".page_link","click",function(a){a.preventDefault();var b=$(this);if(!b.hasClass("loading")){b.addClass("loading");f.find(".page_link").text(h.t("loading_more_questions","loading more questions..."));var e=f.find(".bank.selected_side_tab").data("bank_data");a=f.find(".question_bank_questions_url").attr("href");a=$.replaceTags(a,"question_bank_id",e.id);var g=(f.find(".page_link").data("page")||0)+
1;a+="&page="+g;$.ajaxJSON(a,"GET",{},function(k){b.removeClass("loading");f.find(".page_link").data("page",g);f.find(".page_link").text(h.t("more_questions","more questions"));var m=f.data("banks")||{},n=m[e.id]||{};n.pages=k.pages;n.questions=(n.questions||[]).concat(k.questions);n.last_page=g;m[e.id]=n;f.data("banks",m);f.find(".question_message").hide();f.find(".question_list_holder").show();l(k)},function(){b.removeClass("loading");f.find(".question_message").text(h.t("errors.loading_questions_failed",
"Questions failed to load, please try again"));f.find(".page_link").text(h.t("errors.loading_more_questions_failed","loading more questions failed"))})}}).delegate(".select_all_link","click",function(a){a.preventDefault();f.find(".question_list .found_question:not(.blank) :checkbox").attr("checked",true)}).delegate(".clear_all_link","click",function(a){a.preventDefault();f.find(".question_list .found_question:not(.blank) :checkbox").attr("checked",false)}).delegate(".cancel_button","click",function(){f.dialog("close")}).delegate(".group_button",
"click",function(){var a=$("#add_found_questions_as_group_dialog"),b=[];f.find(".question_list :checkbox:checked").each(function(){b.push($(this).parents(".found_question").data("question_data").id)});a.find(".questions_count").text(b.length);a.dialog("close").dialog({autoOpen:false,title:h.t("titles.add_questions_as_group","Add Questions as a Group")}).dialog("open")}).delegate(".submit_button","click",function(){var a=[];f.find(".question_list :checkbox:checked").each(function(){a.push($(this).parents(".found_question").data("question_data").id)});
var b={};b.quiz_group_id=f.find(".quiz_group_select").val();b.assessment_question_bank_id=f.find(".bank.selected_side_tab:first").data("bank_data").id;b.assessment_questions_ids=a.join(",");b.existing_questions="1";var e=f.find(".add_questions_url").attr("href");f.find("button").attr("disabled",true).filter(".submit_button").text(h.t("buttons.adding_questions","Adding Questions..."));$.ajaxJSON(e,"POST",b,function(g){function k(){m++;var n=g.shift();if(n){quiz.addExistingQuestion(n.quiz_question);
m>5?setTimeout(k,50):k()}}f.find("button").attr("disabled",false).filter(".submit_button").text(h.t("buttons.add_selected_questions","Add Selected Questions"));f.find(".selected_side_tab").removeClass("selected_side_tab");var m=0;setTimeout(k,10);f.dialog("close")},function(){f.find("button").attr("disabled",false).filter(".submit_button").text(h.t("errors.adding_questions_failed","Adding Questions Failed, please try again"))})});$(".add_answer_link").bind("click",function(a,b){a.preventDefault();
var e=$(this).parents(".question"),g=[],k=null,m=null,n="single_answer";if(e.hasClass("multiple_choice_question")){g=[{comments:h.t("default_answer_comments","Response if the student chooses this answer")}];k="select_answer";m="multiple_choice_question"}else if(e.hasClass("compare_fractions_question")){g=[{comments:h.t("default_answer_comments","Response if the student chooses this answer")}];k="select_answer";m="compare_fractions_question"}else if(e.hasClass("true_false_question"))return;else if(e.hasClass("short_answer_question")){g=
[{comments:h.t("default_answer_comments","Response if the student chooses this answer")}];k="short_answer";m="short_answer_question";n="any_answer"}else if(e.hasClass("essay_question")){g=[{comments:h.t("default_response_to_essay","Response to show student after they submit an answer")}];k="comment";m="essay_question"}else if(e.hasClass("matching_question")){g=[{comments:h.t("default_comments_on_wrong_match","Response if the user misses this match")}];k="matching_answer";m="matching_question";n="matching"}else if(e.hasClass("missing_word_question")){g=
[{comments:h.t("default_answer_comments","Response if the student chooses this answer")}];k="short_answer";m="missing_word_question"}else if(e.hasClass("numerical_question")){g=[{numerical_answer_type:"exact_answer",answer_exact:"#",answer_error_margin:"#",comments:h.t("default_answer_comments_on_match","Response if the student matches this answer")}];k="numerical_answer";m="numerical_question";n="any_answer"}else if(e.hasClass("multiple_answers_question")){g=[{comments:h.t("default_answer_comments",
"Response if the student chooses this answer")}];k="select_answer";m="multiple_answers_question";n="multiple_answers"}else if(e.hasClass("multiple_dropdowns_question")){g=[{comments:h.t("default_answer_comments","Response if the student chooses this answer")}];k="select_answer";m="multiple_dropdowns_question"}else if(e.hasClass("fill_in_multiple_blanks_question")){g=[{comments:h.t("default_answer_comments","Response if the student chooses this answer")}];k="short_answer";m="fill_in_multiple_blanks_question";
n="any_answer"}for(var u=0;u<g.length;u++){var A=g[u];A.answer_type=k;A.question_type=m;A.blank_id=e.find(".blank_id_select").val();A.blank_index=e.find(".blank_id_select")[0].selectedIndex;$answer=w(A);if(n=="any_answer")$answer.addClass("correct_answer");else n=="matching"&&$answer.removeClass("correct_answer");e.find(".form_answers").append($answer.show());if(!b){$("html,body").scrollTo($answer);$answer.find(":text:visible:first").focus().select()}}});$(document).delegate(".answer_comment_holder",
"click",function(){$(this).find(".answer_comment").slideToggle()});$("#question_form_template").submit(function(a){a.preventDefault();a.stopPropagation();var b=$(this).prev();a=$(this);var e=a.find(".answer"),g=$(this).find(".question"),k=g.getFormData({values:["question_type","question_name","question_points","correct_comments","incorrect_comments","neutral_comments","question_text","answer_selection_type","text_after_answers","matching_answer_incorrect_matches"]});k.assessment_question_bank_id=
$(".question_bank_id").text()||"";var m=null;if(k.question_type=="calculated_question"){if(a.find(".combinations_holder .combinations tbody tr").length===0)m=h.t("errors.no_possible_solution","Please generate at least one possible solution")}else if(e.length===0||e.filter(".correct_answer").length===0)if(e.length===0&&k.question_type!="essay_question"&&k.question_type!="text_only_question")m=h.t("errors.no_answer","Please add at least one answer");else if(e.filter(".correct_answer").length===0&&(k.question_type==
"multiple_choice_question"||k.question_type=="compare_fractions_question"||k.question_type=="locate_fractions_question"||k.question_type=="represent_fractions_question"||k.question_type=="true_false_question"||k.question_tyep=="missing_word_question"))m=h.t("errors.no_correct_answer","Please choose a correct answer");if(m)a.find(".answers_header").errorBox(m,true);else{var n=$.extend({},k);n.points_possible=parseFloat(n.question_points);n.answers=[];b.find(".blank_id_select").empty();var u={},A=false;
if(n.question_type=="multiple_dropdowns_question"||n.question_type=="fill_in_multiple_blanks_question"){A=true;g.find(".blank_id_select option").each(function(){u[$(this).text()]=true})}g.find(".blank_id_select option").each(function(){b.find(".blank_id_select").append($(this).clone())});e=g.find(".answer").each(function(p){var r=$(this);r.show();var z=r.getFormData();z.blank_id=r.find(".blank_id").text();z.answer_text=r.find("input[name='answer_text']:visible").val();if(k.question_type=="true_false_question")z.answer_text=
p==0?h.t("true","True"):h.t("false","False");z.answer_weight=r.hasClass("correct_answer")?100:0;A&&z.blank_id&&!u[z.blank_id]||n.answers.push(z)});if(g.hasClass("calculated_question")){n.answers=[];n.variables=[];var y={};g.find(".variables .variable").each(function(p){var r={};r.scale="0";r.name=$(this).find(".name").text();r.scale=parseFloat($(this).find(".round").val(),10)||0;r.min=parseFloat($(this).find(".min").val(),10)||0;r.max=parseFloat($(this).find(".max").val(),10)||0;y[r.name]=p;n.variables.push(r)});
n.formulas=[];g.find(".formulas .formula").each(function(){var p={};p.formula=$.trim($(this).text());n.formulas.push(p)});n.formula_decimal_places=parseInt(g.find(".decimal_places .round").val(),10)||0;n.answer_tolerance=parseFloat(g.find(".combination_answer_tolerance").val(),10)||0;n.answerDecimalPoints=parseFloat(g.find(".combination_error_margin").val(),10)||0;var t=g.find(".combinations thead th");g.find(".combinations tbody tr").each(function(){var p={};p.variables=[];p.answer=parseFloat($(this).find("td.final_answer").text(),
10)||0;$(this).find("td:not(.final_answer)").each(function(r){var z={};z.name=$.trim(t.eq(r).text());z.value=parseFloat($(this).text(),10)||0;p.variables.push(z)});p.variables=p.variables.sort(function(r,z){return y[r.name]-y[z.name]});n.answers.push(p)})}quiz.updateDisplayQuestion(b,n);quiz.answerTypeDetails(n.question_type);a.remove();$("html,body").scrollTo({top:b.offset().top-10,left:0});a=$("#quiz_urls .add_question_url,#bank_urls .add_question_url").attr("href");e="POST";if(b.attr("id")!="question_new"){a=
b.find(".update_question_url").attr("href");e="PUT"}k=v(b);g=i(k);k=x(g);if(b.parent(".question_holder").hasClass("group"))if(g=quiz.findContainerGroup(b.parent(".question_holder")))k["question[quiz_group_id]"]=g.attr("id").substring(10);if($("#assessment_question_bank_id").length>0)k["assessment_question[assessment_question_bank_id]"]=$("#assessment_question_bank_id").text();b.loadingImage();quiz.updateDisplayComments();$.ajaxJSON(a,e,k,function(p){b.loadingImage("remove");p=p.quiz_question||p.assessment_question;
var r=$.extend({},p,p.question_data);r.assessment_question_id=r.assessment_question_id||p.assessment_question_id||p.id;quiz.updateDisplayQuestion(b,r,true);$("#unpublished_changes_message").slideDown()},function(p){b.formErrors(p)})}});$("#sort_questions").sortable({revert:false,update:function(){var a=$(this).sortable("toArray"),b;for(b in a){var e=a[b];e&&e!="sort_question_blank"&&$("#"+e.substring(5)).appendTo($("#questions"))}}});$(document).delegate("input.float_value","keydown",function(a){a.keyCode>
57&&a.keyCode<91&&a.preventDefault()}).delegate("input.float_value","change blur focus",function(){quiz.parseInput($(this),$(this).hasClass("long")?"float_long":"float")});$("#questions").delegate(".question_teaser_link","click",function(a){function b(g){var k=$("#question_template").clone().removeAttr("id");g=$.extend({},g,g.question_data);e.after(k);e.remove();k.show();k.find(".question_points").text(g.points_possible);quiz.updateDisplayQuestion(k.find(".display_question"),g,true);e.hasClass("to_edit")&&
k.find(".edit_question_link").click()}a.preventDefault();var e=$(this).parents(".question_teaser");if(a=e.data("question"))b(a);else{e.find(".teaser.question_text").text(h.t("loading_question","Loading Question..."));$.ajaxJSON(e.find(".update_question_url").attr("href"),"GET",{},function(g){b(g.quiz_question)},function(){e.find(".teaser.question_text").text(h.t("errors.loading_question_failed","Loading Question Failed..."))})}}).delegate(".teaser.question_text","click",function(a){a.preventDefault();
$(this).parents(".question_teaser").find(".question_teaser_link").click()}).delegate(".edit_teaser_link","click",function(a){a.preventDefault();$(this).parents(".question_teaser").addClass("to_edit");$(this).parents(".question_teaser").find(".question_teaser_link").click()});$(".keep_editing_link").click(function(a){a.preventDefault();$(".question_generated,.question_preview").hide();$(".question_editing").show();$("html,body").scrollTo($("#questions"))});$(".quiz_group_form").formSubmit({object_name:"quiz_group",
beforeSubmit:function(a){var b=$(this);b.parents(".group_top").fillTemplateData({data:a}).removeClass("editing");b.loadingImage()},success:function(a){var b=$(this),e=b.parents(".group_top"),g=a.quiz_group;b.loadingImage("remove");e=b.parents(".group_top");e.removeClass("editing");e.fillTemplateData({data:g,id:"group_top_"+g.id,hrefValues:["id"]});e.toggleClass("question_bank_top",!!g.assessment_question_bank_id);b=e.next(".assessment_question_bank");if(g.assessment_question_bank_id){if(b.data("bank_data")){b=
b.data("bank_data");b.bank_id=b.id;b.context_type_string=$.pluralize($.underscore(b.context_type));e.next(".assessment_question_bank").fillTemplateData({data:b,hrefValues:["bank_id","context_type_string","context_id"]}).find(".bank_name").hide().filter(".bank_name_link").show()}}else b.remove();e.fillFormData(a,{object_name:"quiz_group"});for(a=e.next();a.length>0&&!a.hasClass("group_bottom");)a=a.next();$("#unpublished_changes_message").slideDown();a.attr("id","group_bottom_"+g.id);quiz.updateDisplayComments()},
error:function(a){var b=$(this);b.parents(".group_top").addClass("editing");b.loadingImage("remove");b.formErrors(a)}});$("#questions").sortable({handle:".move_icon",helper:function(a,b){return b.clone().removeClass("group")},items:".group_top,.group_bottom,.question_holder",tolerance:"pointer",start:function(a,b){b.placeholder.css("visibility","visible");if(b.item.hasClass("group_top")){b.helper.addClass("dragging");for(var e=b.item,g=[];e.length>0&&!e.hasClass("group_bottom");){e=e.next();if(!e.hasClass("ui-sortable-placeholder")){g.push(e);
e.hide()}}b.item.data("take_with",g);b.placeholder.show()}else{quiz.findContainerGroup(b.placeholder)?b.placeholder.addClass("group"):b.placeholder.removeClass("group");b.placeholder.append("<div class='question_placeholder' style='height: "+(b.helper.height()-10)+"px;'>&nbsp;</div>")}},change:function(a,b){var e=quiz.findContainerGroup(b.placeholder);if(b.item.hasClass("group_top")){if(e){e.before(b.placeholder);$("html,body").scrollTo(b.placeholder)}}else{if(e)if(e.attr("id")=="group_top_new"){e.before(b.placeholder);
$("html,body").scrollTo(b.placeholder)}else e.hasClass("question_bank_top")?e.before(b.placeholder).addClass("group"):b.placeholder.addClass("group");else b.placeholder.removeClass("group");b.placeholder.height(b.helper.height()).find(".question_placeholder").height(b.helper.height()-10)}},update:function(a,b){var e=$("#quiz_urls .reorder_questions_url, #bank_urls .reorder_questions_url").attr("href"),g={},k=$("#questions"),m=[];if(quiz.findContainerGroup(b.item)){k=quiz.findContainerGroup(b.item);
$list=[];e=k.find(".reorder_group_questions_url").attr("href");for(g=k.next();g.length>0&&!g.hasClass("group_bottom");){m.push(g);g=g.next()}}else k.children(".question_holder:not(.group),.group_top").each(function(){m.push($(this))});k.loadingImage();var n=[],u=$("#questions.question_bank").length>0;$.each(m,function(A,y){var t=u?y.find(".assessment_question_id").text():y.hasClass("question_holder")?"question_"+(y.find(".question").attr("id").substring(9)||y.find(".question .id").text()):"group_"+
y.attr("id").substring(10);n.push(t)});g={order:n.join(",")};$.ajaxJSON(e,"POST",g,function(){k.loadingImage("remove")})},stop:function(a,b){if(b.item.hasClass("group_top")){var e=b.item.data("take_with");if(e){var g=b.item,k;for(k in e){var m=e[k];g.after(m.show());g=m}}}else if(quiz.findContainerGroup(b.item)){b.item.addClass("group");for(g=b.item.prev();g.length>0&&!g.hasClass("group_top");)g=g.prev();g.find(".expand_link").click()}else b.item.removeClass("group")}});$(document).delegate(".edit_group_link",
"click",function(a){if($(this).closest(".group_top").length!=0){a.preventDefault();a=$(this).parents(".group_top");var b=a.getTemplateData({textValues:["name","pick_count","question_points"]});a.fillFormData(b,{object_name:"quiz_group"});a.addClass("editing");a.find(":text:visible:first").focus().select();a.find(".quiz_group_form").attr("action",a.find(".update_group_url").attr("href")).attr("method","PUT");a.find(".submit_button").text(h.t("buttons.update_group","Update Group"))}}).delegate(".delete_group_link",
"click",function(a){if($(this).closest(".group_top").length!=0){a.preventDefault();a=$(this).parents(".group_top");for(var b=$("nothing").add(a),e=a.next();e.length>0&&!e.hasClass("group_bottom");){b=b.add(e);e=e.next()}b=b.add(e);a.confirmDelete({url:a.find(".update_group_url").attr("href"),confirmed:function(){b.dim()},success:function(){b.fadeOut(function(){$(this).remove();quiz.updateDisplayComments()})}})}}).delegate(".group_edit.cancel_button","click",function(){if($(this).closest(".group_top").length!=
0){var a=$(this).parents(".group_top");a.removeClass("editing");if(a.attr("id")=="group_top_new"){for(var b=a.next();b.length>0&&!b.hasClass("group_bottom");){var e=b;b.removeClass("group");b=b.next();e.hasClass("assessment_question_bank")&&e.remove()}b.remove();a.remove()}quiz.updateDisplayComments()}}).delegate(".collapse_link","click",function(a){if($(this).closest(".group_top").length!=0){a.preventDefault();$(this).parents(".group_top").find(".collapse_link").addClass("hidden").end().find(".expand_link").removeClass("hidden");
for(a=$(this).parents(".group_top").next();a.length>0&&a.hasClass("question_holder");){a.hide();a=a.next()}}}).delegate(".expand_link","click",function(a){if($(this).closest(".group_top").length!=0){a.preventDefault();$(this).parents(".group_top").find(".collapse_link").removeClass("hidden").end().find(".expand_link").addClass("hidden");for(a=$(this).parents(".group_top").next();a.length>0&&a.hasClass("question_holder");){a.show();a=a.next()}}});if(wikiSidebar){wikiSidebar.init();wikiSidebar.attachToEditor($("#quiz_description"))}setTimeout(function(){$("#quiz_description").editorBox()},
2E3);$(".toggle_description_views_link").click(function(a){a.preventDefault();$("#quiz_description").editorBox("toggle")});$(".toggle_question_content_views_link").click(function(a){a.preventDefault();$(this).parents(".question_form").find(".question_content").editorBox("toggle")});$(".toggle_text_after_answers_link").click(function(a){a.preventDefault();$(this).parents(".question_form").find(".text_after_answers").editorBox("toggle")});$(document).bind("editor_box_focus",function(a,b){wikiSidebar.attachToEditor(b)});
$(".quiz_options_link,.link_to_content_link").click(function(a){a.preventDefault();$("#quiz_content_links,#quiz_options_holder").toggle();if($("#quiz_content_links:visible").length>0)wikiSidebar&&wikiSidebar.show();else wikiSidebar&&wikiSidebar.hide()});$("#calc_helper_methods").change(function(){var a=$(this).val();$("#calc_helper_method_description").text(calcCmd.functionDescription(a));a="<pre>"+calcCmd.functionExamples(a).join("</pre><pre>")+"</pre>";$("#calc_helper_method_examples").html(a)});
$("#equations_dialog_tabs").tabs()});$.fn.multipleAnswerSetsQuestion=function(){var c=$(this),d=c.find(".question_content"),f=c.find(".blank_id_select"),j=c.find(".question_type");if(!c.data("multiple_sets_question_bindings")){c.data("multiple_sets_question_bindings",true);d.bind("keypress",function(l){setTimeout(function(){$(l.target).triggerHandler("change")},50)});d.bind("change",function(){var l=j.val();if(!(l!="multiple_dropdowns_question"&&l!="fill_in_multiple_blanks_question")){l=$(this).editorBox("get_code").match(/\[[A-Za-z][A-Za-z0-9]*\]/g);
f.find("option.shown_when_no_other_options_available").remove();f.find("option").addClass("to_be_removed");var a={};if(l)for(var b=0;b<l.length;b++)if(l[b]){var e=l[b].substring(1,l[b].length-1);if(!a[e]){var g=f.find("option").eq(b);g.length||(g=$("<option/>").appendTo(f));g.removeClass("to_be_removed").addClass(e).val(e).text(e);a[e]=true}}f.find("option:not(.shown_when_no_other_options_available)").length||f.append("<option class='shown_when_no_other_options_available' value='0'>"+h.t("enter_answer_variable_above",
"[ Enter Answer Variables Above ]")+"</option>");f.find("option.to_be_removed").remove();f.change()}}).change();f.change(function(){var l=j.val();if(!(l!="multiple_dropdowns_question"&&l!="fill_in_multiple_blanks_question")){c.find(".form_answers .answer").hide().addClass("hidden");f.find("option").each(function(e){$(this);c.find(".form_answers .answer_for_"+$(this).val()).each(function(){$(this).attr("class",$(this).attr("class").replace(/answer_idx_\d+/g,""))}).addClass("answer_idx_"+e)});if(f.val()!==
"0"){var a=f.val(),b=f[0].selectedIndex;b>=0&&c.find(".form_answers .answer").each(function(){var e=$(this);if(!e.attr("class").match(/answer_idx_/))if(e.attr("class").match(/answer_for_/)){var g=null,k=e.attr("class").match(/answer_for_[^\s]+/);if(k&&k[0])k=k[0].substring(11);f.find("option").each(function(m){if($(this).text()==k)g=m});if(g===null)g=b;e.addClass("answer_idx_"+g)}else e.addClass("answer_idx_"+b)});f.find("option").each(function(e){var g=$(this).text();c.find(".form_answers .answer.answer_idx_"+
e).find(".blank_id").each(function(){$(this).text(g)})});l=c.find(".form_answers .answer.answer_idx_"+b).show().removeClass("hidden");if(!l.length&&a&&a!=="0"){for(l=0;l<2;l++)c.find(".add_answer_link").triggerHandler("click",true);l=c.find(".form_answers .answer.answer_idx_"+b).show().removeClass("hidden")}l.filter(".correct_answer").length||l.filter(":first").addClass("correct_answer");l.each(function(){$(this).find(".blank_id").text(a)})}}}).change()}};$.fn.formulaQuestion=function(){var c=$(this);
if(!c.data("formula_question_bindings")){c.data("formula_question_bindings",true);c.find(".supercalc").superCalc({pre_process:function(){var d=[];c.find(".variables .variable").each(function(){var f={name:$(this).attr("data-name"),value:$(this).attr("data-value")};d.push(f.name+" = "+f.value)});return d},formula_added:function(){c.triggerHandler("settings_change",true)}});c.find(".compute_combinations").click(function(){var d=$(this);d.text(h.t("buttons.generating","Generating...")).attr("disabled",
true);if(c.find(".question_type").val()=="calculated_question"){var f=c.find(".combinations");f.find("thead tr").empty();c.find(".variables .variable").each(function(){var A=$("<th/>");A.text($(this).find(".name").text());f.find("thead tr").append(A)});var j=$("<th/>");j.text(h.t("final_answer","Final Answer"));j.addClass("final_answer");f.find("thead tr").append(j);f.find("tbody").empty();var l=parseInt(c.find(".combination_count").val(),10)||10;if(l<0)l=10;else if(l>maxCombinations)l=maxCombinations;
c.find(".combination_count").val(l);var a=0,b=0,e=0,g=c.find(".formulas .formula_row:last .status"),k=c.find(".variables .variable"),m=f.find("tbody");c.find(".supercalc").superCalc("cache_finds");var n=parseFloat(c.find(".combination_answer_tolerance").val(),10),u=function(){d.text(h.t("buttons.generating_combinations_progress","Generating... (%{done}/%{total})",{done:a,total:l}));for(var A=document.createDocumentFragment(),y=0;y<5&&a<l&&e<25;y++){k.each(function(){$(this).find(".variable_setting:first").trigger("change",
{cache:true})});c.find(".supercalc").superCalc("recalculate",true);var t=g.attr("data-res"),p=[];k.each(function(){p.push($(this).attr("data-value"))});var r=parseFloat(t.substring(1),10);if(t.match(/^=/)&&t!="= NaN"&&t!="= Infinity"&&r){var z=$("<tr/>");k.each(function(){var C=$("<td/>");C.html($(this).attr("data-value"));z.append(C)});r=$("<td/>");r.addClass("final_answer");t=$.trim(t.substring(1));var B=n;if(B)t+=" <span style='font-size: 0.8em;'>+/-</span> "+B;r.html(t);z.append(r);a++;e=0;A.appendChild(z[0])}else e++}m[0].appendChild(A);
d.text(h.t("buttons.generating_combinations_progress","Generating... (%{done}/%{total})",{done:a,total:l}));if(b>=l||a>=l||e>=25){c.find(".supercalc").superCalc("clear_cached_finds");d.text("Generate").attr("disabled",false);if(a==0)alert(h.t("alerts.no_valid_combinations","The system could not generate any valid combinations for the parameters given"));else a<l&&alert(h.t("alerts.only_n_valid_combinations",{one:"The system could only generate 1 valid combination for the parameters given",other:"The system could only generate %{count} valid combinations for the parameters given"},
{count:a}));c.triggerHandler("settings_change",false)}else{b++;setTimeout(function(){u()},500)}};setTimeout(u,100)}});c.find(".recompute_variables").click(function(){c.find(".question_type").val()=="calculated_question"&&c.triggerHandler("recompute_variables",true)});c.bind("recompute_variables",function(d,f){c.find(".variables .variable").each(function(){$(this).find(".variable_setting:first").trigger("change",f?null:{recompute:true})})});c.bind("settings_change",function(d,f){if(c.find(".question_type").val()==
"calculated_question"){var j=c.find(".variables tbody tr.variable").length>0,l=c.find(".formulas .formula").length>0;c.find(".combinations_option").attr("disabled",!j||!l);c.find(".variables_specified").showIf(j);c.find(".formulas_specified").showIf(l);c.hasClass("ready")&&f&&c.find(".combinations_holder .combinations tbody tr").remove();c.find(".combinations_holder").showIf(c.find(".combinations tbody tr").length>0)}});c.find(".variables").delegate(".variable_setting","change",function(d,f){if(c.find(".question_type").val()==
"calculated_question"){var j=$(d.target).parents(".variable"),l=j.data("cached_data");if(!l||!f||!f.cache){l=j.getFormData();l.min=parseFloat(l.min)||0;l.max=Math.max(l.min,parseFloat(l.max)||0);l.round=parseInt(l.round,10)||0;l.range=l.max-l.min;l.rounder=Math.pow(10,l.round)||1}f&&f.cache&&j.data("cached_data",l);var a=Math.random()*l.range+l.min;a=Math.round(a*l.rounder)/l.rounder;j.attr("data-value",a);if(!f||f.template)j.find(".value").html(a);if(!f||f.recompute){c.find(".supercalc").superCalc("recalculate");
c.triggerHandler("settings_change",true)}}});c.find(".help_with_equations_link").click(function(d){d.preventDefault();$("#calc_helper_methods").empty();d=calcCmd.functionList();for(var f in d){var j=d[f][0],l=$("<option/>");l.val(j).text(j);$("#calc_helper_methods").append(l)}$("#calc_helper_methods").change();$("#help_with_equations_dialog").dialog("close").dialog({autoOpen:false,title:h.t("titles.help_with_formulas","Help with Quiz Question Formulas"),width:500}).dialog("open")});c.find(".combinations_option").attr("disabled",
true);c.find(".question_content").bind("keypress",function(d){setTimeout(function(){$(d.target).triggerHandler("change")},50)});c.find(".question_content").bind("change",function(){var d=$(this).editorBox("get_code").match(/\[[A-Za-z][A-Za-z0-9]*\]/g);c.find(".variables").find("tr.variable").addClass("to_be_removed");c.find(".variables").showIf(d&&d.length>0);var f={};if(d)for(var j=0;j<d.length;j++)if(d[j]){var l=d[j].substring(1,d[j].length-1);if(!f[l]){var a=c.find(".variables tr.variable").eq(j);
if(a.length===0){a=$("<tr class='variable'><td class='name'></td><td><input type='text' name='min' class='min variable_setting' style='width: 30px;' value='1'/></td><td><input type='text' name='max' class='max variable_setting' style='width: 30px;' value='10'/></td><td><select name='round' class='round variable_setting'><option>0</option><option>1</option><option>2</option><option>3</option></td><td class='value'></td></tr>");c.find(".variables tbody").append(a);a.find(".variable_setting:first").triggerHandler("change")}a.removeClass("to_be_removed");
a.addClass(l);a.attr("data-name",l);a.find("td.name").text(l);f[l]=true}}c.find(".variables").find("tr.to_be_removed").remove();c.find(".supercalc").superCalc("recalculate",true);c.triggerHandler("settings_change",false)}).change()}}});var calcCmd;
I18n.scoped("calculator",function(h){var q=function(s){var w={};w.formula_rows=s.find(".formula_row");w.formula_rows.each(function(){this.formula=$(this).find(".formula");this.status=$(this).find(".status");$(this).data("formula",$(this).find(".formula"));$(this).data("status",$(this).find(".status"))});w.round=s.find(".round");w.status=s.find(".status");w.last_row_details=s.find(".last_row_details");return w};$.fn.superCalc=function(s,w){if(s=="recalculate")$(this).triggerHandler("calculate",w);
else if(s=="clear")calcCmd.clearMemory();else if(s=="cache_finds")$(this).data("cached_finds",q($(this).data("table")));else if(s=="clear_cached_finds")$(this).data("cached_finds",null);else{s=s||{};s.c1=true;var v=$(this),x=$("<table class='formulas'><thead><tr><th>"+$.h(h.t("headings.formula","Formula"))+"</th><th>"+$.h(h.t("headings.result","Result"))+"</th><th>&nbsp;</th></tr></thead><tfoot><tr><td colspan='3' class='last_row_details' style='display: none;'>"+$.h(h.t("last_formula_row","the last formula row will be used to compute the final answer"))+
"</td></tr><tr><td></td><td class='decimal_places'>"+h.t("how_many_decimal_places","%{number_selector} Decimal Places",{number_selector:$.raw("<select class='round'><option>0</option><option>1</option><option>2</option><option>3</option><option>4</option></select>")})+"</td></tr></tfoot><tbody></tbody></table>");$(this).data("table",x);v.before(x);x.find("tfoot tr:last td:first").append(v);var i=v.clone(true).removeAttr("id");x.find("tfoot tr:last td:first").append(i);var o=$("<button type='button' class='save_formula_button'>"+
$.h(h.t("buttons.save","Save"))+"</button>");x.find("tfoot tr:last td:first").append(o);v.hide();o=$("<input type='text' readonly='true'/>");x.find("tfoot tr:last td:first").append(o.hide());v.data("supercalc_options",s);v.data("supercalc_answer",o);x.delegate(".save_formula_button","click",function(){i.triggerHandler("keypress",true)});x.delegate(".delete_formula_row_link","click",function(c){c.preventDefault();$(c.target).parents("tr").remove();v.triggerHandler("calculate")});x.find("tbody").sortable({items:".formula_row",
update:function(){v.triggerHandler("calculate")}});x.delegate(".round","change",function(){v.triggerHandler("calculate")});v.bind("calculate",function(c,d){calcCmd.clearMemory();var f=$(this).data("cached_finds")||q(x);if(s.pre_process&&$.isFunction(s.pre_process)){var j=s.pre_process(),l;for(l in j){d||v.val(j[l]||"");try{calcCmd.compute(j[l])}catch(a){}}}f.formula_rows.each(function(){var b=this.formula.html();v.val(b);var e=null;try{e="= "+calcCmd.computeValue(b)}catch(g){e=g.toString()}if(e&&
e.match(/=/)){b=parseFloat(e.substring(e.indexOf("=")+1),10);e=Math.pow(10,parseInt(f.round.val(),10)||0)||1;e="= "+Math.round(b*e)/e}this.status.attr("data-res",e);d||this.status.html(e)});if(!d){f.formula_rows.length>1&&f.formula_rows.removeClass("last_row").filter(":last").addClass("last_row");f.last_row_details.showIf(f.formula_rows.length>1);f.status.removeAttr("title").filter(":last").attr("title",h.t("sample_final_answer","This value is an example final answer for this question type"));v.val("")}});
i.bind("keypress",function(c,d){v.val(i.val());if(c.keyCode==13||d&&i.val()){c.preventDefault();c.stopPropagation();var f=$("<tr class='formula_row'><td class='formula' title='"+$.h(h.t("drag_to_reorder","Drag to reorder"))+"'></td><td class='status'></td><td><a href='#' class='delete_formula_row_link no-hover'><img src='/images/delete_circle.png'/></a></td></tr>");f.find("td:first").text(v.val());v.val("");i.val("");x.find("tbody").append(f);v.triggerHandler("calculate");i.focus();s&&s.formula_added&&
$.isFunction(s.formula_added)&&s.formula_added.call(v)}})}}});calcCmd={};
I18n.scoped("calculator.commands",function(h){(function(){var q={},s={},w={},v,x=[{regex:/\s+/,token:"whitespace"},{regex:/[a-zA-Z][a-zA-Z0-9_\.]*/,token:"variable"},{regex:/[0-9]*\.?[0-9]+/,token:"number"},{regex:/\+/,token:"add"},{regex:/\-/,token:"subtract"},{regex:/\*/,token:"multiply"},{regex:/\//,token:"divide"},{regex:/\(/,token:"open_paren"},{regex:/\)/,token:"close_paren"},{regex:/\,/,token:"comma"},{regex:/\^/,token:"power"},{regex:/\=/,token:"equals"}],i=0,o=function(a){var b=null;switch(a[i].token){case "number":b=
a[i];break;case "subtract":if(a[i+1]&&a[i+1].token=="number"){a[i+1].value="-"+a[i+1].value;i++;b=a[i]}else throw"expecting a number at "+a[i].newIndex;break;case "variable":if(a[i+1]&&a[i+1].token=="open_paren"){b=a[i];b.token="method";b.arguments=[];var e="comma";i+=2;if(a[i].token=="close_paren"){e="close_paren";i++}for(;e=="comma";){b.arguments.push(d(a,["comma","close_paren"]));e=a[i].token;i++}i--;if(e!="close_paren")throw"expecting close parenthesis at "+a[i].newIndex;}else b=a[i];break;case "open_paren":b=
a[i];b.token="parenthesized_expression";i++;b.expression=d(a,["close_paren"])}if(!b)throw"expecting a value at "+(a&&a[i]&&a[i].newIndex||0)+", got a "+(a&&a[i]&&a[i].token||"nothing");i++;return b},c=function(a){switch(a[i].token){case "add":return a[i++];case "subtract":return a[i++];case "multiply":return a[i++];case "divide":return a[i++];case "power":return a[i++]}throw"unexpected "+(a&&a[i]&&a[i].token||"value")+" at "+(a&&a[i]&&a[i].newIndex||0);},d=function(a,b){var e={token:"expression",
newIndex:a[i].newIndex};e.expressionItems=[];e.expressionItems.push(o(a));if(i>a.length)return e;for(var g=false;i<a.length&&!g;){for(var k in b)if(a[i].token==b[k])g=true;if(!g){e.expressionItems.push(c(a));e.expressionItems.push(o(a))}}return e},f=function(a){return{token:"number",value:a,calculatedValue:a}},j=function(a){switch(a.token){case "number":return parseFloat(a.value);case "expression":var b=a.expressionItems,e=[b[0]];for(a=1;a<b.length;a+=2){var g=b[a];if(g.token=="power"){g=e.pop();
var k=b[a+1];e.push(f(Math.pow(j(g),j(k))))}else{e.push(b[a]);e.push(b[a+1])}}b=[e[0]];for(a=1;a<e.length;a+=2){g=e[a];if(g.token=="multiply"){g=b.pop();k=e[a+1];b.push(f(j(g)*j(k)))}else if(g.token=="divide"){g=b.pop();k=e[a+1];b.push(f(j(g)/j(k)))}else{b.push(e[a]);b.push(e[a+1])}}e=[b[0]];for(a=1;a<b.length;a+=2){g=b[a];if(g.token=="add"){g=e.pop();k=b[a+1];e.push(f(j(g)+j(k)))}else if(g.token=="subtract"){g=e.pop();k=b[a+1];e.push(f(j(g)-j(k)))}else{e.push(b[a]);e.push(b[a+1])}}if(e.length===
0)throw"expressions should have at least one value";else if(e.length>1)throw"unexpected modifier: "+e[1].token;else a=j(e[0]);return a;case "parenthesized_expression":return j(a.expression);case "variable_assignment":if(a.variable.value=="_")throw"the variable '_' is reserved";w[a.variable.value]=j(a.assignmentExpression);return w[a.variable.value];case "variable":if(a.value=="_")return v||0;e=(e=s&&s[a.value])||w&&w[a.value];if(!e)throw"undefined variable "+a.value;return e;case "method":g=[];for(k in a.arguments){e=
j(a.arguments[k]);a.arguments[k].computedValue=e;g.push(e)}if(q[a.value])return q[a.value].apply(null,g);else throw"unrecognized method "+a.value;}throw"Unexpected token type: "+a.token;};calcCmd.clearMemory=function(){w={};v=null};var l={};calcCmd.compute=function(a){var b={};a=a.toString();b.command=a;if(tree=l[a]){b.syntax=tree.syntax;b.tree=tree.tree}else{for(var e=a,g=0,k=[];g<e.length;){var m;a:{m=g;var n=e.substring(m),u={},A=void 0;for(A in x){var y=x[A],t=n.match(y.regex);if(t&&t[0]&&n.indexOf(t[0])==
0){u.token=y.token;u.value=t[0];u.newIndex=m+t[0].length;m=u;break a}}m=null}if(!m)throw"unrecognized token at "+g;g=m.newIndex;k.push(m)}b.syntax=k;e=b.syntax;g=[];for(var p in e)e[p].token!="whitespace"&&g.push(e[p]);e=g;p=null;i=0;if(e[i].token=="variable"&&e.length>1&&e[i+1].token=="equals"){p={token:"variable_assignment",newIndex:e[i].newIndex};p.variable=e[i];if(e.length>2){i=2;p.assignmentExpression=d(e)}else throw"Expecting value at "+e[i+1].newIndex;}else p=d(e);b.tree=p;l[a]=b}b.computedValue=
j(b.tree);v=b.computedValue;return b};calcCmd.computeValue=function(a){return calcCmd.compute(a).computedValue};calcCmd.addFunction=function(a,b,e,g,k){if(typeof a=="string"){e.friendlyName=b;e.description=g;if(typeof k=="string")k=[k];e.examples=k;q[a]=e;return true}return false};calcCmd.addPredefinedVariable=function(a,b){b=parseFloat(b);if(typeof a=="string"&&(b||b==0))s[a]=b};calcCmd.functionDescription=function(a){return q[a]?q[a].description||h.t("no_description","No description found for the function, %{functionName}",
{functionName:a}):h.t("unrecognized","%{functionName} is not a recognized function",{functionName:a})};calcCmd.functionExamples=function(a){return q[a]?q[a].examples||[]:[]};calcCmd.functionList=function(){var a=[],b;for(b in q)a.push([b,q[b].description||h.t("default_description","No description given")]);a.sort(function(e,g){return e[0]>g[0]?1:e[0]<g[0]?-1:0});return a}})();(function(){var q=function(i,o,c,d,f){calcCmd.addFunction(i,o,c,d,f)};calcCmd.addPredefinedVariable("pi",Math.PI,void 0);calcCmd.addPredefinedVariable("e",
Math.exp(1),void 0);q("abs",h.t("abs.name","abs"),function(i){return Math.abs(i)},h.t("abs.description","Returns the absolute value of the given value"),"abs(x)");q("asin",h.t("asin.name","asin"),function(i){return Math.asin(i)},h.t("asin.description","Returns the arcsin of the given value"),"asin(x)");q("acos",h.t("acos.name","acos"),function(i){return Math.acos(i)},h.t("acos.description","Returns the arccos of the given value"),"acos(x)");q("atan",h.t("atan.name","atan"),function(i){return Math.atan(i)},
h.t("atan.description","Returns the arctan of the given value"),"atan(x)");q("log",h.t("log.name","log"),function(i,o){return Math.log(i)/Math.log(o||10)},h.t("log.description","Returns the log of the given value with an optional base"),"log(x, [base])");q("ln",h.t("ln.name","ln"),function(i){return Math.log(i)},h.t("ln.description","Returns the natural log of the given value"),"ln(x)");q("rad_to_deg",h.t("rad_to_deg.name","rad_to_deg"),function(i){return i*180/Math.PI},h.t("rad_to_deg.description",
"Returns the given value converted from radians to degrees"),"rad_to_deg(radians)");q("deg_to_rad",h.t("deg_to_rad.name","deg_to_rad"),function(i){return i*Math.PI/180},h.t("deg_to_rad.description","Returns the given value converted from degrees to radians"),"deg_to_rad(degrees)");q("sin",h.t("sin.name","sin"),function(i){return Math.sin(i)},h.t("sin.description","Returns the sine of the given value"),"sin(radians)");q("cos",h.t("cos.name","cos"),function(i){return Math.cos(i)},h.t("cos.description",
"Returns the cosine of the given value"),"cos(radians)");q("tan",h.t("tan.name","tan"),function(i){return Math.tan(i)},h.t("tan.description","Returns the tangent of the given value"),"tan(radians)");q("pi",h.t("pi.name","pi"),function(){return Math.PI},h.t("pi.description","Returns the computed value of pi"),"pi()");q("if",h.t("if.name","if"),function(i,o,c){return i?o:c},h.t("if.description","Evaluates the first argument, returns the second argument if it evaluates to a non-zero value, otherwise returns the third value"),
"if(bool,success,fail)");var s=function(i){return i.length==1&&i[0]instanceof Array?i[0]:i};q("max",h.t("max.name","max"),function(){for(var i=s(arguments),o=i[0],c=0;c<i.length;c++)o=Math.max(o,i[c]);return o},h.t("max.description","Returns the highest value in the list"),["max(a,b,c...)","max(list)"]);q("min",h.t("min.name","min"),function(){for(var i=s(arguments),o=i[0],c=0;c<i.length;c++)o=Math.min(o,i[c]);return o},h.t("min.description","Returns the lowest value in the list"),["min(a,b,c...)",
"min(list)"]);q("sqrt",h.t("sqrt.name","sqrt"),function(i){return Math.sqrt(i)},h.t("sqrt.description","Returns the square root of the given value"),"sqrt(x)");q("sort",h.t("sort.name","sort"),function(){for(var i=s(arguments),o=[],c=0;c<i.length;c++)o.push(i[c]);return o.sort()},h.t("sort.description","Returns the list of values, sorted from lowest to highest"),["sort(a,b,c...)","sort(list)"]);q("reverse",h.t("reverse.name","reverse"),function(){for(var i=s(arguments),o=[],c=0;c<i.length;c++)o.unshift(i[c]);
return o},h.t("reverse.description","Reverses the order of the list of values"),["reverse(a,b,c...)","reverse(list)"]);q("first",h.t("first.name","first"),function(){return s(arguments)[0]},h.t("first.description","Returns the first value in the list"),["first(a,b,c...)","first(list)"]);q("last",h.t("last.name","last"),function(){var i=s(arguments);return i[i.length-1]},h.t("last.description","Returns the last value in the list"),["last(a,b,c...)","last(list)"]);q("at",h.t("at.name","at"),function(i,
o){return i[o]},h.t("at.description","Returns the indexed value in the given list"),"at(list,index)");q("rand",h.t("rand.name","rand"),function(i){return Math.random()*(i||1)},h.t("rand.description","Returns a random number between zero and the range specified, or one if no number is given"),"rand(x)");q("length",h.t("length.name","length"),function(){return s(arguments).length},h.t("length.description","Returns the number of arguments in the given list"),["length(a,b,c...)","length(list)"]);var w=
function(i){for(var o=0,c=0;c<i.length;c++)if(i[c])o+=i[c];return o};q("mean",h.t("mean.name","mean"),function(){var i=s(arguments);return w(i)/i.length},h.t("mean.description","Returns the average mean of the values in the list"),["mean(a,b,c...)","mean(list)"]);q("median",h.t("median.name","median"),function(){for(var i=s(arguments),o=[],c=0;c<i.length;c++)o.push(i[c]);o=o.sort();return o.length%2==1?o[Math.floor(o.length/2)]:(o[Math.round(o.length/2)]+o[Math.round(o.length/2)-1])/2},h.t("median.description",
"Returns the median for the list of values"),["median(a,b,c...)","median(list)"]);q("range",h.t("range.name","range"),function(){for(var i=s(arguments),o=[],c=0;c<i.length;c++)o.push(i[c]);o=o.sort();return o[o.length-1]-o[0]},h.t("range.description","Returns the range for the list of values"),["range(a,b,c...)","range(list)"]);q("count",h.t("count.name","count"),function(){return s(arguments).length},h.t("count.description","Returns the number of items in the list"),["count(a,b,c...)","count(list)"]);
q("sum",h.t("sum.name","sum"),function(){return w(s(arguments))},h.t("sum.description","Returns the sum of the list of values"),["sum(a,b,c...)","sum(list)"]);var v={},x=function(i){i=Math.max(parseInt(i),0);return i==0||i==1?1:i>170?Infinity:v[i]?v[i]:i*x(i-1)};q("fact",h.t("fact.name","fact"),function(i){return x(i)},h.t("fact.description","Returns the factorial of the given number"),"fact(n)");q("perm",h.t("perm.name","perm"),function(i,o){return x(i)/x(i-o)},h.t("perm.description","Returns the permutation result for the given values"),
"perm(n, k)");q("comb",h.t("comb.name","comb"),function(i,o){return x(i)/(x(o)*x(i-o))},h.t("comb.description","Returns the combination result for the given values"),"comb(n, k)");q("ceil",h.t("ceil.name","ceil"),function(i){return Math.ceil(i)},h.t("ceil.description","Returns the ceiling for the given value"),"ceil(x)");q("floor",h.t("floor.name","floor"),function(i){return Math.floor(i)},h.t("floor.description","Returns the floor for the given value"),"floor(x)");q("round",h.t("round.name","round"),
function(i){return Math.round(i)},h.t("round.description","Returns the given value rounded to the nearest whole number"),"round(x)");q("e",h.t("e.name","e"),function(i){return Math.exp(i||1)},h.t("e.description","Returns the value for e"),"e()")})()});
I18n.scoped("quizzes.rubric",function(h){$(document).ready(function(){$(".show_rubric_link").click(function(q){function s(){w=$("#rubrics.rubric_dialog");w.dialog("close").dialog({title:h.t("titles.details","Assignment Rubric Details"),width:600,modal:false,resizable:true,autoOpen:false}).dialog("open")}q.preventDefault();q=$(this).attr("rel");var w=$("#rubrics.rubric_dialog");if(w.length)s();else{var v=$("<div/>");v.text(h.t("loading","Loading..."));$("body").append(v);v.dialog({width:400,height:200});
$.get(q,function(x){$("body").append(x);v.dialog("close");v.remove();s()})}})})});
$.extend(true,I18n=I18n||{},{translations:{es:{buttons:{cancel:"Cancelar"},quizzes:{enter_answer_variable_above:"[ Ingresar Variables de la Respuesta Arriba ]",loading_question:"Cargando Pregunta...",default_quesiton_name:"Pregunta",answer_comments:"Contestar comentarios",default_answer_comments:"Respuesta si el estudiante escoge esta respuesta",confirms:{scrap_and_restart:"\u00bfDesechar esta evaluaci\u00f3n  y volver a comenzar?",delete_question:"\u00bfSeguro que quiere borrar esta pregunta?"},
buttons:{add_selected_questions:"Agregar Preguntas Seleccionadas",published:"\u00a1Publicado!",creating_group:"Creando Grupos...",generating_combinations_progress:"Generando... (%{done}/%{total})",saving:"Guardando...",update_question:"Actualizar la Pregunta",generating:"Generando...",save_settings:"Guardar Configuraciones",create_group:"Crear Grupo",adding_questions:"Agregando Preguntas...",update_group:"Actualizar Grupo",create_question:"Crear Pregunta",saved:"\u00a1Guardado!",publishing:"Publicando..."},
no_filters_found:"No se encontraron filtros",default_comments_on_wrong_match:"Respuesta si el usuario falla este apareo",retrieving_filters:"Recuperando Filtros...",loading_question_banks:"Cargando los Grupos de Preguntas...",alerts:{only_n_valid_combinations:{one:"El sistema s\u00f3lo pudo generar 1 combinaci\u00f3n v\u00e1lida para los par\u00e1metros dados",other:"El sistema s\u00f3lo pudo generar %{count} combinaciones v\u00e1lidas para los par\u00e1metros dados"},no_valid_combinations:"The system could not generate any valid combinations for the parameters given"},
default_answer_comments_on_match:"Respuesta si el estudiante coincide con esta respuesta",errors:{no_possible_solution:"Genere al menos una soluci\u00f3n posible",loading_question_failed:"No se pudo Cargar la Pregunta...",loading_more_questions_failed:"no se pudieron cargar m\u00e1s preguntas",adding_questions_failed:"No se pudieron agregar preguntas, intente de nuevo",creating_group_failed:"No se pudo crear el grupo, intente de nuevo",retrieving_filters_failed:"No se pudieron recuperar los filtros",
no_correct_answer:"Seleccionar una respuesta correcta",no_answer:"Agregar al menos una respuesta",loading_questions_failed:"No se pudieron cargar las preguntas, intente de nuevo",loading_banks_failed:"No se pudo cargar el Grupo de Preguntas, intente de nuevo"},answer_text:"Texto de respuesta","true":"Verdadero",default_quiz_title:"Evaluaci\u00f3n",default_response_to_essay:"Respuesta que mostrar al estudiante despu\u00e9s de enviar su respuesta",titles:{click_to_enter_comments_on_wrong_match:"Haga click para ingresar comentarios para el estudiantes si fallan este apareo",
add_questions_as_group:"Agregar Preguntas como un Grupo",find_quiz_question:"Encontrar Pregunta de la Evaluaci\u00f3n",click_to_unset_as_correct:"Haga click para remover esta respuesta como la correcta",click_to_enter_comments_on_answer:"Haga click para ingresar comentarios para el estudiante si escogen esta respuesta",help_with_formulas:"Ayudar con las Formulas de las Preguntas de la Evaluaci\u00f3n",find_question_bank:"Encontrar Grupo de Preguntas",ip_address_filtering:"Filtraci\u00f3n de Direcci\u00f3n IP",
click_to_set_as_correct:"Haga click para marcar esta respuesta como la correcta"},rubric:{titles:{details:"Detalles de R\u00fabricas de la Tarea"},loading:"Cargando..."},more_questions:"mas preguntas","false":"Falso",choose_option:"[ Escoja ]",notices:{quiz_data_saved:"Se ha guardado la informaci\u00f3n de la evaluaci\u00f3n"},default_question_name:"Pregunta",loading_more_questions:"cargando m\u00e1s preguntas...",final_answer:"Respuesta Final",labels:{possible_answer:"Respuesta Posible",answer_text:"Texto de la Respuesta",
comments_on_question:"Comentarios para esta pregunta",message_text:"Texto del Mensaje",comments_on_answer:"Comentarios, si el usuario escoge esta respuesta",other_incorrect_matches:"Otras Opciones Incorrectas de Apareo",comments_on_wrong_match:"Comentarios si el usuario obtiene este apareo mal"},loading_questions:"Cargando Preguntas..."},calculator:{buttons:{save:"Guardar"},last_formula_row:"la \u00faltima fila de f\u00f3rmulas ser\u00e1 usada para computar la respuesta final",drag_to_reorder:"Arrastrar para Reordenar",
how_many_decimal_places:"%{number_selector} Posiciones Decimales",sample_final_answer:"Este valor es un ejemplo de una respuesta final para este tipo de pregunta",commands:{sum:{name:"suma",description:"Regresa la suma de la lista de valores"},sqrt:{name:"sqrt",description:"Regresa la ra\u00edz cuadrada del valor dado"},tan:{name:"tan",description:"Regresa la tangente del valor dado"},comb:{name:"comb",description:"Regresa el resultado combinado para los valores dados"},rad_to_deg:{name:"rad_to_deg",
description:"Regresa el valor dado convertido de radianes a grados"},deg_to_rad:{name:"deg_to_rad",description:"Regresa el valor dado de grados a radianes"},median:{name:"mediana",description:"Regresa la mediana para la lista de valores"},sin:{name:"sin",description:"Regresa el seno del valor dado"},ln:{name:"ln",description:"Regresa el logar\u00edtmo natural del valor dado"},reverse:{name:"reversa",description:"Reversa el orden de la lista de valores"},pi:{name:"pi",description:"Regresa el valor computado de pi"},
fact:{name:"fact",description:"Regresa el factorial de un n\u00famero dado"},atan:{name:"atan",description:"Regresa el arco tangente del valor dado"},log:{name:"log",description:"Regresa el logaritmo del valor dado con una base opcional"},max:{name:"max",description:"Regresa el valor m\u00e1s alto en la lista"},last:{name:"last",description:"Regresa el \u00faltimo valor en la lista"},asin:{name:"asin",description:"Regresa el arco seno para un valor dado"},mean:{name:"promedio",description:"Regresa el promedio de los valores en la lista"},
ceil:{name:"techo",description:"Regresa la funci\u00f3n techo para un valor dado"},floor:{name:"piso",description:"Regresa la funci\u00f3n piso para un valor dado"},e:{name:"e",description:"Regresa el valor para e"},round:{name:"redondeo",description:"Regresa el valor dado redondeado al n\u00famero entero m\u00e1s cercano"},default_description:"No se ha provisto una descripci\u00f3n",count:{name:"conteo",description:"Regresa el n\u00famero de elementos en la lista"},unrecognized:"%{functionName} no es una funci\u00f3n reconocida",
perm:{name:"perm",description:"Regresa el resultado de permutaci\u00f3n para los valores dados"},first:{name:"primer",description:"Regresa el primer valor en la lista"},abs:{name:"abs",description:"Regresa el valor absoluto de un valor dado"},min:{name:"min",description:"Regressa el valor m\u00ednimo en la lista"},range:{name:"rango",description:"Regresa el rango para la lista de valores"},"if":{name:"if",description:"Eval\u00faa el primer argumento, regresa el segundo argumento si eval\u00faa a un valor que no es cero, de otra manera regresa el tercer valor"},
cos:{name:"cos",description:"Regresa el coseno del valor dado"},at:{name:"at",description:"Regresa el valor indizado en la lista"},no_description:"No se encontr\u00f3 una descripci\u00f3n para la funci\u00f3n, %{functionName}",length:{name:"longitud",description:"Regresa el n\u00famero de argumentos en la lista"},sort:{name:"ordenar",description:"Regresa la lista de valores, ordenado de m\u00ednimo a m\u00e1ximo"},rand:{name:"rand",description:"Regresa un n\u00famero aleatorio entre cero y el rango especificado, o uno si no se da un n\u00famero"},
acos:{name:"acos",description:"Regresa el arco coseno del valor dado"}},headings:{result:"Resultado",formula:"Formula"}}},em2:{quizzes:{confirms:{scrap_and_restart:"Scrap this assessment and start from scratch?"},default_quiz_title:"Assessment","true":true,titles:{find_quiz_question:"Find Assessment Question"},notices:{quiz_data_saved:"Assessment data saved"}}}}});
