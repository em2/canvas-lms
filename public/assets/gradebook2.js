(function(){var q=Handlebars.template,t=Handlebars.templates=Handlebars.templates||{};t._grading_box=q(function(h,d,e,a,b){e=e||h.helpers;h="";var f,c,g=e.helperMissing,i=this.escapeExpression;a=e.assignment_grading_type_is_points||d.assignment_grading_type_is_points;f=e["if"];c=this.program(1,function(l){var p="",j;p+='\n  <input name="default_grade" type="number" value="';j=e.submission||l.submission;j=j===null||j===undefined||j===false?j:j.grade;if(typeof j==="function")j=j.call(l,{hash:{}});else if(j===
void 0)j=g.call(l,"submission.grade",{hash:{}});p+=i(j)+'" class="grading_value grading_box" id="student_grading_';j=e.assignment||l.assignment;j=j===null||j===undefined||j===false?j:j.id;if(typeof j==="function")j=j.call(l,{hash:{}});else if(j===void 0)j=g.call(l,"assignment.id",{hash:{}});p+=i(j)+' %>" style="text-align: center; width: 50px;"/>\n';return p},b);c.hash={};c.fn=c;c.inverse=this.noop;if((a=f.call(d,a,c))||a===0)h+=a;h+="\n";a=e.assignment_grading_type_is_percent||d.assignment_grading_type_is_percent;
f=e["if"];c=this.program(3,function(l){var p="",j;p+='\n  <span name="default_grade" class="grading_box" id="student_grading_';j=e.assignment||l.assignment;j=j===null||j===undefined||j===false?j:j.id;if(typeof j==="function")j=j.call(l,{hash:{}});else if(j===void 0)j=g.call(l,"assignment.id",{hash:{}});p+=i(j)+'">\n    <input type="number" value="';j=e.submission||l.submission;j=j===null||j===undefined||j===false?j:j.grade;if(typeof j==="function")j=j.call(l,{hash:{}});else if(j===void 0)j=g.call(l,
"submission.grade",{hash:{}});p+=i(j)+'" class="grading_value" style="text-align: center; width: 50px;"/>\n    <span style="display: none;">%</span>\n  </span>\n';return p},b);c.hash={};c.fn=c;c.inverse=this.noop;if((a=f.call(d,a,c))||a===0)h+=a;h+="\n";a=e.assignment_grading_type_is_letter_grade||d.assignment_grading_type_is_letter_grade;f=e["if"];c=this.program(5,function(l){var p="",j;p+='\n  <input name="default_grade" type="text" value="';j=e.submission||l.submission;j=j===null||j===undefined||
j===false?j:j.score;if(typeof j==="function")j=j.call(l,{hash:{}});else if(j===void 0)j=g.call(l,"submission.score",{hash:{}});p+=i(j)+'" class="grading_value grading_box score_value" id="student_grading_';j=e.assignment||l.assignment;j=j===null||j===undefined||j===false?j:j.id;if(typeof j==="function")j=j.call(l,{hash:{}});else if(j===void 0)j=g.call(l,"assignment.id",{hash:{}});p+=i(j)+'" style="text-align: center; width: 50px;"/>\n';return p},b);c.hash={};c.fn=c;c.inverse=this.noop;if((a=f.call(d,
a,c))||a===0)h+=a;h+="\n";a=e.assignment_grading_type_is_pass_fail||d.assignment_grading_type_is_pass_fail;f=e["if"];c=this.program(7,function(l){var p="",j,v,k,w;p+='\n  <select name="default_grade" class="grading_value grading_box pass_fail" id="student_grading_<%= assignment.id %>">\n    <option value="">---</option>\n    <option value="complete">';j="Complete";v="gradebooks.grades.complete";k={};k.scope="grading_box";w=e.t||l.t;c={};c.hash=k;if((j=typeof w==="function"?w.call(l,v,j,c):w===void 0?
g.call(l,"t",v,j,c):w)||j===0)p+=j;p+='</option>\n    <option value="incomplete">';j="Incomplete";v="gradebooks.grades.incomplete";k={};k.scope="grading_box";w=e.t||l.t;c={};c.hash=k;if((j=typeof w==="function"?w.call(l,v,j,c):w===void 0?g.call(l,"t",v,j,c):w)||j===0)p+=j;p+="</option>\n  </select>\n";return p},b);c.hash={};c.fn=c;c.inverse=this.noop;if((a=f.call(d,a,c))||a===0)h+=a;h+="\n";a=e.showPointsPossible||d.showPointsPossible;f=e["if"];c=this.program(9,function(l){var p="",j,v,k;p+='\n  <span style="font-size: 0.9em;" >\n    ';
j="out of %{assignment.points_possible}";v={};v.scope="grading_box";k=e.t||l.t;c={};c.hash=v;if((j=typeof k==="function"?k.call(l,"out_of_points_possible",j,c):k===void 0?g.call(l,"t","out_of_points_possible",j,c):k)||j===0)p+=j;p+="\n  </span>\n";return p},b);c.hash={};c.fn=c;c.inverse=this.noop;if((a=f.call(d,a,c))||a===0)h+=a;h+="\n";return h});Handlebars.registerPartial("grading_box",t._grading_box);define("jst/_grading_box",["compiled/handlebars_helpers"],function(){return t._grading_box})})();
(function(){var q=Handlebars.template,t=Handlebars.templates=Handlebars.templates||{};t.gradebook_uploads_form=q(function(h,d,e){e=e||h.helpers;h="";var a,b,f,c,g,i=e.helperMissing,l=this.escapeExpression;h+='<form action="';a=e.action||d.action;if(typeof a==="function")a=a.call(d,{hash:{}});else if(a===void 0)a=i.call(d,"action",{hash:{}});h+=l(a)+'" enctype="multipart/form-data" id="upload_modal" method="post" title="';a="Choose a CSV file to upload";b="titles.upload_form";f={};f.scope="gradebook_uploads_form";
c=e.t||d.t;g={};g.hash=f;if((a=typeof c==="function"?c.call(d,b,a,g):c===void 0?i.call(d,"t",b,a,g):c)||a===0)h+=a;h+='">\n  <input type="hidden" name=\'authenticity_token\' value="';a=e.authenticityToken||d.authenticityToken;if(typeof a==="function")a=a.call(d,{hash:{}});else if(a===void 0)a=i.call(d,"authenticityToken",{hash:{}});h+=l(a)+'">\n  <style>\n    #gradebook-upload-help {\n      display: none;\n      border: 1px solid #ccc;\n      border-radius: 10px;\n      padding: 10px;\n      margin-bottom: 1.4em;\n      background-color: rgba(0,0,0,0.02);\n    }\n    tr.table-callout-notes td div {\n      padding: 6px;\n      border-radius: 10px;\n      font-weight: bold;\n    }\n    tr.table-callout-notes-spacer td, tr.table-callout-notes td{\n      padding: 0 10px;\n      border: none;\n      background-color: transparent !important;\n      text-align: center;\n      vertical-align: bottom;\n    }\n    .table-callout-notes-spacer span {\n      width: 0;\n      border-style: solid;\n      border-color: #FBD850 transparent;\n      border-width: 15px 15px 0px ;\n      margin: 0 auto;\n      display: block;\n    }\n  </style>\n  <p><a class="help" id="gradebook-upload-help-trigger" href="#">';
a="What should the CSV file look like?";b="what_should_csv_look_like";f={};f.scope="gradebook_uploads_form";c=e.t||d.t;g={};g.hash=f;if((a=typeof c==="function"?c.call(d,b,a,g):c===void 0?i.call(d,"t",b,a,g):c)||a===0)h+=a;h+='</a></p>\n  <div id="gradebook-upload-help">\n    <h3 style="margin:0">';a="Example CSV file";b="example_csv_file";f={};f.scope="gradebook_uploads_form";c=e.t||d.t;g={};g.hash=f;if((a=typeof c==="function"?c.call(d,b,a,g):c===void 0?i.call(d,"t",b,a,g):c)||a===0)h+=a;h+='</h3>\n    <table class="stylized striped bordered">\n      <thead>\n        <tr class="table-callout-notes">\n          <td colspan="4"><div class="ui-state-active">';
a="You Must have *all* of these columns, you only *need* one per row.";b="explanation_of_required_columns";f={};f.scope="gradebook_uploads_form";f.w0="<em>$1</em>";c=e.t||d.t;g={};g.hash=f;if((a=typeof c==="function"?c.call(d,b,a,g):c===void 0?i.call(d,"t",b,a,g):c)||a===0)h+=a;h+='</div></td>\n          <td><div class="ui-state-active">';a="Optional, ignored.";b="optional_ignored";f={};f.scope="gradebook_uploads_form";c=e.t||d.t;g={};g.hash=f;if((a=typeof c==="function"?c.call(d,b,a,g):c===void 0?
i.call(d,"t",b,a,g):c)||a===0)h+=a;h+='</div></td>\n          <td colspan="2"><div class="ui-state-active">';a='Leaving the ID intact (the "(581)" part in this case) will help match better. You can also add new assignments that will be created on the fly.';b="leaving_id_will_match_better_can_add_new_assignment";f={};f.scope="gradebook_uploads_form";c=e.t||d.t;g={};g.hash=f;if((a=typeof c==="function"?c.call(d,b,a,g):c===void 0?i.call(d,"t",b,a,g):c)||a===0)h+=a;h+='</div></td>\n          <td colspan="2"><div class="ui-state-active">';
a="Optional, ignored.";b="optional_ignored";f={};f.scope="gradebook_uploads_form";c=e.t||d.t;g={};g.hash=f;if((a=typeof c==="function"?c.call(d,b,a,g):c===void 0?i.call(d,"t",b,a,g):c)||a===0)h+=a;h+='</div></td>\n        </tr>\n        <tr class="table-callout-notes-spacer">\n          <td colspan="4"><span /></td>\n          <td><span /></td>\n          <td colspan="2"><span /></td>\n          <td colspan="2"><span /></td>\n        </tr>\n        <tr>\n          <th>Student</th>\n          <th>ID</th>\n          <th>SIS User ID</th>\n          <th>SIS Login ID</th>\n          <th>Section</th>\n          <th>';
a="Existing Assignment (581)";b="existing_assignment_example";f={};f.scope="gradebook_uploads_form";c=e.t||d.t;g={};g.hash=f;if((a=typeof c==="function"?c.call(d,b,a,g):c===void 0?i.call(d,"t",b,a,g):c)||a===0)h+=a;h+="</th>\n          <th>";a="A New Assignment";b="new_assignment_example";f={};f.scope="gradebook_uploads_form";c=e.t||d.t;g={};g.hash=f;if((a=typeof c==="function"?c.call(d,b,a,g):c===void 0?i.call(d,"t",b,a,g):c)||a===0)h+=a;h+='</th>\n          <th>Current Score</th>\n          <th>Final Score</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr>\n          <td colspan="2">Points Possible</td>\n          <td></td>\n          <td></td>\n          <td></td>\n          <td>50</td>\n          <td>10</td>\n          <td></td>\n          <td></td>\n        </tr>\n        <tr>\n          <td>Smith, John</td>\n          <td>12345</td>\n          <td>2122</td>\n          <td>12321</td>\n          <td>night</td>\n          <td>46</td>\n          <td>8</td>\n          <td></td>\n          <td></td>\n        </tr>\n        <tr>\n          <td>King, Ben</td>\n          <td></td>\n          <td></td>\n          <td></td>\n          <td></td>\n          <td>34</td>\n          <td>60</td>\n          <td></td>\n          <td></td>\n        </tr>\n        <tr>\n          <td></td>\n          <td>12347</td>\n          <td></td>\n          <td></td>\n          <td></td>\n          <td>38</td>\n          <td>3</td>\n          <td></td>\n          <td></td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td>123</td>\n          <td></td>\n          <td></td>\n          <td>40</td>\n          <td></td>\n          <td></td>\n          <td></td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n          <td></td>\n          <td>3232</td>\n          <td></td>\n          <td>44</td>\n          <td>7</td>\n          <td></td>\n          <td></td>\n        </tr>\n      </tbody>\n    </table>\n    <p>';
a="If in doubt, you can always *download a CSV*, change the grades you want and re-upload the same file.";b="instructions.csv_download_and_upload";f={};f.scope="gradebook_uploads_form";f.w0='<a href="%{download_gradebook_csv_url}">$1</a>';c=e.t||d.t;g={};g.hash=f;if((a=typeof c==="function"?c.call(d,b,a,g):c===void 0?i.call(d,"t",b,a,g):c)||a===0)h+=a;h+='</p>\n  </div>\n\n  <p style="font-size: 1.2em;">\n    <label for="gradebook_upload_uploaded_data">';a="Choose a CSV file to upload:";b="labels.upload";
f={};f.scope="gradebook_uploads_form";c=e.t||d.t;g={};g.hash=f;if((a=typeof c==="function"?c.call(d,b,a,g):c===void 0?i.call(d,"t",b,a,g):c)||a===0)h+=a;h+='</label>\n    <input id="gradebook_upload_uploaded_data" name="gradebook_upload[uploaded_data]" type="file" />\n  </p>\n  \n  <button class="button" type="submit">';a="Upload Data";b="buttons.upload_data";f={};f.scope="gradebook_uploads_form";c=e.t||d.t;g={};g.hash=f;if((a=typeof c==="function"?c.call(d,b,a,g):c===void 0?i.call(d,"t",b,a,g):c)||
a===0)h+=a;h+="</button>\n</form>\n";return h});define("jst/gradebook_uploads_form",["compiled/handlebars_helpers"],function(){return t.gradebook_uploads_form})})();
(function(){var q=Handlebars.template,t=Handlebars.templates=Handlebars.templates||{};t.re_upload_submissions_form=q(function(h,d,e){e=e||h.helpers;h="";var a,b,f,c,g,i=e.helperMissing;h+='<form action="." enctype="multipart/form-data" id="re_upload_submissions_form" method="post" style="display: none;" title="';a="Re-Upload Submission Files";b="reupload_submission_files";f={};f.scope="re_upload_submissions_form";c=e.t||d.t;g={};g.hash=f;if((a=typeof c==="function"?c.call(d,b,a,g):c===void 0?i.call(d,
"t",b,a,g):c)||a===0)h+=a;h+='">\n  <p>\n    ';a="If you made changes to the student submission files you downloaded before, just zip them back up and upload the zip with the form below. Students will see the modified files in their comments for the submission.";b="upload_info";f={};f.scope="re_upload_submissions_form";c=e.t||d.t;g={};g.hash=f;if((a=typeof c==="function"?c.call(d,b,a,g):c===void 0?i.call(d,"t",b,a,g):c)||a===0)h+=a;h+="\n  </p>\n  <p>\n    <i>";a="Make sure you don't change the names of the submission files so we can recognize them.";
b="upload_warning";f={};f.scope="re_upload_submissions_form";c=e.t||d.t;g={};g.hash=f;if((a=typeof c==="function"?c.call(d,b,a,g):c===void 0?i.call(d,"t",b,a,g):c)||a===0)h+=a;h+='</i>\n  </p>\n  <input type="file" name="submissions_zip"/>\n  <button type="submit" class="button">';a="Upload Files";b="buttons.upload";f={};f.scope="re_upload_submissions_form";c=e.t||d.t;g={};g.hash=f;if((a=typeof c==="function"?c.call(d,b,a,g):c===void 0?i.call(d,"t",b,a,g):c)||a===0)h+=a;h+="</button>\n</form>\n";
return h});define("jst/re_upload_submissions_form",["compiled/handlebars_helpers"],function(){return t.re_upload_submissions_form})})();
I18n.scoped("message_students",function(q){var t=$("#message_students_dialog"),h={};window.messageStudents=function(d){h=d;t.find(".message_types").empty();for(var e in d.options){var a=$("<option/>"),b=d.options[e];a.val(e).text(b.text);t.find(".message_types").append(a)}a=d.title;b=t.find("ul li.blank:first");var f=t.find("ul"),c={};t.find("ul li:not(.blank)").remove();for(e in d.students){var g=b.clone(true).removeClass("blank");g.find(".name").text(d.students[e].name);g.find(".score").text(d.students[e].score);
g.data("id",d.students[e].id);g.user_data=d.students[e];f.append(g.show());c[d.students[e].id]=g}f.show();t.data("students_hash",c);t.find(".asset_title").text(a);t.find(".out_of").showIf(d.points_possible!=null);t.find(".send_button").text(q.t("send_message","Send Message"));t.find(".points_possible").text(d.points_possible);t.find("textarea").val("");t.find("select")[0].selectedIndex=0;t.find("select").change();t.dialog("close").dialog({width:600,modal:true}).dialog("open").dialog("option","title",
q.t("message_student","Message Students for %{course_name}",{course_name:a}))};$(document).ready(function(){t.find(".cutoff_score").bind("change blur keyup",function(){t.find("select").change()});t.find(".cancel_button").click(function(){t.dialog("close")});$("#message_assignment_recipients").formSubmit({processData:function(d){var e=[];$(this).find(".student:visible").each(function(){e.push($(this).data("id"))});if(e.length==0)return false;d.recipients=e.join(",");return d},beforeSubmit:function(){$(this).find("button").attr("disabled",
true).filter(".send_button").text(q.t("buttons.sending_message","Sending Message..."))},success:function(){$(this).find(".send_button").text("Message Sent!");var d=$(this);setTimeout(function(){d.find("button").attr("disabled",false).filter(".send_button").text(q.t("buttons.send_message","Send Message"));$("#message_students_dialog").dialog("close")},2E3)},error:function(){$(this).find("button").attr("disabled",false).filter(".send_button").text(q.t("buttons.send_message_failed","Sending Message Failed, please try again"))}});
t.find("select").change(function(){var d=parseInt($(this).val(),10)||0,e=h.options[d],a=t.data("students_hash"),b=parseFloat(t.find(".cutoff_score").val(),10);if(!b&&b!==0)b=null;var f=null,c=[];for(d in a)c.push(a[d]);if(a)if(e&&e.callback)f=e.callback.call(window.messageStudents,b,c);else if(h.callback)f=h.callback.call(window.messageStudents,e.text,b,c);f=f||[];t.find(".cutoff_holder").showIf(e.cutoff);t.find(".student_list").toggleClass("show_score",e.cutoff||e.score);t.find("button").attr("disabled",
f.length==0);e={};for(d in f)e[parseInt(f[d],10)||0]=true;for(d in a)a[d].showIf(e[d])})})});
(function(){var q,t,h,d,e,a,b=function(f,c){return function(){return f.apply(c,arguments)}};this.MultiGrid=q=function(){return function(f,c,g,i){var l,p,j;this.data=f;this.parent_grid_idx=i;this.grids=function(){var v,k,w;w=[];v=0;for(k=g.length;v<k;v++){p=g[v];j=$.extend({},c,p.options);l=new Slick.Grid(p.selector,this.data,p.columns,j);l.multiview_grid_opts=p;p.$viewport=$(p.selector).find(".slick-viewport");if(p===g[this.parent_grid_idx])this.parent_grid=l;else p.$viewport.css("overflow-y","hidden");
w.push(l)}return w}.call(this);this.parent_grid.onViewportChanged=b(function(){var v,k,w,B,x;B=this.grids;x=[];k=0;for(w=B.length;k<w;k++){v=B[k];x.push(v!==this.parent_grid?(v.multiview_grid_opts.$viewport[0].scrollTop=this.parent_grid.multiview_grid_opts.$viewport[0].scrollTop,v.multiview_grid_opts.$viewport.trigger("scroll.slickgrid")):void 0)}return x},this)}}();a=["render","removeRow","removeAllRows","updateRowCount","autosizeColumns","resizeCanvas","invalidate"];h=function(f){return q.prototype[f]=
function(){var c,g,i,l,p;l=this.grids;p=[];g=0;for(i=l.length;g<i;g++){c=l[g];p.push(c[f].apply(c,arguments))}return p}};d=0;for(e=a.length;d<e;d++){t=a[d];h(t)}}).call(this);
(function(){var q,t=function(h,d){return function(){return h.apply(d,arguments)}};q=function(){function h(){}h.calculate=function(d,e,a){var b;b={};b.group_sums=$.map(e,t(function(f){return{group:f,current:this.create_group_sum(f,d,true),"final":this.create_group_sum(f,d,false)}},this));b.current=this.calculate_total(b.group_sums,true,a);b["final"]=this.calculate_total(b.group_sums,false,a);return b};h.create_group_sum=function(d,e,a){var b,f,c,g,i,l,p,j,v;g={submissions:[],score:0,possible:0,submission_count:0};
p=d.assignments;i=0;for(l=p.length;i<l;i++){b=p[i];f={score:0,possible:0,percent:0,drop:false,submitted:false};c=$.detect(e,function(){return this.assignment_id===b.id});if(c==null)c={score:null};c.assignment_group_id=d.id;if(c.points_possible==null)c.points_possible=b.points_possible;f.submission=c;g.submissions.push(f);if(!(a&&(c.score==null||c.score===""))){f.score=this.parse(c.score);f.possible=this.parse(b.points_possible);f.percent=this.parse(f.score/f.possible);f.submitted=c.score!=null&&c.score!==
"";if(f.submitted)g.submission_count+=1}}g.submissions.sort(function(k,w){return k.percent-w.percent});a=$.extend({drop_lowest:0,drop_highest:0,never_drop:[]},d.rules);d=0;j=["low","high"];c=0;for(l=j.length;c<l;c++){e=j[c];v=g.submissions;i=0;for(p=v.length;i<p;i++){f=v[i];if(!f.drop&&a["drop_"+e+"est"]>0&&$.inArray(f.assignment_id,a.never_drop)===-1&&f.possible>0&&f.submitted){f.drop=true;if((f=f.submission)!=null)f.drop=true;a["drop_"+e+"est"]-=1;d+=1}}}if(d>0&&d===g.submission_count){g.submissions[g.submissions.length-
1].drop=false;if((f=g.submissions[g.submissions.length-1].submission)!=null)f.drop=false;d-=1}g.submission_count-=d;a=g.submissions;d=0;for(e=a.length;d<e;d++){f=a[d];f.drop||(g.score+=f.score)}a=g.submissions;e=0;for(d=a.length;e<d;e++){f=a[e];f.drop||(g.possible+=f.possible)}return g};h.calculate_total=function(d,e,a){var b,f,c,g,i,l,p;f=e?"current":"final";if(a==="percent"){l=i=a=c=0;for(p=d.length;l<p;l++){b=d[l];if(b.group.group_weight>0){if(b[f].submission_count>0){g=b[f].score/b[f].possible;
c+=b.group.group_weight*g;a+=b.group.group_weight}i+=b.group.group_weight}}if(e&&a<100)c=c*(i<100?i:100)/a;return{score:c,possible:100}}else return{score:this.sum(function(){var j,v,k;k=[];j=0;for(v=d.length;j<v;j++){b=d[j];k.push(b[f].score)}return k}()),possible:this.sum(function(){var j,v,k;k=[];j=0;for(v=d.length;j<v;j++){b=d[j];k.push(b[f].possible)}return k}())}};h.sum=function(d){var e,a,b,f;b=e=0;for(f=d.length;b<f;b++){a=d[b];e+=a}return e};h.parse=function(d){return(d=parseFloat(d))&&isFinite(d)?
d:0};h.letter_grade=function(d,e){if(e<0)e=0;return $.grep(d,function(a,b){return e>=a[1]*100||b===d.length-1})[0][0]};return h}();window.INST.GradeCalculator=q}).call(this);
(function(){var q=Handlebars.template,t=Handlebars.templates=Handlebars.templates||{};t.SetDefaultGradeDialog=q(function(h,d,e,a){e=e||h.helpers;a=a||h.partials;h="";var b,f,c,g,i,l=e.helperMissing,p=this.escapeExpression;h+='<form action="';b=e.url||d.url;if(typeof b==="function")b=b.call(d,{hash:{}});else if(b===void 0)b=l.call(d,"url",{hash:{}});h+=p(b)+'" method="POST" title="';b="Default grade for %{assignment.name}";f="dialog_title";c={};c.scope="SetDefaultGradeDialog";g=e.t||d.t;i={};i.hash=
c;if((b=typeof g==="function"?g.call(d,f,b,i):g===void 0?l.call(d,"t",f,b,i):g)||b===0)h+=b;h+='">\n  <input type="hidden" name="assignment_id" class="assignment_id" value="';b=e.assignment||d.assignment;b=b===null||b===undefined||b===false?b:b.id;if(typeof b==="function")b=b.call(d,{hash:{}});else if(b===void 0)b=l.call(d,"assignment.id",{hash:{}});h+=p(b)+'"/> \n  <div>\n    ';b="Give all students the same grade for *%{assignment.name}* by entering and submitting a grade value below:";f="default_grades";
c={};c.scope="SetDefaultGradeDialog";c.w0="<b>$1</b>";g=e.t||d.t;i={};i.hash=c;if((b=typeof g==="function"?g.call(d,f,b,i):g===void 0?l.call(d,"t",f,b,i):g)||b===0)h+=b;h+='\n  </div> \n  <p style="text-align: center;" class="grading_box_holder">\n    ';if((b=this.invokePartial(a.grading_box,"grading_box",d,e,a))||b===0)h+=b;h+='\n  </p>\n  <div>\n    <input type="checkbox" name="overwrite_existing_grades" id="overwrite_existing_grades_for_';b=e.assignment||d.assignment;b=b===null||b===undefined||
b===false?b:b.id;if(typeof b==="function")b=b.call(d,{hash:{}});else if(b===void 0)b=l.call(d,"assignment.id",{hash:{}});h+=p(b)+'"/>\n    <label for="overwrite_existing_grades_for_';b=e.assignment||d.assignment;b=b===null||b===undefined||b===false?b:b.id;if(typeof b==="function")b=b.call(d,{hash:{}});else if(b===void 0)b=l.call(d,"assignment.id",{hash:{}});h+=p(b)+'">';b="Overwrite already-entered grades";f="overwrite";c={};c.scope="SetDefaultGradeDialog";g=e.t||d.t;i={};i.hash=c;if((b=typeof g===
"function"?g.call(d,f,b,i):g===void 0?l.call(d,"t",f,b,i):g)||b===0)h+=b;h+='</label>\n  </div>\n  <button type="submit" class="button" data-text-while-loading="';b="Setting Grades...";f="set_grades_button_loading";c={};c.scope="SetDefaultGradeDialog";g=e.t||d.t;i={};i.hash=c;if((b=typeof g==="function"?g.call(d,f,b,i):g===void 0?l.call(d,"t",f,b,i):g)||b===0)h+=b;h+='">';b="Set Default Grade";f="set_grades_button";c={};c.scope="SetDefaultGradeDialog";g=e.t||d.t;i={};i.hash=c;if((b=typeof g==="function"?
g.call(d,f,b,i):g===void 0?l.call(d,"t",f,b,i):g)||b===0)h+=b;h+="</button>\n</form>\n";return h});define("jst/SetDefaultGradeDialog",["compiled/handlebars_helpers"],function(){return t.SetDefaultGradeDialog})})();
(function(){var q=function(t,h){return function(){return t.apply(h,arguments)}};I18n.scoped("gradebook2",function(t){return this.SetDefaultGradeDialog=function(){function h(d,e){this.assignment=d;this.gradebook=e;this.initDialog=q(this.initDialog,this);this.initDialog()}h.prototype.initDialog=function(){var d;d={assignment:this.assignment,showPointsPossible:this.assignment.points_possible||this.assignment.points_possible==="0",url:"/courses/"+this.gradebook.options.context_id+"/gradebook/update_submission"};
d["assignment_grading_type_is_"+this.assignment.grading_type]=true;this.$dialog=$(Template("SetDefaultGradeDialog",d));this.$dialog.dialog({resizable:false,width:350,open:q(function(){return this.$dialog.find(".grading_box").focus()},this),close:q(function(){return this.$dialog.remove()},this)}).fixDialogButtons();return this.$dialog.formSubmit({disableWhileLoading:true,processData:q(function(e){var a,b,f;f=this.gradebook.students;for(a in f){b=f[a];if(b["assignment_"+this.assignment.id].score==null||
e.overwrite_existing_grades){e["submissions[submission_"+a+"][assignment_id]"]=this.assignment.id;e["submissions[submission_"+a+"][user_id]"]=b.id;e["submissions[submission_"+a+"][grade]"]=e.default_grade}}if(a===0){alert(t.t("alerts.none_to_update","None to Update"));return false}return e},this),success:q(function(e){var a,b;b=function(){var f,c,g;g=[];f=0;for(c=e.length;f<c;f++){a=e[f];g.push(a.submission)}return g}();$.publish("submissions_updated",[b]);alert(t.t("alerts.scores_updated",{one:"1 Student score updated",
other:"%{count} Student scores updated"},{count:e.length}));return this.$dialog.remove()},this)})};return h}()})}).call(this);
(function(){var q=Handlebars.template,t=Handlebars.templates=Handlebars.templates||{};t.AssignmentGroupWeightsDialog=q(function(h,d,e){e=e||h.helpers;h="";var a,b,f,c,g,i=e.helperMissing;h+='<div title="';a="Manage assignment group weighting";b="titles.assignment_group_weights";f={};f.scope="AssignmentGroupWeightsDialog";c=e.t||d.t;g={};g.hash=f;if((a=typeof c==="function"?c.call(d,b,a,g):c===void 0?i.call(d,"t",b,a,g):c)||a===0)h+=a;h+='" style="display:none;" id="assignment_group_weights_dialog">\n  <p style="margin-top: 8px;">\n    <input type="checkbox" id="group_weighting_scheme" name="group_weighting_scheme"/>\n    <label for="group_weighting_scheme">';
a="Weight final grade based on groups";b="weight_final";f={};f.scope="AssignmentGroupWeightsDialog";c=e.t||d.t;g={};g.hash=f;if((a=typeof c==="function"?c.call(d,b,a,g):c===void 0?i.call(d,"t",b,a,g):c)||a===0)h+=a;h+='</label>\n  </p>\n  <table>\n    <tbody class="groups_holder">\n      <tr style="display:none;" class="assignment_group_row blank">\n        <th scope="row"><label></label></th>\n        <td><input type="number" min="0" max="100" class="group_weight"/>%</td>\n      </tr>\n    </tbody>\n    <tfoot>\n      <tr>\n        <th>';
a="Total";b="titles.total";f={};f.scope="AssignmentGroupWeightsDialog";c=e.t||d.t;g={};g.hash=f;if((a=typeof c==="function"?c.call(d,b,a,g):c===void 0?i.call(d,"t",b,a,g):c)||a===0)h+=a;h+='</th>\n        <td>&nbsp;<span class="total_weight"></span>%</td>\n      </tr>\n    </tfoot>\n  </table>\n  <button class="button" type="submit">';a="Save";b="buttons.save";f={};f.scope="AssignmentGroupWeightsDialog";c=e.t||d.t;g={};g.hash=f;if((a=typeof c==="function"?c.call(d,b,a,g):c===void 0?i.call(d,"t",b,
a,g):c)||a===0)h+=a;h+="</button>\n</div>\n";return h});define("jst/AssignmentGroupWeightsDialog",["compiled/handlebars_helpers"],function(){return t.AssignmentGroupWeightsDialog})})();
(function(){var q=function(t,h){return function(){return t.apply(h,arguments)}};this.AssignmentGroupWeightsDialog=function(){function t(h){this.afterSave=q(this.afterSave,this);this.save=q(this.save,this);this.calcTotal=q(this.calcTotal,this);this.update=q(this.update,this);this.render=q(this.render,this);this.$dialog=$(Template("AssignmentGroupWeightsDialog"));this.$dialog.dialog({autoOpen:false,resizable:false,width:350,buttons:[{text:this.$dialog.find("button[type=submit]").hide().text(),click:this.save}]});
this.$dialog.delegate("input","change keyup keydown input",this.calcTotal);this.$dialog.find("#group_weighting_scheme").change(q(function(d){d=!d.currentTarget.checked;this.$dialog.find("table").css("opacity",d?0.5:1);return this.$dialog.find(".assignment_group_row input").attr("disabled",d)},this));this.$group_template=this.$dialog.find(".assignment_group_row.blank").removeClass("blank").detach().show();this.$groups_holder=this.$dialog.find(".groups_holder");this.update(h)}t.prototype.render=function(){var h,
d,e,a,b;this.$groups_holder.empty();b=this.options.assignmentGroups;e=0;for(a=b.length;e<a;e++){h=b[e];d="assignment_group_"+h.id+"_weight";this.$group_template.clone().data("assignment_group",h).find("label").attr("for",d).text(h.name).end().find("input").attr("id",d).val(h.group_weight).end().appendTo(this.$groups_holder)}this.$dialog.find("#group_weighting_scheme").prop("checked",this.options.context.group_weighting_scheme==="percent").change();return this.calcTotal()};t.prototype.update=function(h){this.options=
h;return this.render()};t.prototype.calcTotal=function(){var h;h=0;this.$dialog.find(".assignment_group_row input").each(function(){return h+=Number($(this).val())});return this.$dialog.find(".total_weight").text(h)};t.prototype.save=function(){var h,d,e;h="/courses/"+this.options.context.context_id;e=[];d=this.$dialog.find("#group_weighting_scheme").is(":checked")?"percent":"equal";d!==this.options.context.group_weighting_scheme&&e.push($.ajaxJSON(h,"PUT",{"course[group_weighting_scheme]":d},q(function(a){return this.options.context.group_weighting_scheme=
a.course.group_weighting_scheme},this)));this.$dialog.find(".assignment_group_row").each(function(a,b){var f,c;f=$(b).data("assignment_group");c=Number($(b).find("input").val());if(c!==f.group_weight)return e.push($.ajaxJSON(""+h+"/assignments/"+f.id,"PUT",{"assignment_group[group_weight]":c},function(g){return $.extend(f,g.assignment_group)}))});return this.$dialog.disableWhileLoading($.when.apply($,e).done(this.afterSave),{buttons:[".ui-button-text"]})};t.prototype.afterSave=function(){this.$dialog.dialog("close");
this.render();return $.publish("assignment_group_weights_changed",this.options)};return t}()}).call(this);
(function(){var q=Handlebars.template,t=Handlebars.templates=Handlebars.templates||{};t.AssignmentDetailsDialog=q(function(h,d,e,a,b){e=e||h.helpers;h="";var f,c,g,i,l=e.helperMissing,p=this.escapeExpression;h+='<div id="assignment-details-dialog" title="';a="Grade statistics for: %{assignment.name}";f="grading_statistics_for_assignment";c={};c.scope="AssignmentDetailsDialog";g=e.t||d.t;i={};i.hash=c;if((a=typeof g==="function"?g.call(d,f,a,i):g===void 0?l.call(d,"t",f,a,i):g)||a===0)h+=a;h+='">\n  ';
a=e.showDistribution||d.showDistribution;f=e["if"];i=this.program(1,function(j){var v="",k,w,B,x;v+='\n    <div class="distribution" style="display: block; ">\n      <div class="bar-left"></div>\n      <div class="none-left" title="';k="No one scored lower than %{min}";w="no_one_scored_lower";B={};B.scope="AssignmentDetailsDialog";x=e.t||j.t;i={};i.hash=B;if((k=typeof x==="function"?x.call(j,w,k,i):x===void 0?l.call(j,"t",w,k,i):x)||k===0)v+=k;v+='" style="width: ';k=e.noneLeftWidth||j.noneLeftWidth;
if(typeof k==="function")k=k.call(j,{hash:{}});else if(k===void 0)k=l.call(j,"noneLeftWidth",{hash:{}});v+=p(k)+"%; left: ";k=e.noneLeftLeft||j.noneLeftLeft;if(typeof k==="function")k=k.call(j,{hash:{}});else if(k===void 0)k=l.call(j,"noneLeftLeft",{hash:{}});v+=p(k)+'%; "></div>\n      <div class="some-left" title="';k="Scores lower than the average of %{average}";w="scores_lower_than_the_average";B={};B.scope="AssignmentDetailsDialog";x=e.t||j.t;i={};i.hash=B;if((k=typeof x==="function"?x.call(j,
w,k,i):x===void 0?l.call(j,"t",w,k,i):x)||k===0)v+=k;v+='" style="width: ';k=e.someLeftWidth||j.someLeftWidth;if(typeof k==="function")k=k.call(j,{hash:{}});else if(k===void 0)k=l.call(j,"someLeftWidth",{hash:{}});v+=p(k)+"%; left: ";k=e.someLeftLeft||j.someLeftLeft;if(typeof k==="function")k=k.call(j,{hash:{}});else if(k===void 0)k=l.call(j,"someLeftLeft",{hash:{}});v+=p(k)+'%; "></div>\n      <div class="some-right" title="';k="Scores higher than the average of %{average}";w="scores_higher_than_the_average";
B={};B.scope="AssignmentDetailsDialog";x=e.t||j.t;i={};i.hash=B;if((k=typeof x==="function"?x.call(j,w,k,i):x===void 0?l.call(j,"t",w,k,i):x)||k===0)v+=k;v+='" style="width: ';k=e.someRightWidth||j.someRightWidth;if(typeof k==="function")k=k.call(j,{hash:{}});else if(k===void 0)k=l.call(j,"someRightWidth",{hash:{}});v+=p(k)+"%; left: ";k=e.someRightLeft||j.someRightLeft;if(typeof k==="function")k=k.call(j,{hash:{}});else if(k===void 0)k=l.call(j,"someRightLeft",{hash:{}});v+=p(k)+'%; "></div>\n      <div class="none-right" title="';
k="No one scored higher than %{max}";w="no_one_scored_higher";B={};B.scope="AssignmentDetailsDialog";x=e.t||j.t;i={};i.hash=B;if((k=typeof x==="function"?x.call(j,w,k,i):x===void 0?l.call(j,"t",w,k,i):x)||k===0)v+=k;v+='" style="width: ';k=e.noneRightWidth||j.noneRightWidth;if(typeof k==="function")k=k.call(j,{hash:{}});else if(k===void 0)k=l.call(j,"noneRightWidth",{hash:{}});v+=p(k)+"%; left: ";k=e.noneRightLeft||j.noneRightLeft;if(typeof k==="function")k=k.call(j,{hash:{}});else if(k===void 0)k=
l.call(j,"noneRightLeft",{hash:{}});v+=p(k)+'%; "></div>\n      <div class="bar-right"></div>\n    </div>\n  ';return v},b);i.hash={};i.fn=i;i.inverse=this.noop;if((a=f.call(d,a,i))||a===0)h+=a;h+='\n  <table id="assignment-details-dialog-stats-table">\n    <tr>\n      <th scope="row">';a="Average Score:";f="average_score";c={};c.scope="AssignmentDetailsDialog";g=e.t||d.t;i={};i.hash=c;if((a=typeof g==="function"?g.call(d,f,a,i):g===void 0?l.call(d,"t",f,a,i):g)||a===0)h+=a;h+="</th>\n      <td>";
a=e.average||d.average;if(typeof a==="function")a=a.call(d,{hash:{}});else if(a===void 0)a=l.call(d,"average",{hash:{}});h+=p(a)+'</td>\n    </tr>\n    <tr>\n      <th scope="row">';a="High Score:";f="high_score";c={};c.scope="AssignmentDetailsDialog";g=e.t||d.t;i={};i.hash=c;if((a=typeof g==="function"?g.call(d,f,a,i):g===void 0?l.call(d,"t",f,a,i):g)||a===0)h+=a;h+="</th>\n      <td>";a=e.max||d.max;if(typeof a==="function")a=a.call(d,{hash:{}});else if(a===void 0)a=l.call(d,"max",{hash:{}});h+=
p(a)+'</td>\n    </tr>\n    <tr>\n      <th scope="row">';a="Low Score:";f="low_score";c={};c.scope="AssignmentDetailsDialog";g=e.t||d.t;i={};i.hash=c;if((a=typeof g==="function"?g.call(d,f,a,i):g===void 0?l.call(d,"t",f,a,i):g)||a===0)h+=a;h+="</th>\n      <td>";a=e.min||d.min;if(typeof a==="function")a=a.call(d,{hash:{}});else if(a===void 0)a=l.call(d,"min",{hash:{}});h+=p(a)+'</td>\n    </tr>\n    <tr>\n      <th scope="row">';a="Total Submitted:";f="total_submitted";c={};c.scope="AssignmentDetailsDialog";
g=e.t||d.t;i={};i.hash=c;if((a=typeof g==="function"?g.call(d,f,a,i):g===void 0?l.call(d,"t",f,a,i):g)||a===0)h+=a;h+="</th>\n      <td>";a="%{cnt} submissions";f="count_of_submissions";c={};c.scope="AssignmentDetailsDialog";g=e.t||d.t;i={};i.hash=c;if((a=typeof g==="function"?g.call(d,f,a,i):g===void 0?l.call(d,"t",f,a,i):g)||a===0)h+=a;h+="</td>\n    </tr>\n  </table>\n</div>";return h});define("jst/AssignmentDetailsDialog",["compiled/handlebars_helpers"],function(){return t.AssignmentDetailsDialog})})();
(function(){var q=Object.prototype.hasOwnProperty;I18n.scoped("AssignmentDetailsDialog",function(){return this.AssignmentDetailsDialog=function(){return function(t,h){var d,e,a,b,f;this.assignment=t;this.gradebook=h;e=function(){var c,g,i;c=this.gradebook.students;i=[];for(d in c)if(q.call(c,d)){a=c[d];if(((g=a["assignment_"+this.assignment.id])!=null?g.score:void 0)!=null)i.push(a["assignment_"+this.assignment.id].score)}return i}.call(this);e={assignment:this.assignment,cnt:e.length,max:Math.max.apply(Math,
e),min:Math.min.apply(Math,e),average:function(c){var g,i,l,p;l=i=0;for(p=c.length;l<p;l++){g=c[l];i+=g}return Math.round(i/c.length)}(e)};f=b=0;$.extend(e,{showDistribution:e.average&&this.assignment.points_possible,noneLeftWidth:f=100*(e.min/this.assignment.points_possible),noneLeftLeft:(b+=f)-f,someLeftWidth:f=100*((e.average-e.min)/this.assignment.points_possible),someLeftLeft:(b+=f)-f,someRightWidth:f=100*((e.max-e.average)/this.assignment.points_possible),someRightLeft:(b+=f)-f,noneRightWidth:f=
100*((this.assignment.points_possible-e.max)/this.assignment.points_possible),noneRightLeft:(b+=f)-f});$(Template("AssignmentDetailsDialog",e)).dialog({width:375,close:function(){return $(this).remove()}})}}()})}).call(this);
(function(){var q=Handlebars.template,t=Handlebars.templates=Handlebars.templates||{};t.CurveGradesDialog=q(function(h,d,e,a,b){e=e||h.helpers;h="";var f,c,g,i,l=e.helperMissing,p=this.escapeExpression;h+='<form action="';a=e.action||d.action;if(typeof a==="function")a=a.call(d,{hash:{}});else if(a===void 0)a=l.call(d,"action",{hash:{}});h+=p(a)+'" id="curve_grade_dialog" style="display: none;" title="';a="Curve Grade for %{assignment.name}";f="curve_grade_for_assignment";c={};c.scope="CurveGradesDialog";
g=e.t||d.t;i={};i.hash=c;if((a=typeof g==="function"?g.call(d,f,a,i):g===void 0?l.call(d,"t",f,a,i):g)||a===0)h+=a;h+='">\n  <input type="hidden" name="_method" value="POST"/>\n  <input type="hidden" name="assignment_id" class="assignment_id" value="';a=e.assignment||d.assignment;a=a===null||a===undefined||a===false?a:a.id;if(typeof a==="function")a=a.call(d,{hash:{}});else if(a===void 0)a=l.call(d,"assignment.id",{hash:{}});h+=p(a)+'" />\n  <p>\n    ';a="Enter an average grade for the curve for *%{assignment.name}*. The chart shows a best attempt at curving the grades based on current student scores.";
f="curve_average";c={};c.scope="CurveGradesDialog";c.w0="<b>$1</b>";g=e.t||d.t;i={};i.hash=c;if((a=typeof g==="function"?g.call(d,f,a,i):g===void 0?l.call(d,"t",f,a,i):g)||a===0)h+=a;h+='\n  </p>\n  <div style="min-height: 100px;">\n    <table cellpadding="0" cellspacing="0">\n      <tr id="results_list"></tr>\n      <tr id="results_values"></tr>\n    </table>\n  </div>\n  <p style="text-align: center;">\n    ';a="Average Score";f="average_score";c={};c.scope="CurveGradesDialog";g=e.t||d.t;i={};i.hash=
c;if((a=typeof g==="function"?g.call(d,f,a,i):g===void 0?l.call(d,"t",f,a,i):g)||a===0)h+=a;h+='\n    <input type="number" min="0" name="middle_score" id="middle_score" style="width: 45px;" value="';a=e.middle_score||d.middle_score;if(typeof a==="function")a=a.call(d,{hash:{}});else if(a===void 0)a=l.call(d,"middle_score",{hash:{}});h+=p(a)+'"/>\n    ';a=e.showOutOf||d.showOutOf;f=e["if"];i=this.program(1,function(j){var v="",k,w,B;v+="\n      ";k="out of %{assignment.points_possible}";w={};w.scope=
"CurveGradesDialog";B=e.t||j.t;i={};i.hash=w;if((k=typeof B==="function"?B.call(j,"out_of_points_possible",k,i):B===void 0?l.call(j,"t","out_of_points_possible",k,i):B)||k===0)v+=k;v+="\n    ";return v},b);i.hash={};i.fn=i;i.inverse=this.noop;if((a=f.call(d,a,i))||a===0)h+=a;h+='\n  </p>\n  <p>\n    <input type="checkbox" name="assign_blanks" id="assign_blanks"/>\n    <label for="assign_blanks">';a="Assign zeroes to unsubmitted students";f="labels.assign_blanks";c={};c.scope="CurveGradesDialog";g=
e.t||d.t;i={};i.hash=c;if((a=typeof g==="function"?g.call(d,f,a,i):g===void 0?l.call(d,"t",f,a,i):g)||a===0)h+=a;h+='</label>\n  </p>\n  <button data-text-while-loading="';a="Curving Grades...";f="buttons.curving_grades";c={};c.scope="CurveGradesDialog";g=e.t||d.t;i={};i.hash=c;if((a=typeof g==="function"?g.call(d,f,a,i):g===void 0?l.call(d,"t",f,a,i):g)||a===0)h+=a;h+='" type="submit" class="button">\n    ';a="Curve Grades";f="buttons.curve_grades";c={};c.scope="CurveGradesDialog";g=e.t||d.t;i={};
i.hash=c;if((a=typeof g==="function"?g.call(d,f,a,i):g===void 0?l.call(d,"t",f,a,i):g)||a===0)h+=a;h+="\n  </button>\n</form>\n";return h});define("jst/CurveGradesDialog",["compiled/handlebars_helpers"],function(){return t.CurveGradesDialog})})();
(function(){var q=function(t,h){return function(){return t.apply(h,arguments)}};I18n.scoped("gradebook2",function(t){return this.CurveGradesDialog=function(){function h(d,e){var a;this.assignment=d;this.gradebook=e;this.curve=q(this.curve,this);a={assignment:this.assignment,action:""+this.gradebook.options.context_url+"/gradebook/update_submission",middleScore:parseInt((this.assignment.points_possible||0)*0.6),showOutOf:this.assignment.points_possible>=0};this.$dialog=$(Template("CurveGradesDialog",
a));this.$dialog.formSubmit({disableWhileLoading:true,processData:q(function(b){var f,c,g,i;f=0;c=this.curve();for(g in c){i="submissions[submission_"+g+"]";b[i+"[assignment_id]"]=b.assignment_id;b[i+"[user_id]"]=g;b[i+"[grade]"]=c[g];f++}if(f===0){this.$dialog.errorBox(t.t("errors.none_to_update","None to Update"));return false}return b},this),success:q(function(b){var f,c;this.$dialog.dialog("close");c=function(){var g,i,l;l=[];g=0;for(i=b.length;g<i;g++){f=b[g];l.push(f.submission)}return l}();
$.publish("submissions_updated",[c]);return alert(t.t("alerts.scores_updated",{one:"1 Student score updated",other:"%{count} Student scores updated"},{count:b.length}))},this)}).dialog({width:350,modal:true,resizable:false,open:this.curve,close:q(function(){return this.$dialog.remove()},this)}).fixDialogButtons();this.$dialog.find("#middle_score").bind("blur change keyup focus",this.curve);this.$dialog.find("#assign_blanks").change(this.curve)}h.prototype.curve=function(){var d,e,a,b,f,c,g,i,l,p,
j,v,k,w;l=0;this.$dialog.getFormData();j=[];p=0;d=parseInt($("#middle_score").val(),10);d/=this.assignment.points_possible;if(!isNaN(d)){i=this.gradebook.students;for(l in i){f=i[l];v=f["assignment_"+this.assignment.id].score;if(v>this.assignment.points_possible)v=this.assignment.points_possible;if(v<0)v=0;j[parseInt(v,10)]=j[parseInt(v,10)]||[];j[parseInt(v,10)].push([l,v||0]);p++}a=[0.0060,0.012,0.028,0.04,0.068,0.106,0.159,0.227,0.309,0.401,0.5,0.599,0.691,0.773,0.841,0.894,0.933,0.96,0.977,0.988,
1];i=(1-d)/Math.floor(a.length/2);e=[];d=[];for(l=0;l<a.length;){d.push(1-i*l);e.push(Math.round((1-i*l)*this.assignment.points_possible));l++}k=0;d={};c=0;$("#results_list").empty();$("#results_values").empty();i=[];for(l=j.length-1;l>=0;){f=j[l]||[];v=Math.round(e[c]);for(b in f){w=f[b];d[w[0]]=v;if(w[1]===0)d[w[0]]=0;g=d[w[0]];i[g]=i[g]||[];i[g].push(w[0])}for(k+=f.length;k>a[c]*p;)c++;l--}p=0;for(l=i.length-1;l>=0;){b=(i[l]||[]).length;if(b>p)p=b;l--}a=0;for(l=i.length-1;l>=0;){f=i[l];b=j=0;if(f||
a>this.assignment.points_possible/10){if(f){j=f.length/p;b=f.length}f=l===0?"#ee8":"#cdf";$("#results_list").prepend("<td style='padding: 1px;'><div title='"+b+" student"+(b===1?"":"s")+" will get "+l+" points' style='border: 1px solid #888; background-color: "+f+"; width: 15px; height: "+100*j+"px; margin-top: "+100*(1-j)+"px;'>&nbsp;</div></td>");$("#results_values").prepend("<td style='text-align: center;'>"+l+"</td>");a=0}else a++;l--}$("#results_list").prepend("<td><div style='height: 100px; position: relative; width: 30px; font-size: 0.8em;'><img src='/images/number_of_students.png' alt='# of students'/><div style='position: absolute; top: 0; right: 3px;'>"+
p+"</div><div style='position: absolute; bottom: 0; right: 3px;'>0</div></div></td>");$("#results_values").prepend("<td>&nbsp;</td>");return d}};return h}()})}).call(this);
(function(){var q=Handlebars.template,t=Handlebars.templates=Handlebars.templates||{};t["gradebook2/GradebookHeaderMenu"]=q(function(h,d,e){e=e||h.helpers;h="";var a,b,f,c,g,i=e.helperMissing,l=this.escapeExpression;h+='<ul class="gradebook-header-menu">\n  <li><a data-action="showAssignmentDetails" href="';a=e.assignmentUrl||d.assignmentUrl;if(typeof a==="function")a=a.call(d,{hash:{}});else if(a===void 0)a=i.call(d,"assignmentUrl",{hash:{}});h+=l(a)+'">';a="Assignment Details";b="assignment_details";
f={};f.scope="gradebook2.GradebookHeaderMenu";c=e.t||d.t;g={};g.hash=f;if((a=typeof c==="function"?c.call(d,b,a,g):c===void 0?i.call(d,"t",b,a,g):c)||a===0)h+=a;h+='</a></li>\n  <li><a href="';a=e.speedGraderUrl||d.speedGraderUrl;if(typeof a==="function")a=a.call(d,{hash:{}});else if(a===void 0)a=i.call(d,"speedGraderUrl",{hash:{}});h+=l(a)+'">';a="SpeedGrader";b="speedgrader";f={};f.scope="gradebook2.GradebookHeaderMenu";c=e.t||d.t;g={};g.hash=f;if((a=typeof c==="function"?c.call(d,b,a,g):c===void 0?
i.call(d,"t",b,a,g):c)||a===0)h+=a;h+='</a></li>\n  <li><a data-action="messageStudentsWho" href="#">';a="Message Students Who...";b="message_students_who";f={};f.scope="gradebook2.GradebookHeaderMenu";c=e.t||d.t;g={};g.hash=f;if((a=typeof c==="function"?c.call(d,b,a,g):c===void 0?i.call(d,"t",b,a,g):c)||a===0)h+=a;h+='</a></li>\n  <li><a data-action="setDefaultGrade" href="#">';a="Set Default Grade";b="set_default_grade";f={};f.scope="gradebook2.GradebookHeaderMenu";c=e.t||d.t;g={};g.hash=f;if((a=
typeof c==="function"?c.call(d,b,a,g):c===void 0?i.call(d,"t",b,a,g):c)||a===0)h+=a;h+='</a></li>\n  <li><a data-action="curveGrades" href="#">';a="Curve Grades";b="curve_grades";f={};f.scope="gradebook2.GradebookHeaderMenu";c=e.t||d.t;g={};g.hash=f;if((a=typeof c==="function"?c.call(d,b,a,g):c===void 0?i.call(d,"t",b,a,g):c)||a===0)h+=a;h+='</a></li>\n  <li><a data-action="downloadSubmissions" href="#">';a="Download Submissions";b="download_submissions";f={};f.scope="gradebook2.GradebookHeaderMenu";
c=e.t||d.t;g={};g.hash=f;if((a=typeof c==="function"?c.call(d,b,a,g):c===void 0?i.call(d,"t",b,a,g):c)||a===0)h+=a;h+='</a></li>\n  <li><a data-action="reuploadSubmissions" href="#">';a="Re-Upload Submissions";b="re_upload_submissions";f={};f.scope="gradebook2.GradebookHeaderMenu";c=e.t||d.t;g={};g.hash=f;if((a=typeof c==="function"?c.call(d,b,a,g):c===void 0?i.call(d,"t",b,a,g):c)||a===0)h+=a;h+='</a></li>\n  <li><a data-action="toggleMuting" href="#"></a></li>\n</ul>\n';return h});define("jst/gradebook2/GradebookHeaderMenu",
["compiled/handlebars_helpers"],function(){return t["gradebook2/GradebookHeaderMenu"]})})();
(function(){var q=function(t,h){return function(){return t.apply(h,arguments)}};I18n.scoped("gradebook2",function(t){return this.GradebookHeaderMenu=function(){function h(d,e,a){this.assignment=d;this.$trigger=e;this.gradebook=a;this.reuploadSubmissions=q(this.reuploadSubmissions,this);this.downloadSubmissions=q(this.downloadSubmissions,this);this.curveGrades=q(this.curveGrades,this);this.setDefaultGrade=q(this.setDefaultGrade,this);this.messageStudentsWho=q(this.messageStudentsWho,this);this.showAssignmentDetails=
q(this.showAssignmentDetails,this);this.$menu=$(Template("gradebook2/GradebookHeaderMenu",{assignmentUrl:""+this.gradebook.options.context_url+"/assignments/"+this.assignment.id,speedGraderUrl:""+this.gradebook.options.context_url+"/gradebook/speed_grader?assignment_id="+this.assignment.id})).insertAfter(this.$trigger);this.$trigger.kyleMenu({noButton:true});this.$menu.appendTo("#gradebook_grid").delegate("a","click",q(function(b){if(b=this[$(b.target).data("action")]){b();return false}},this)).bind("popupopen popupclose",
q(function(b){return this.$trigger.toggleClass("ui-menu-trigger-menu-is-open",b.type==="popupopen")},this)).bind("popupopen",q(function(){var b,f,c,g;c={showAssignmentDetails:this.gradebook.allSubmissionsLoaded,messageStudentsWho:this.gradebook.allSubmissionsLoaded,setDefaultGrade:this.gradebook.allSubmissionsLoaded,curveGrades:this.gradebook.allSubmissionsLoaded&&this.assignment.grading_type!=="pass_fail"&&this.assignment.points_possible,downloadSubmissions:(""+this.assignment.submission_types).match(/(online_upload|online_text_entry|online_url)/),
reuploadSubmissions:this.assignment.submissions_downloads>0};g=[];for(b in c){f=c[b];g.push(this.$menu.find("[data-action="+b+"]").showIf(f))}return g},this)).popup("open");new AssignmentMuter(this.$menu.find("[data-action=toggleMuting]"),this.assignment,""+this.gradebook.options.context_url+"/assignments/"+this.assignment.id+"/mute")}h.prototype.showAssignmentDetails=function(){return new AssignmentDetailsDialog(this.assignment,this.gradebook)};h.prototype.messageStudentsWho=function(){var d,e,a;
a=function(){var b,f;b=this.gradebook.students;f=[];for(d in b){e=b[d];f.push($.extend({id:e.id,name:e.name},e["assignment_"+this.assignment.id]))}return f}.call(this);return window.messageStudents({options:[{text:t.t("students_who.havent_submitted_yet","Haven't submitted yet")},{text:t.t("students_who.scored_less_than","Scored less than"),cutoff:true},{text:t.t("students_who.scored_more_than","Scored more than"),cutoff:true}],title:this.assignment.name,points_possible:this.assignment.points_possible,
students:a,callback:function(b,f,c){c=$.grep(c,function(g){e=g.user_data;if(b===t.t("not_submitted_yet","Haven't submitted yet"))return!e.submitted_at;else if(b===t.t("scored_less_than","Scored less than"))return e.score!=null&&e.score!==""&&f!=null&&e.score<f;else if(b===t.t("scored_more_than","Scored more than"))return e.score!=null&&e.score!==""&&f!=null&&e.score>f});return $.map(c,function(g){return g.user_data.id})}})};h.prototype.setDefaultGrade=function(){return new SetDefaultGradeDialog(this.assignment,
this.gradebook)};h.prototype.curveGrades=function(){return new CurveGradesDialog(this.assignment,this.gradebook)};h.prototype.downloadSubmissions=function(){var d,e,a;d=$.replaceTags(this.gradebook.options.download_assignment_submissions_url,"assignment_id",this.assignment.id);INST.downloadSubmissions(d);return this.assignment.submissions_downloads=((a=(e=this.assignment).submissions_downloads)!=null?a:e.submissions_downloads=0)+1};h.prototype.reuploadSubmissions=function(){if(!this.$re_upload_submissions_form)h.prototype.$re_upload_submissions_form=
$(Template("re_upload_submissions_form")).dialog({width:400,modal:true,resizable:false,autoOpen:false}).submit(function(){var d;d=$(this).getFormData();if(d.submissions_zip){if(!d.submissions_zip.match(/\.zip$/)){$(this).formErrors({submissions_zip:t.t("errors.upload_as_zip","Please upload files as a .zip")});return false}}else return false});return this.$re_upload_submissions_form.attr("action",$.replaceTags(this.gradebook.options.re_upload_submissions_url,"assignment_id",this.assignment.id)).dialog("open")};
return h}()})}).call(this);
(function(){var q=Handlebars.template,t=Handlebars.templates=Handlebars.templates||{};t._submission_detail=q(function(h,d,e,a,b){function f(m){var A="",r,u,z;A+='\n      Submission URL: <a href="';r=e.url||m.url;if(typeof r===k)r=r.call(m,{hash:{}});else if(r===B)r=w.call(m,"url",{hash:{}});A+=x(r)+'" title="';r="Go to submission URL";u={};u.scope="submission_detail";z=e.t||m.t;j={};j.hash=u;if((r=typeof z===k?z.call(m,"go_to_submission_url",r,j):z===B?w.call(m,"t","go_to_submission_url",r,j):z)||
r===0)A+=r;A+='" target="_blank">';r=e.url||m.url;if(typeof r===k)r=r.call(m,{hash:{}});else if(r===B)r=w.call(m,"url",{hash:{}});A+=x(r)+"</a>\n    ";return A}function c(m,A){var r="",u,z,D,s;r+="\n      <label>";u="Submitted files:";z="submitted_files";D={};D.scope="submission_detail";s=e.t||m.t;j={};j.hash=D;if((u=typeof s===k?s.call(m,z,u,j):s===B?w.call(m,"t",z,u,j):s)||u===0)r+=u;r+="</label>\n      <div>\n        ";u=e.attachments||m.attachments;z=e.each;j=v.program(5,g,A);j.hash={};j.fn=j;
j.inverse=v.noop;if((u=z.call(m,u,j))||u===0)r+=u;r+="\n      </div>\n    ";return r}function g(m,A){var r="",u,z;r+='\n          <div class="submisison-attachment">\n            ';u=e.turnitinUrl||m.turnitinUrl;z=e["if"];j=v.program(6,i,A);j.hash={};j.fn=j;j.inverse=v.noop;if((u=z.call(m,u,j))||u===0)r+=u;r+='\n            <a href="';u=e.url||m.url;if(typeof u===k)u=u.call(m,{hash:{}});else if(u===B)u=w.call(m,"url",{hash:{}});r+=x(u)+'" class="';u=e["content-type"]||m["content-type"];z=e.mimeClass||
m.mimeClass;u=typeof z===k?z.call(m,u,{hash:{}}):z===B?w.call(m,"mimeClass",u,{hash:{}}):z;r+=x(u)+'" title="';u=e.filename||m.filename;if(typeof u===k)u=u.call(m,{hash:{}});else if(u===B)u=w.call(m,"filename",{hash:{}});r+=x(u)+'">';u=e.display_name||m.display_name;if(typeof u===k)u=u.call(m,{hash:{}});else if(u===B)u=w.call(m,"display_name",{hash:{}});r+=x(u)+"</a>\n          </div>\n        ";return r}function i(m){var A="",r,u,z;A+='\n              <a class="turnitin_similarity_score" href="';
r=e.turnitinUrl||m.turnitinUrl;if(typeof r===k)r=r.call(m,{hash:{}});else if(r===B)r=w.call(m,"turnitinUrl",{hash:{}});A+=x(r)+'" target="_blank" title="';r="Turnitin similarity score -- more information";u={};u.scope="submission_detail";z=e.t||m.t;j={};j.hash=u;if((r=typeof z===k?z.call(m,"titles.turnitin_score",r,j):z===B?w.call(m,"t","titles.turnitin_score",r,j):z)||r===0)A+=r;A+='"><span class="similarity_score">';r=e.turnitin_data||m.turnitin_data;r=r===null||r===undefined||r===false?r:r.similarity_score;
if(typeof r===k)r=r.call(m,{hash:{}});else if(r===B)r=w.call(m,"turnitin_data.similarity_score",{hash:{}});A+=x(r)+"</span>%</a>\n            ";return A}function l(m){var A="",r,u,z;A+="\n      ";r="Online Text Entry, *see details in the SpeedGrader*.";u={};u.scope="submission_detail";u.w0='<a href="%{speedGraderUrl}">$1</a>';z=e.t||m.t;j={};j.hash=u;if((r=typeof z===k?z.call(m,"online_text_entry_see_details_in_the_speedgrader.",r,j):z===B?w.call(m,"t","online_text_entry_see_details_in_the_speedgrader.",
r,j):z)||r===0)A+=r;A+="\n    ";return A}e=e||h.helpers;h="";var p,j,v=this,k="function",w=e.helperMissing,B=void 0,x=this.escapeExpression;h+='<div class="submission_detail">\n  ';a=e.submission_type||d.submission_type;p=e["if"];j=v.program(1,function(m,A){var r="",u,z;r+="\n    ";u=e.url||m.url;z=e["if"];j=v.program(2,f,A);j.hash={};j.fn=j;j.inverse=v.noop;if((u=z.call(m,u,j))||u===0)r+=u;r+="\n    ";u=e.attachments||m.attachments;z=e["if"];j=v.program(4,c,A);j.hash={};j.fn=j;j.inverse=v.noop;if((u=
z.call(m,u,j))||u===0)r+=u;r+="\n    ";u=e.submission_type_is_online_text_entry||m.submission_type_is_online_text_entry;z=e["if"];j=v.program(8,l,A);j.hash={};j.fn=j;j.inverse=v.noop;if((u=z.call(m,u,j))||u===0)r+=u;r+="\n  ";return r},b);j.hash={};j.fn=j;j.inverse=v.program(10,function(m){var A="",r,u,z;A+="\n    ";r="No submission";u={};u.scope="submission_detail";z=e.t||m.t;j={};j.hash=u;if((r=typeof z===k?z.call(m,"no_submission",r,j):z===B?w.call(m,"t","no_submission",r,j):z)||r===0)A+=r;A+=
"\n  ";return A},b);if((a=p.call(d,a,j))||a===0)h+=a;h+="\n</div>\n";return h});Handlebars.registerPartial("submission_detail",t._submission_detail);define("jst/_submission_detail",["compiled/handlebars_helpers"],function(){return t._submission_detail})})();
(function(){var q=Handlebars.template,t=Handlebars.templates=Handlebars.templates||{};t.SubmissionDetailsDialog=q(function(h,d,e,a,b){function f(s,C){var n="",o,y;n+="\n              <option>";o=e.submitted_at||s.submitted_at;y=e.datetimeFormatted||s.datetimeFormatted;o=typeof y===r?y.call(s,o,{hash:{}}):y===z?u.call(s,"datetimeFormatted",o,{hash:{}}):y;n+=D(o)+" ";o=e.submissionWasLate||s.submissionWasLate;y=e["if"];m=A.program(3,c,C);m.hash={};m.fn=m;m.inverse=A.noop;if((o=y.call(s,o,m))||o===0)n+=
o;n+="</option>\n            ";return n}function c(s){var C="",n,o,y;C+=" ";n="LATE";o={};o.scope="SubmissionDetailsDialog";y=e.t||s.t;m={};m.hash=o;if((n=typeof y===r?y.call(s,"late",n,m):y===z?u.call(s,"t","late",n,m):y)||n===0)C+=n;C+=" ";return C}function g(s,C){var n="",o,y,E,F;n+="\n            <strong>";o="Submitted:";y="submitted";E={};E.scope="SubmissionDetailsDialog";F=e.t||s.t;m={};m.hash=E;if((o=typeof F===r?F.call(s,y,o,m):F===z?u.call(s,"t",y,o,m):F)||o===0)n+=o;n+=" ";o=e.submitted_at||
s.submitted_at;y=e.datetimeFormatted||s.datetimeFormatted;o=typeof y===r?y.call(s,o,{hash:{}}):y===z?u.call(s,"datetimeFormatted",o,{hash:{}}):y;n+=D(o)+" ";o=e.submissionWasLate||s.submissionWasLate;y=e["if"];m=A.program(7,i,C);m.hash={};m.fn=m;m.inverse=A.noop;if((o=y.call(s,o,m))||o===0)n+=o;n+="</strong>\n          ";return n}function i(s){var C="",n,o,y;C+=" ";n="LATE";o={};o.scope="SubmissionDetailsDialog";y=e.t||s.t;m={};m.hash=o;if((n=typeof y===r?y.call(s,"late",n,m):y===z?u.call(s,"t","late",
n,m):y)||n===0)C+=n;C+=" ";return C}function l(s,C){var n="",o,y,E,F;n+="\n        <h1>";o="Comments";y="comments";E={};E.scope="SubmissionDetailsDialog";F=e.t||s.t;m={};m.hash=E;if((o=typeof F===r?F.call(s,y,o,m):F===z?u.call(s,"t",y,o,m):F)||o===0)n+=o;n+='</h1>\n        <div class="submission_details_comments">\n          ';o=e.submission_comments||s.submission_comments;y=e.each;m=A.program(17,p,C);m.hash={};m.fn=m;m.inverse=A.noop;if((o=y.call(s,o,m))||o===0)n+=o;n+="\n        </div>\n      ";
return n}function p(s,C){var n="",o,y,E;n+='\n            <article class="comment clearfix">\n              ';o=e.created_at||s.created_at;y={};y.pubdate=true;E=e.friendlyDatetime||s.friendlyDatetime;m={};m.hash=y;o=typeof E===r?E.call(s,o,m):E===z?u.call(s,"friendlyDatetime",o,m):E;n+=D(o)+'\n              <img class="photo" src="';o=e.image_url||s.image_url;if(typeof o===r)o=o.call(s,{hash:{}});else if(o===z)o=u.call(s,"image_url",{hash:{}});n+=D(o)+'" />\n              <div class="middle">\n                <address class="vcard">\n                  <a class="fn url" href="';
o=e.url||s.url;if(typeof o===r)o=o.call(s,{hash:{}});else if(o===z)o=u.call(s,"url",{hash:{}});n+=D(o)+'">';o=e.author_name||s.author_name;if(typeof o===r)o=o.call(s,{hash:{}});else if(o===z)o=u.call(s,"author_name",{hash:{}});n+=D(o)+"</a>\n                </address>\n                <div>\n                  ";o=e.comment||s.comment;y=e.newlinesToBreak||s.newlinesToBreak;o=typeof y===r?y.call(s,o,{hash:{}}):y===z?u.call(s,"newlinesToBreak",o,{hash:{}}):y;n+=D(o)+"\n                </div>\n                ";
o=e.media_comment||s.media_comment;y=e["if"];m=A.program(18,j,C);m.hash={};m.fn=m;m.inverse=A.noop;if((o=y.call(s,o,m))||o===0)n+=o;n+='\n                <div class="comment_attachments">\n                  ';o=e.attachments||s.attachments;y=e.each;m=A.program(20,v,C);m.hash={};m.fn=m;m.inverse=A.noop;if((o=y.call(s,o,m))||o===0)n+=o;n+="\n                </div>\n              </div>\n            </article>\n          ";return n}function j(s){var C="",n,o,y;C+='\n                  <a data-media_comment_id="';
n=e.media_comment||s.media_comment;n=n===null||n===undefined||n===false?n:n.media_id;if(typeof n===r)n=n.call(s,{hash:{}});else if(n===z)n=u.call(s,"media_comment.media_id",{hash:{}});C+=D(n)+'" data-media_comment_type="';n=e.media_comment||s.media_comment;n=n===null||n===undefined||n===false?n:n.media_type;if(typeof n===r)n=n.call(s,{hash:{}});else if(n===z)n=u.call(s,"media_comment.media_type",{hash:{}});C+=D(n)+'" href="';n=e.media_comment||s.media_comment;n=n===null||n===undefined||n===false?
n:n.url;if(typeof n===r)n=n.call(s,{hash:{}});else if(n===z)n=u.call(s,"media_comment.url",{hash:{}});C+=D(n)+'" class="play_comment_link media-comment instructure_inline_media_comment" >';n="click here to view";o={};o.scope="SubmissionDetailsDialog";y=e.t||s.t;m={};m.hash=o;if((n=typeof y===r?y.call(s,"links.click_to_view",n,m):y===z?u.call(s,"t","links.click_to_view",n,m):y)||n===0)C+=n;C+="</a>\n                ";return C}function v(s){var C="",n,o;C+='\n                    <div><a href="';n=e.url||
s.url;if(typeof n===r)n=n.call(s,{hash:{}});else if(n===z)n=u.call(s,"url",{hash:{}});C+=D(n)+'" class="';n=e["content-type"]||s["content-type"];o=e.mimeClass||s.mimeClass;n=typeof o===r?o.call(s,n,{hash:{}}):o===z?u.call(s,"mimeClass",n,{hash:{}}):o;C+=D(n)+'" title="';n=e.filename||s.filename;if(typeof n===r)n=n.call(s,{hash:{}});else if(n===z)n=u.call(s,"filename",{hash:{}});C+=D(n)+'">';n=e.display_name||s.display_name;if(typeof n===r)n=n.call(s,{hash:{}});else if(n===z)n=u.call(s,"display_name",
{hash:{}});C+=D(n)+"</a></div>\n                  ";return C}e=e||h.helpers;a=a||h.partials;h="";var k,w,B,x,m,A=this,r="function",u=e.helperMissing,z=void 0,D=this.escapeExpression;h+='<div class="submission_details_dialog">\n  <h1 class="assignment-name">';k=e.assignment||d.assignment;k=k===null||k===undefined||k===false?k:k.name;if(typeof k===r)k=k.call(d,{hash:{}});else if(k===z)k=u.call(d,"assignment.name",{hash:{}});h+=D(k)+'</h1>\n  <section class="submission-details">\n    <a class="more-details-link" target="_blank" href="';
k=e.speedGraderUrl||d.speedGraderUrl;if(typeof k===r)k=k.call(d,{hash:{}});else if(k===z)k=u.call(d,"speedGraderUrl",{hash:{}});h+=D(k)+'">';k="More details in the SpeedGrader";w="more_details_in_the_speedgrader";B={};B.scope="SubmissionDetailsDialog";x=e.t||d.t;m={};m.hash=B;if((k=typeof x===r?x.call(d,w,k,m):x===z?u.call(d,"t",w,k,m):x)||k===0)h+=k;h+="</a>\n    <div>\n      <h2>\n        ";k=e.moreThanOneSubmission||d.moreThanOneSubmission;w=e["if"];m=A.program(1,function(s,C){var n="",o,y,E,F;
n+='\n          <label for="submission_to_view">';o="Submitted multiple times, choose which to view:";y="this_was_submitted_multiple_times_choose_a_submission_to_view";E={};E.scope="SubmissionDetailsDialog";F=e.t||s.t;m={};m.hash=E;if((o=typeof F===r?F.call(s,y,o,m):F===z?u.call(s,"t",y,o,m):F)||o===0)n+=o;n+='</label>\n          <select id="submission_to_view">\n            ';o=e.submission_history||s.submission_history;y=e.each;m=A.program(2,f,C);m.hash={};m.fn=m;m.inverse=A.noop;if((o=y.call(s,
o,m))||o===0)n+=o;n+="\n          </select>\n        ";return n},b);m.hash={};m.fn=m;m.inverse=A.program(5,function(s,C){var n="",o,y;n+="\n          ";o=e.submitted_at||s.submitted_at;y=e["if"];m=A.program(6,g,C);m.hash={};m.fn=m;m.inverse=A.noop;if((o=y.call(s,o,m))||o===0)n+=o;n+="\n        ";return n},b);if((k=w.call(d,k,m))||k===0)h+=k;h+="\n      </h2>\n      ";k=e.submission_history||d.submission_history;w=e.each;m=A.program(9,function(s){var C="";C+="\n        ";if((s=A.invokePartial(a.submission_detail,
"submission_detail",s,e,a))||s===0)C+=s;C+="\n      ";return C},b);m.hash={};m.fn=m;m.inverse=A.noop;if((k=w.call(d,k,m))||k===0)h+=k;h+="\n      ";k=e.rubric_assessment||d.rubric_assessment;w=e["if"];m=A.program(11,function(s){var C="",n,o,y;C+='\n        <div class="rubric-link"><a class="rubric" href="';n=e.speedGraderUrl||s.speedGraderUrl;if(typeof n===r)n=n.call(s,{hash:{}});else if(n===z)n=u.call(s,"speedGraderUrl",{hash:{}});C+=D(n)+'">';n="View Rubric Assessment in the SpeedGrader";o={};o.scope=
"SubmissionDetailsDialog";y=e.t||s.t;m={};m.hash=o;if((n=typeof y===r?y.call(s,"view_rubric_assessment_in_the_speedgrader",n,m):y===z?u.call(s,"t","view_rubric_assessment_in_the_speedgrader",n,m):y)||n===0)C+=n;C+="</a></div>\n      ";return C},b);m.hash={};m.fn=m;m.inverse=A.noop;if((k=w.call(d,k,m))||k===0)h+=k;h+="\n    </div>\n  </section>\n  <section>\n    ";k=e.loading||d.loading;w=e["if"];m=A.program(13,function(s){var C="",n,o,y;C+="\n      <h1>";n="Loading comments...";o={};o.scope="SubmissionDetailsDialog";
y=e.t||s.t;m={};m.hash=o;if((n=typeof y===r?y.call(s,"loading_comments",n,m):y===z?u.call(s,"t","loading_comments",n,m):y)||n===0)C+=n;C+="</h1>\n    ";return C},b);m.hash={};m.fn=m;m.inverse=A.program(15,function(s,C){var n="",o,y;n+="\n      ";o=e.submission_comments||s.submission_comments;y=e["if"];m=A.program(16,l,C);m.hash={};m.fn=m;m.inverse=A.noop;if((o=y.call(s,o,m))||o===0)n+=o;n+="\n    ";return n},b);if((k=w.call(d,k,m))||k===0)h+=k;h+='\n  </section>\n  <form class="submission_details_add_comment_form clearfix">\n    <label for="add_a_comment">';
k="Add a comment";w="add_a_comment";B={};B.scope="SubmissionDetailsDialog";x=e.t||d.t;m={};m.hash=B;if((k=typeof x===r?x.call(d,w,k,m):x===z?u.call(d,"t",w,k,m):x)||k===0)h+=k;h+='</label>\n    <textarea id="add_a_comment" name="comment[text_comment]"></textarea>\n    <button class="button" type="submit">';k="Post Comment";w="post_comment";B={};B.scope="SubmissionDetailsDialog";x=e.t||d.t;m={};m.hash=B;if((k=typeof x===r?x.call(d,w,k,m):x===z?u.call(d,"t",w,k,m):x)||k===0)h+=k;h+="</button>\n  </form>\n</div>\n";
return h});define("jst/SubmissionDetailsDialog",["compiled/handlebars_helpers"],function(){return t.SubmissionDetailsDialog})})();
(function(){var q=function(t,h){return function(){return t.apply(h,arguments)}};I18n.scoped("AssignmentDetailsDialog",function(){return this.SubmissionDetailsDialog=function(){function t(h,d,e){this.assignment=h;this.student=d;this.options=e;this.update=q(this.update,this);this.scrollCommentsToBottom=q(this.scrollCommentsToBottom,this);this.open=q(this.open,this);this.url=this.options.change_grade_url.replace(":assignment",this.assignment.id).replace(":submission",this.student.id);this.submission=
$.extend({},this.student["assignment_"+this.assignment.id],{assignment:this.assignment,speedGraderUrl:""+this.options.context_url+"/gradebook/speed_grader?assignment_id="+this.assignment.id+"#%7B%22student_id%22%3A"+this.student.id+"%7D",loading:true});this.dialog=$('<div class="use-css-transitions-for-show-hide" style="padding:0;"/>');this.dialog.html(Template("SubmissionDetailsDialog",this.submission)).dialog({title:this.student.name,width:600,resizable:false,open:this.scrollCommentsToBottom}).delegate("select",
"change",q(function(a){return this.dialog.find(".submission_detail").each(function(b){return $(this).showIf(b===a.currentTarget.selectedIndex)})},this)).delegate(".submission_details_add_comment_form","submit",q(function(a){a.preventDefault();return $(a.currentTarget).disableWhileLoading($.ajaxJSON(this.url,"PUT",$(a.currentTarget).getFormData(),q(function(b){this.update(b);return setTimeout(q(function(){return this.dialog.dialog("close")},this),500)},this)))},this));h=$.ajaxJSON(this.url+"?include[]=submission_history&include[]=submission_comments&include[]=rubric_assessment",
"GET",{},this.update);this.dialog.find(".submission_details_comments").disableWhileLoading(h)}t.prototype.open=function(){return this.dialog.dialog("open")};t.prototype.scrollCommentsToBottom=function(){return this.dialog.find(".submission_details_comments").scrollTop(999999)};t.prototype.update=function(h){var d,e,a,b,f,c,g,i,l;$.extend(this.submission,h);this.submission.submission_history[0]=this.submission;this.submission.moreThanOneSubmission=this.submission.submission_history.length>1;this.submission.loading=
false;g=this.submission.submission_history;a=0;for(f=g.length;a<f;a++){h=g[a];h["submission_type_is"+h.submission_type]=true;h.submissionWasLate=this.assignment.due_at&&new Date(this.assignment.due_at)>new Date(h.submitted_at);i=h.submission_comments||[];b=0;for(c=i.length;b<c;b++){d=i[b];d.url=""+this.options.context_url+"/users/"+d.author_id;e=""+location.protocol+"//"+location.host;d.image_url=""+e+"/images/users/"+d.author_id+"?fallback="+encodeURIComponent(e+"/images/messages/avatar-50.png")}i=
h.attachments||[];b=0;for(c=i.length;b<c;b++){d=i[b];if(e=(l=h.turnitin_data)!=null?l["attachment_"+d.id]:void 0){d.turnitinUrl=""+this.options.context_url+"/assignments/"+this.assignment.id+"/submissions/"+this.student.id+"/turnitin/attachment_"+d.id;d.turnitin_data=e}}}this.dialog.html(Template("SubmissionDetailsDialog",this.submission));this.dialog.find("select").trigger("change");return this.scrollCommentsToBottom()};t.cachedDialogs={};t.open=function(h,d,e){var a,b;return((a=t.cachedDialogs)[b=
""+h.id+"-"+d.id]||(a[b]=new t(h,d,e))).open()};return t}()})}).call(this);
(function(){var q=Handlebars.template,t=Handlebars.templates=Handlebars.templates||{};t["gradebook2/section_to_show_menu"]=q(function(h,d,e,a,b){function f(){return" checked "}e=e||h.helpers;h="";var c,g,i,l,p=this,j=e.helperMissing,v=this.escapeExpression;h+='<ul id="section-to-show-menu" ';a=e.scrolling||d.scrolling;c=e["if"];l=p.program(1,function(){return' class="scrolling" '},b);l.hash={};l.fn=l;l.inverse=p.noop;if((a=c.call(d,a,l))||a===0)h+=a;h+=" >\n  <li>";a="Choose a section to show";c=
"choose_a_section_to_show";g={};g.scope="gradebook2.section_to_show_menu";i=e.t||d.t;l={};l.hash=g;if((a=typeof i==="function"?i.call(d,c,a,l):i===void 0?j.call(d,"t",c,a,l):i)||a===0)h+=a;h+="</li>\n      ";a=e.sections||d.sections;c=e.each;l=p.program(3,function(k,w){var B="",x,m;B+='\n        <li>\n          <a href="#">\n            <label for="section_option_';x=e.id||k.id;if(typeof x==="function")x=x.call(k,{hash:{}});else if(x===void 0)x=j.call(k,"id",{hash:{}});B+=v(x)+'">';x=e.name||k.name;
if(typeof x==="function")x=x.call(k,{hash:{}});else if(x===void 0)x=j.call(k,"name",{hash:{}});B+=v(x)+'</label>\n            <input id="section_option_';x=e.id||k.id;if(typeof x==="function")x=x.call(k,{hash:{}});else if(x===void 0)x=j.call(k,"id",{hash:{}});B+=v(x)+'" type="radio" name="section_to_show_radio" ';x=e.checked||k.checked;m=e["if"];l=p.program(4,f,w);l.hash={};l.fn=l;l.inverse=p.noop;if((x=m.call(k,x,l))||x===0)B+=x;B+=" />\n          </a>\n        </li>\n      ";return B},b);l.hash=
{};l.fn=l;l.inverse=p.noop;if((a=c.call(d,a,l))||a===0)h+=a;h+="\n</ul>";return h});define("jst/gradebook2/section_to_show_menu",["compiled/handlebars_helpers"],function(){return t["gradebook2/section_to_show_menu"]})})();
(function(){var q=function(h,d){return function(){return h.apply(d,arguments)}},t=Array.prototype.indexOf||function(h){for(var d=0,e=this.length;d<e;d++)if(this[d]===h)return d;return-1};define("compiled/Gradebook",["i18n","jst/gradebook2/section_to_show_menu"],function(h,d){h=h.scoped("gradebook2");return function(){function e(a){this.options=a;this.initGrid=q(this.initGrid,this);this.initHeader=q(this.initHeader,this);this.hoverMinimizedCell=q(this.hoverMinimizedCell,this);this.unminimizeColumn=
q(this.unminimizeColumn,this);this.minimizeColumn=q(this.minimizeColumn,this);this.fixColumnReordering=q(this.fixColumnReordering,this);this.unhighlightColumns=q(this.unhighlightColumns,this);this.highlightColumn=q(this.highlightColumn,this);this.calculateStudentGrade=q(this.calculateStudentGrade,this);this.groupTotalFormatter=q(this.groupTotalFormatter,this);this.staticCellFormatter=q(this.staticCellFormatter,this);this.cellFormatter=q(this.cellFormatter,this);this.updateSubmissionsFromExternal=
q(this.updateSubmissionsFromExternal,this);this.updateSubmission=q(this.updateSubmission,this);this.gotSubmissionsChunk=q(this.gotSubmissionsChunk,this);this.getSubmissionsChunks=q(this.getSubmissionsChunks,this);this.buildRows=q(this.buildRows,this);this.rowFilter=q(this.rowFilter,this);this.columnSortFn=q(this.columnSortFn,this);this.arrangeColumnsBy=q(this.arrangeColumnsBy,this);this.gotStudents=q(this.gotStudents,this);this.gotAssignmentGroups=q(this.gotAssignmentGroups,this);this.chunk_start=
0;this.students={};this.rows=[];this.sortFn=function(b){return b.display_name};this.assignmentsToHide=($.store.userGet("hidden_columns_"+this.options.context_code)||"").split(",");this.sectionToShow=Number($.store.userGet("grading_show_only_section"+this.options.context_id))||void 0;this.show_attendance=$.store.userGet("show_attendance_"+this.options.context_code)==="true";this.include_ungraded_assignments=$.store.userGet("include_ungraded_assignments_"+this.options.context_code)==="true";$.subscribe("assignment_group_weights_changed",
this.buildRows);$.subscribe("assignment_muting_toggled",this.buildRows);$.subscribe("submissions_updated",this.updateSubmissionsFromExternal);$.when($.ajaxJSON(this.options.assignment_groups_url,"GET",{},this.gotAssignmentGroups),$.ajaxJSON(this.options.sections_and_students_url,"GET",this.sectionToShow&&{sections:[this.sectionToShow]})).then(q(function(b,f){return this.gotStudents.apply(this,f)},this));this.spinner=new Spinner;$(this.spinner.spin().el).css({opacity:0.5,top:"50%",left:"50%"}).addClass("use-css-transitions-for-show-hide").appendTo("#main")}
e.prototype.gotAssignmentGroups=function(a){var b,f,c,g,i;this.assignmentGroups={};this.assignments={};new AssignmentGroupWeightsDialog({context:this.options,assignmentGroups:a});i=[];c=0;for(g=a.length;c<g;c++){f=a[c];$.htmlEscapeValues(f);this.assignmentGroups[f.id]=f;i.push(function(){var l,p,j,v;j=f.assignments;v=[];l=0;for(p=j.length;l<p;l++){b=j[l];$.htmlEscapeValues(b);b.assignment_group=f;if(b.due_at)b.due_at=$.parseFromISO(b.due_at);v.push(this.assignments[b.id]=b)}return v}.call(this))}return i};
e.prototype.gotStudents=function(a){var b,f,c,g,i,l,p,j,v,k;this.sections={};this.rows=[];g=0;for(l=a.length;g<l;g++){f=a[g];$.htmlEscapeValues(f);this.sections[f.id]=f;v=f.students;i=0;for(p=v.length;i<p;i++){c=v[i];$.htmlEscapeValues(c);c.computed_current_score||(c.computed_current_score=0);c.computed_final_score||(c.computed_final_score=0);c.secondary_identifier=c.sis_login_id||c.login_id;this.students[c.id]=c;c.section=f;k=this.assignments;for(b in k)c[j="assignment_"+b]||(c[j]={assignment_id:b,
user_id:c.id});this.rows.push(c)}}this.sections_enabled=a.length>1;a=this.students;for(b in a){c=a[b];c.display_name="<div class='student-name'>"+c.name+"</div>";if(this.sections_enabled)c.display_name+="<div class='student-section'>"+c.section.name+"</div>"}this.initGrid();this.buildRows();this.getSubmissionsChunks();return this.initHeader()};e.prototype.arrangeColumnsBy=function(a){var b;if(a&&a!==this._sortColumnsBy){this.$columnArrangementTogglers.each(function(){return $(this).closest("li").showIf($(this).data("arrangeColumnsBy")!==
a)});this._sortColumnsBy=a;$.store[a==="due_date"?"userSet":"userRemove"]("sort_grade_colums_by_"+this.options.context_id,a);b=this.gradeGrid.getColumns();b.sort(this.columnSortFn);this.gradeGrid.setColumns(b);this.fixColumnReordering();this.buildRows()}return this._sortColumnsBy||(this._sortColumnsBy=$.store.userGet("sort_grade_colums_by_"+this.options.context_id)||"assignment_group")};e.prototype.columnSortFn=function(a,b){var f,c,g;if(b.type==="total_grade")return-1;if(a.type==="total_grade")return 1;
if(b.type==="assignment_group"&&a.type!=="assignment_group")return-1;if(a.type==="assignment_group"&&b.type!=="assignment_group")return 1;if(a.type==="assignment_group"&&b.type==="assignment_group")return a.object.position-b.object.position;else if(a.type==="assignment"&&b.type==="assignment")if(this.arrangeColumnsBy()==="assignment_group"){f=a.object.assignment_group.position-b.object.assignment_group.position;g=a.object.position-b.object.position;return f*1E6+g}else{f=((c=a.object.due_at)!=null?
c.timestamp:void 0)||Number.MAX_VALUE;c=((g=b.object.due_at)!=null?g.timestamp:void 0)||Number.MAX_VALUE;if(f===c){if(a.object.name===b.object.name)return 0;return a.object.name>b.object.name?1:-1}return f-c}throw"unhandled column sort condition";};e.prototype.rowFilter=function(a){return!this.sectionToShow||a.section.id===this.sectionToShow};e.prototype.buildRows=function(){var a,b,f,c,g;this.rows.length=0;f={};c=this.gradeGrid.getColumns();for(b in c){a=c[b];if(""+((g=a.object)!=null?g.submission_types:
void 0)==="attendance"){a.unselectable=!this.show_attendance;a.cssClass=this.show_attendance?"":"completely-hidden";this.$grid.find("[id*='"+a.id+"']").showIf(this.show_attendance)}}c=this.students;for(b in c){a=c[b];a.row=-1;if(this.rowFilter(a)){this.rows.push(a);this.calculateStudentGrade(a);f[a.id]=this.sortFn(a)}}this.rows.sort(function(i,l){return f[i.id]<f[l.id]?-1:f[i.id]>f[l.id]?1:0});g=this.rows;b=0;for(c=g.length;b<c;b++){a=g[b];a.row=b}this.multiGrid.removeAllRows();this.multiGrid.updateRowCount();
return this.multiGrid.render()};e.prototype.getSubmissionsChunks=function(){var a,b,f,c,g;for(g=[];;){c=this.rows.slice(this.chunk_start,this.chunk_start+this.options.chunk_size);if(!c.length){this.allSubmissionsLoaded=true;break}b={student_ids:function(){var i,l,p;p=[];i=0;for(l=c.length;i<l;i++){f=c[i];p.push(f.id)}return p}(),assignment_ids:function(){var i,l;i=this.assignments;l=[];for(a in i)l.push(a);return l}.call(this),response_fields:["user_id","url","score","grade","submission_type","submitted_at",
"assignment_id","grade_matches_current_submission"]};$.ajaxJSON(this.options.submissions_url,"GET",b,this.gotSubmissionsChunk);g.push(this.chunk_start+=this.options.chunk_size)}return g};e.prototype.gotSubmissionsChunk=function(a){var b,f,c,g,i,l,p;c=0;for(i=a.length;c<i;c++){b=a[c];f=this.students[b.user_id];p=b.submissions;g=0;for(l=p.length;g<l;g++){b=p[g];this.updateSubmission(b)}f.loaded=true;this.multiGrid.removeRow(f.row);this.calculateStudentGrade(f)}return this.multiGrid.render()};e.prototype.updateSubmission=
function(a){var b;b=this.students[a.user_id];if(a.submitted_at)a.submitted_at=$.parseFromISO(a.submitted_at);return b["assignment_"+a.assignment_id]=a};e.prototype.updateSubmissionsFromExternal=function(a){var b,f,c,g;c=0;for(g=a.length;c<g;c++){f=a[c];b=this.students[f.user_id];this.updateSubmission(f);this.multiGrid.removeRow(b.row);this.calculateStudentGrade(b)}return this.multiGrid.render()};e.prototype.cellFormatter=function(a,b,f){var c;if(this.rows[a].loaded)if(f!=null&&f.grade){c=this.assignments[f.assignment_id];
return c==null?this.staticCellFormatter(a,b,""):c.grading_type==="points"&&c.points_possible?SubmissionCell.out_of.formatter(a,b,f,c):(SubmissionCell[c.grading_type]||SubmissionCell).formatter(a,b,f,c)}else return this.staticCellFormatter(a,b,"-");else return this.staticCellFormatter(a,b,"")};e.prototype.staticCellFormatter=function(a,b,f){return"<div class='cell-content gradebook-cell'>"+f+"</div>"};e.prototype.groupTotalFormatter=function(a,b,f){if(f==null)return"";a=Math.round(f.score/f.possible*
100);if(isNaN(a))a=0;if(f.possible)a+="%";else a="-";return'<div class="gradebook-cell">\n  <div class="gradebook-tooltip">'+f.score+" / "+f.possible+"</div>\n  "+a+"\n</div>"};e.prototype.calculateStudentGrade=function(a){var b,f,c,g,i,l,p;if(a.loaded){b=function(){var j;j=[];for(f in a){g=a[f];f.match(/^assignment_(?!group)/)&&j.push(g)}return j}();c=INST.GradeCalculator.calculate(b,this.assignmentGroups,this.options.group_weighting_scheme);p=c.group_sums;i=0;for(l=p.length;i<l;i++){b=p[i];a["assignment_group_"+
b.group.id]=b[this.include_ungraded_assignments?"final":"current"]}return a.total_grade=c[this.include_ungraded_assignments?"final":"current"]}};e.prototype.highlightColumn=function(a){var b;if(isNaN(a))if(b=a.currentTarget.className.match(/c\d+/))a=b.toString().replace("c","");return this.$grid.find(".slick-header-column:eq("+a+")").addClass("hovered-column")};e.prototype.unhighlightColumns=function(){return this.$grid.find(".hovered-column").removeClass("hovered-column")};e.prototype.fixColumnReordering=
function(){var a,b,f,c,g,i;a=$("#gradebook_grid").find(".slick-header-columns");g=a.sortable("option","items");(c=function(){a.sortable("option","items",'> *:not([id*="assignment_group"]):not([id*="total_grade"])');return $(g,a).not($('> *:not([id*="assignment_group"]):not([id*="total_grade"])',a)).data("sortable-item",null)})();(f=q(function(){return a.find(".gradebook-header-drop").click(q(function(l){l=$(l.target);l.data("gradebookHeaderMenu")||l.data("gradebookHeaderMenu",new GradebookHeaderMenu(this.assignments[l.data("assignmentId")],
l,this));return false},this))},this))();i=a.sortable("option","stop");return(b=function(){return a.sortable("option","stop",function(){var l;a.sortable("option","items",g);l=i.apply(this,arguments);c();f();b();return l})})()};e.prototype.minimizeColumn=function(a){var b,f;b=a.index();f=this.gradeGrid.getColumns()[b];f.cssClass=(f.cssClass||"").replace(" minimized","")+" minimized";f.unselectable=true;f.unminimizedName=f.name;f.name="";this.$grid.find(".c"+b).add(a).addClass("minimized");a.data("minimized",
true);this.assignmentsToHide.push(f.id);return $.store.userSet("hidden_columns_"+this.options.context_code,$.uniq(this.assignmentsToHide).join(","))};e.prototype.unminimizeColumn=function(a){var b,f;b=a.index();f=this.gradeGrid.getColumns()[b];f.cssClass=(f.cssClass||"").replace(" minimized","");f.unselectable=false;f.name=f.unminimizedName;this.$grid.find(".c"+b).add(a).removeClass("minimized");a.removeData("minimized");this.assignmentsToHide=$.grep(this.assignmentsToHide,function(c){return c!==
f.id});return $.store.userSet("hidden_columns_"+this.options.context_code,$.uniq(this.assignmentsToHide).join(","))};e.prototype.hoverMinimizedCell=function(a){var b,f,c,g,i,l;b=$(a.currentTarget).removeClass("hover");c=this.gradeGrid.getColumns()[b.index()];f=c.object;i=b.offset();g=[f.name];if(b.hasClass("slick-cell")){a=this.rows[this.gradeGrid.getCellFromEvent(a).row][c.id];if(f.points_possible!=null)g.push(""+((l=a.score)!=null?l:"--")+" / "+f.points_possible);else a.score!=null&&g.push(a.score);
Array.prototype.push.apply(g,$.map(SubmissionCell.classesBasedOnSubmission(a,f),q(function(p){return GRADEBOOK_TRANSLATIONS["#submission_tooltip_"+p]},this)))}else f.points_possible!=null&&g.push(h.t("points_out_of","out of %{points_possible}",{points_possible:f.points_possible}));return b.data("tooltip",$("<span />",{"class":"gradebook-tooltip",css:{left:i.left-15,top:i.top,zIndex:1E4,display:"block"},html:g.join("<br />")}).appendTo("body").css("top",function(p,j){return parseInt(j)-$(this).outerHeight()}))};
e.prototype.unhoverMinimizedCell=function(a){var b;if(b=$(this).data("tooltip"))return a.toElement===b[0]?b.mouseleave(function(){return b.remove()}):b.remove()};e.prototype.onGridInit=function(){var a;this.fixColumnReordering();$(this.spinner.el).remove();$("#gradebook_wrapper").show();this.$grid=a=$("#gradebook_grid").fillWindowWithMe({alsoResize:"#gradebook_students_grid",onResize:q(function(){return this.multiGrid.resizeCanvas()},this)}).delegate(".slick-cell",{"mouseenter.gradebook focusin.gradebook":this.highlightColumn,
"mouseleave.gradebook focusout.gradebook":this.unhighlightColumns,"mouseenter focusin":function(b){a.find(".hover, .focus").removeClass("hover focus");return $(this).addClass(b.type==="mouseenter"?"hover":"focus")},"mouseleave focusout":function(){return $(this).removeClass("hover focus")}}).delegate(".gradebook-cell-comment","click.gradebook",q(function(b){b.preventDefault();b=$(b.currentTarget).data();return SubmissionDetailsDialog.open(this.assignments[b.assignmentId],this.students[b.userId],this.options)},
this)).delegate(".minimized",{mouseenter:this.hoverMinimizedCell,mouseleave:this.unhoverMinimizedCell});$("#gradebook_grid .slick-resizable-handle").live("drag",q(function(){return this.$grid.find(".slick-header-column").each(q(function(b,f){var c,g;c=$(f);g=c.data("minimized");if(c.outerWidth()<=10){if(!g)return this.minimizeColumn(c)}else if(g)return this.unminimizeColumn(c)},this))},this));return $(document).trigger("gridready")};e.prototype.initHeader=function(){var a,b,f,c,g,i,l,p,j,v;if(this.sections_enabled){b=
$("#section_being_shown");g=h.t("all_sections","All Sections");p=[{name:g,checked:!this.sectionToShow}];v=this.sections;for(i in v){l=v[i];p.push({name:l.name,id:i,checked:this.sectionToShow===i})}a=$(d({sections:p,scrolling:p.length>15}));(j=q(function(){return b.text(this.sectionToShow?this.sections[this.sectionToShow].name:g)},this))();$("#section_to_show").after(a).show().kyleMenu({buttonOpts:{icons:{primary:"ui-icon-sections",secondary:"ui-icon-droparrow"}}});a.bind("menuselect",q(function(){this.sectionToShow=
Number(a.find('[aria-checked="true"] input[name="section_to_show_radio"]').val())||void 0;$.store[this.sectionToShow?"userSet":"userRemove"]("grading_show_only_section"+this.options.context_id,this.sectionToShow);j();return this.buildRows()},this))}f=$("#gradebook_settings").next();$.each(["show_attendance","include_ungraded_assignments"],q(function(k,w){return f.find("#"+w).prop("checked",this[w]).change(q(function(B){this[w]=$(B.target).is(":checked");$.store.userSet(""+w+"_"+this.options.context_code,
""+this[w]);return this.buildRows()},this))},this));$.detect(this.gradeGrid.getColumns(),function(){var k;return((k=this.object)!=null?k.submission_types:void 0)==="attendance"})||f.find("#show_attendance").hide();this.$columnArrangementTogglers=$("#gradebook-toolbar [data-arrange-columns-by]").bind("click",q(function(k){k.preventDefault();return this.arrangeColumnsBy($(k.currentTarget).data("arrangeColumnsBy"))},this));this.arrangeColumnsBy("assignment_group");$("#gradebook_settings").show().kyleMenu({buttonOpts:{icons:{primary:"ui-icon-cog",
secondary:"ui-icon-droparrow"}}});c=null;return f.find(".gradebook_upload_link").click(q(function(k){k.preventDefault();if(!c){k={download_gradebook_csv_url:""+this.options.context_url+"/gradebook.csv",action:""+this.options.context_url+"/gradebook_uploads",authenticityToken:$("#ajax_authenticity_token").text()};c=$(Template("gradebook_uploads_form",k)).dialog({bgiframe:true,autoOpen:false,modal:true,width:720,resizable:false}).fixDialogButtons().delegate("#gradebook-upload-help-trigger","click",
function(){$(this).hide();return $("#gradebook-upload-help").show()})}return c.dialog("open")},this))};e.prototype.initGrid=function(){var a,b,f,c,g,i,l,p,j,v;a=$('<span style="padding:10px" />').appendTo("#content");l=function(k,w){return Math.max(a.text(k).outerWidth(),w)};this.columns=[{id:"student",name:h.t("student_name","Student Name"),field:"display_name",width:150,cssClass:"meta-cell",resizable:false,sortable:true},{id:"secondary_identifier",name:h.t("secondary_id","Secondary ID"),field:"secondary_identifier",
width:100,cssClass:"meta-cell secondary_identifier_cell",resizable:false,sortable:true}];v=this.assignments;for(g in v){b=v[g];f=""+this.options.context_url+"/assignments/"+b.id;f="<a class='assignment-name' href='"+f+"'>"+b.name+"</a>                <a class='gradebook-header-drop' data-assignment-id='"+b.id+"' href='#' role='button'>"+h.t("assignment_options","Assignment Options")+"</a>";if(b.points_possible!=null)f+="<div class='assignment-points-possible'>"+h.t("points_out_of","out of %{points_possible}",
{points_possible:b.points_possible})+"</div>";i=(p=b&&b.grading_type==="points"&&b.points_possible!=null&&SubmissionCell.out_of)?70:90;c="assignment_"+g;f={id:c,field:c,name:f,object:b,formatter:this.cellFormatter,editor:p||SubmissionCell[b.grading_type]||SubmissionCell,minWidth:10,maxWidth:200,width:l(b.name,i),sortable:true,toolTip:true,type:"assignment"};if(""+b.submission_types==="not_graded"){f.cssClass=(f.cssClass||"")+" ungraded";f.unselectable=true}if(t.call(this.assignmentsToHide,c)>=0){f.width=
10;q(function(k){return $(document).bind("gridready",q(function(){return this.minimizeColumn(this.$grid.find("[id*='"+k+"']"))},this)).unbind("gridready.render").bind("gridready.render",q(function(){return this.gradeGrid.invalidate()},this))},this)(c)}this.columns.push(f)}v=this.assignmentGroups;for(g in v){b=v[g];f=""+b.name;if(b.group_weight!=null)f+="<div class='assignment-points-possible'>"+h.t("percent_of_grade","%{percentage} of grade",{percentage:h.toPercentage(b.group_weight,{precision:0})})+
"</div>";this.columns.push({id:"assignment_group_"+g,field:"assignment_group_"+g,formatter:this.groupTotalFormatter,name:f,object:b,minWidth:35,maxWidth:200,width:l(b.name,35),cssClass:"meta-cell assignment-group-cell",sortable:true,type:"assignment_group"})}this.columns.push({id:"total_grade",field:"total_grade",formatter:this.groupTotalFormatter,name:"Total",minWidth:50,maxWidth:100,width:l("Total",50),cssClass:"total-cell",sortable:true,type:"total_grade"});a.remove();l=$.extend({enableCellNavigation:false,
enableColumnReorder:false,enableAsyncPostRender:true,asyncPostRenderDelay:1,autoEdit:true,rowHeight:35},this.options);g=[{selector:"#gradebook_students_grid",columns:this.columns.slice(0,2)},{selector:"#gradebook_grid",columns:this.columns.slice(2,this.columns.length),options:{enableCellNavigation:true,editable:true,syncColumnCellResize:true,enableColumnReorder:true}}];this.multiGrid=new MultiGrid(this.rows,l,g,1);this.gradeGrid=this.multiGrid.grids[1];this.gradeGrid.onCellChange=q(function(k,w,B){return this.calculateStudentGrade(B)},
this);j=q(function(k){var w,B,x;this.rows.sort(k);x=this.rows;k=0;for(B=x.length;k<B;k++){w=x[k];w.row=k}return this.multiGrid.invalidate()},this);this.gradeGrid.onSort=q(function(k,w){return j(function(B,x){var m,A,r;m=(A=B[k.field])!=null?A.score:void 0;A=(r=x[k.field])!=null?r.score:void 0;if(!m&&m!==0)m=-99999999999;if(!A&&A!==0)A=-99999999999;return w?A-m:m-A})},this);this.multiGrid.grids[0].onSort=q(function(k,w){var B;B={display_name:"sortable_name",secondary_identifier:"secondary_identifier"}[k.field];
return j(function(x,m){var A;A=x[B]<m[B]?-1:x[B]>m[B]?1:0;return w?A:0-A})},this);this.multiGrid.parent_grid.onKeyDown=q(function(){return false},this);return this.onGridInit()};return e}()})}).call(this);
(function(){var q=function(d,e){return function(){return d.apply(e,arguments)}},t=Object.prototype.hasOwnProperty,h=function(d,e){function a(){this.constructor=d}for(var b in e)if(t.call(e,b))d[b]=e[b];a.prototype=e.prototype;d.prototype=new a;d.__super__=e.prototype;return d};this.SubmissionCell=function(){function d(e){this.opts=e;this.init()}d.prototype.init=function(){this.$wrapper=$(this.cellWrapper('<input class="grade"/>')).appendTo(this.opts.container);return this.$input=this.$wrapper.find("input").focus().select()};
d.prototype.destroy=function(){return this.$input.remove()};d.prototype.focus=function(){return this.$input.focus()};d.prototype.loadValue=function(){this.val=this.opts.item[this.opts.column.field].grade||"";this.$input.val(this.val);this.$input[0].defaultValue=this.val;return this.$input.select()};d.prototype.serializeValue=function(){return this.$input.val()};d.prototype.applyValue=function(e,a){var b;e[this.opts.column.field].grade=a;if((b=this.wrapper)!=null)b.remove();return this.postValue(e,
a)};d.prototype.postValue=function(e,a){var b,f;b=e[this.opts.column.field];f=this.opts.grid.getOptions().change_grade_url;f=f.replace(":assignment",b.assignment_id).replace(":submission",b.user_id);return $.ajaxJSON(f,"PUT",{"submission[posted_grade]":a},q(function(c){return $.publish("submissions_updated",[[c]])},this))};d.prototype.isValueChanged=function(){return this.val!==this.$input.val()};d.prototype.validate=function(){return{valid:true,msg:null}};d.formatter=function(e,a,b,f){return this.prototype.cellWrapper(b.grade,
{submission:b,assignment:f,editable:false})};d.prototype.cellWrapper=function(e,a){var b,f,c;if(a==null)a={};b=$.extend({},{innerContents:"",classes:"",editable:true},a);b.submission||(b.submission=this.opts.item[this.opts.column.field]);b.assignment||(b.assignment=this.opts.column.object);f=d.classesBasedOnSubmission(b.submission,b.assignment);c=$.map(f,function(g){return GRADEBOOK_TRANSLATIONS["submission_tooltip_"+g]}).join(", ");return""+(c?'<div class="gradebook-tooltip">'+c+"</div>":"")+'\n<div class="gradebook-cell '+
(b.editable?"gradebook-cell-editable focus":"")+" "+b.classes+" "+f.join(" ")+'">\n  <a href="#" data-user-id='+b.submission.user_id+" data-assignment-id="+b.assignment.id+' class="gradebook-cell-comment"><span class="gradebook-cell-comment-label">submission comments</span></a>\n  '+e+"\n</div>"};d.classesBasedOnSubmission=function(e,a){var b;if(e==null)e={};if(a==null)a={};b=[];e.grade_matches_current_submission===false&&b.push("resubmitted");a.due_at&&e.submitted_at&&e.submitted_at.timestamp>a.due_at.timestamp&&
b.push("late");e.drop&&b.push("dropped");""+a.submission_types==="not_graded"&&b.push("ungraded");a.muted&&b.push("muted");return b};return d}();SubmissionCell.out_of=function(){function d(){d.__super__.constructor.apply(this,arguments)}h(d,SubmissionCell);d.prototype.init=function(){this.$wrapper=$(this.cellWrapper('<div class="overflow-wrapper">\n  <div class="grade-and-outof-wrapper">\n    <input type="number" class="grade"/><span class="outof"><span class="divider">/</span>'+this.opts.column.object.points_possible+
"</span>\n  </div>\n</div>",{classes:"gradebook-cell-out-of-formatter"})).appendTo(this.opts.container);return this.$input=this.$wrapper.find("input").focus().select()};return d}();SubmissionCell.pass_fail=function(){function d(){d.__super__.constructor.apply(this,arguments)}var e;h(d,SubmissionCell);e=function(a){return{pass:"pass",complete:"pass",fail:"fail",incomplete:"fail"}[a.grade]||""};d.prototype.htmlFromSubmission=function(a){var b;if(a==null)a={};b=e(a.submission);return SubmissionCell.prototype.cellWrapper('<a data-value="'+
b+'" class="gradebook-checkbox gradebook-checkbox-'+b+" "+(a.editable?"editable":void 0)+'" href="#">'+b+"</a>",a)};d.formatter=function(a,b,f,c){return d.prototype.htmlFromSubmission({submission:f,assignment:c,editable:false})};d.prototype.init=function(){this.$wrapper=$(this.cellWrapper());this.$wrapper=$(this.htmlFromSubmission({submission:this.opts.item[this.opts.column.field],assignment:this.opts.column.object,editable:true})).appendTo(this.opts.container);return this.$input=this.$wrapper.find(".gradebook-checkbox").bind("click keypress",
q(function(a){a.preventDefault();a=this.$input.data("value");return this.transitionValue(a==="pass"?"fail":a==="fail"?"":"pass")},this)).focus()};d.prototype.destroy=function(){return this.$wrapper.remove()};d.prototype.transitionValue=function(a){return this.$input.removeClass("gradebook-checkbox-pass gradebook-checkbox-fail").addClass("gradebook-checkbox-"+e({grade:a})).data("value",a)};d.prototype.loadValue=function(){return this.val=this.opts.item[this.opts.column.field].grade||""};d.prototype.serializeValue=
function(){return this.$input.data("value")};d.prototype.isValueChanged=function(){return this.val!==this.$input.data("value")};return d}();SubmissionCell.points=function(){function d(){d.__super__.constructor.apply(this,arguments)}h(d,SubmissionCell);return d}()}).call(this);
$.extend(true,I18n=I18n||{},{translations:{es:{message_students:{buttons:{send_message_failed:"Env\u00edo del Mensaje Fall\u00f3, intente de nuevo",sending_message:"Enviando Mensaje...",send_message:"Enviar Mensaje"},message_student:"Enviar Mensaje a Estudiantes para %{course_name}",send_message:"Enviar el Mensaje"}}}});
