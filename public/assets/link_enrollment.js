I18n.scoped("link_enrollment",function(c){window.link_enrollment=function(){return{choose:function(b,f,d,i){$(this).parents(".user");var a=$("#link_student_dialog"),e={};e.short_name=b;a.fillTemplateData({data:e});if(a.data("loaded")){a.find(".enrollment_id").val(f);a.find(".existing_user").showIf(d);a.find(".student_options").val("none").val(d);e.existing_user_name=a.find(".student_options option[value='"+d+"']").text();a.fillTemplateData({data:e})}else{a.find(".loading_message").text(c.t("messages.loading_students",
"Loading Students..."));b=a.find(".student_url").attr("href");$.ajaxJSON(b,"GET",{},function(j){for(var k in j){var h=j[k],g=$("<option/>");if(h.id&&h.name){g.val(h.id).text(h.name);a.find(".student_options").append(g)}}g=$("<option/>");g.val("none").text(c.t("options.no_link","[ No Link ]"));a.data("loaded",true);a.find(".student_options").append(g);a.find(".enrollment_id").val(f);a.find(".student_options").val("none").val(d);a.find(".loading_message").hide().end().find(".students_link").show();
a.find(".existing_user").showIf(d);a.data("callback",i);e.existing_user_name=a.find(".student_options option[value='"+d+"']").text();a.fillTemplateData({data:e})},function(){a.find(".loading_message").text(c.t("errors.load_failed","Loading Students Failed, please try again"));a.data("callback",i)})}a.find(".existing_user").showIf(d);a.find(".student_options option:not(.blank)").remove();a.dialog("close").dialog({autoOpen:false,title:c.t("titles.link_to_student","Link to Student"),width:400}).dialog("open")}}}();
$(document).ready(function(){$(document).bind("enrollment_added",function(){$("#link_student_dialog").data("loaded",false)});$("#link_student_dialog .cancel_button").click(function(){$("#link_student_dialog").dialog("close")});$("#link_student_dialog_form").formSubmit({beforeSubmit:function(){$(this).find("button").attr("disabled",true).end().find(".save_button").text(c.t("messages.linking_to_student","Linking to Student..."))},success:function(b){$(this).find("button").attr("disabled",false).end().find(".save_button").text(c.t("buttons.link",
"Link to Student"));b=b.enrollment;var f=$("#link_student_dialog").data("callback");$("#link_student_dialog").dialog("close");$.isFunction(f)&&b&&f(b)},error:function(){$(this).find("button").attr("disabled",false).find(".save_button").text(c.t("errors.link_failed","Linking Failed, please try again"))}})})});
$.extend(true,I18n=I18n||{},{translations:{es:{link_enrollment:{buttons:{link:"Enlazar a Estudiante"},messages:{linking_to_student:"Enlazando a Estudiante...",loading_students:"Cargando Estudiantes..."},errors:{load_failed:"No se pudieron cargar los Estudiantes, intente de nuevo",link_failed:"No se pudieron hacer los enlaces, intente de nuevo"},titles:{link_to_student:"Enlazar a Estudiante"},options:{no_link:"[ Sin Enlace ]"}}}}});
