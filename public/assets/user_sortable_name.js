$(function(){var c=$('input[name="user[short_name]"]'),e=c.parents("form").find('input[name="user[name]"]'),g=$('input[name="user[sortable_name]"]'),d=e.attr("value");e.keyup(function(){var a=e.attr("value"),b=g.attr("value"),f=userUtils.nameParts(b);if(jQuery.trim(b)===""||userUtils.firstNameFirst(f)===jQuery.trim(d)){b=userUtils.nameParts(a,f[1]);g.attr("value",userUtils.lastNameFirst(b))}b=c.attr("value");if(jQuery.trim(b)===""||b===d)c.attr("value",a);d=$(this).attr("value")})});
var userUtils={nameParts:function(c,e){var g=/^(Sn?r\.?|Senior|Jn?r\.?|Junior|II|III|IV|V|VI|Esq\.?|Esquire)$/i,d,a,b,f;if(!c||jQuery.trim(c)==="")return[null,null,null];b=jQuery.map(c.split(","),function(h){return jQuery.trim(h)});d=b[0];a=b[1];b=b.slice(2).join(", ");if(b==="")b=null;if(b&&!g.test(b)){a=a+" "+b;b=null}if(typeof a==="string"){if(!b&&g.test(a)){b=a;a=d;d=null}}else{a=jQuery.trim(c);d=null}a=a.split(/\s+/);if(a.length===1&&a[0]==="")a=[];if(!b&&a.length>1&&g.test(a[a.length-1]))b=
a.pop();if(!d&&e&&!/^\s*$/.test(e)&&(f=e.split(/\s+/))&&a.length>=f.length&&a.slice(a.length-f.length).join(" ")===f.join(" "))d=a.splice(a.length-f.length,f.length).join(" ");if(!d&&a.length>1)d=a.pop();return[a.length===0?null:a.join(" "),d,b]},lastNameFirst:function(c){var e=jQuery.trim([c[0],c[2]].join(" "));return jQuery.trim(c[1]?c[1]+", "+e:e)},firstNameFirst:function(c){return jQuery.trim(c.join(" ").replace(/\s+/," "))}};
