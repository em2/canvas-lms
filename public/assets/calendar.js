I18n.scoped("calendars",function(i){(function(){function o(){$(".calendar_month, .calendar_week, .calendar_day, .calendar_undated, .mini_calendar, .mini_calendar_week, .mini_calendar_day").each(function(){if(!$(this).data("drag_position")){var c=$(this),e=c.offset(),g=c.outerWidth(),b=c.outerHeight();if($(this).hasClass(".calendar_week"))b=c.find(".calendar_day:first").outerHeight();$(this).data("drag_position",{offset:e,width:g,height:b})}})}function n(c){c=c.originalEvent;var e=c.pageX,g=c.pageY,
b=null,f=null,h=null;if($(".calendar_day_undated").data("drag_position")){if(K){c=K.data("drag_position");if(e>=c.offset.left&&e<=c.offset.left+c.width&&g>=c.offset.top&&g<=c.offset.top+c.height)return K}$(".calendar_day_undated").each(function(){var a=$(this).data("drag_position");if(e>=a.offset.left&&e<=a.offset.left+a.width&&g>=a.offset.top&&g<=a.offset.top+a.height){h=$(this);return false}});if(h)return h;$(".calendar_month,.mini_calendar").each(function(){var a=$(this).data("drag_position");
if(e>=a.offset.left&&e<=a.offset.left+a.width&&g>=a.offset.top&&g<=a.offset.top+a.height){b=$(this);return false}});if(b){b.find(".calendar_week,.mini_calendar_week").each(function(){var a=$(this).data("drag_position");if(e>=a.offset.left&&e<=a.offset.left+a.width&&g>=a.offset.top&&g<=a.offset.top+a.height){f=$(this);return false}});f&&f.find(".calendar_day,.mini_calendar_day").each(function(){var a=$(this).data("drag_position");if(e>=a.offset.left&&e<=a.offset.left+a.width&&g>=a.offset.top&&g<=a.offset.top+
a.height){h=$(this);return false}})}return K=h}}function s(c,e,g){$before=null;e.length===0&&c.remove();g||e.find(".calendar_event").each(function(){var b=($(this).data("event_data")||{}).time_sortable||"",f=(c.data("event_data")||{}).time_sortable||"";if(b>f){$before=$(this);return false}else if(b==f&&$(this).find(".title").text()>c.find(".title").text()){$before=$(this);return false}});$before&&!g?$before.before(c.show()):e.children("div.calendar_day").append(c.show());return c}function r(c,e){calendarMonths.changeMonth(c,
e);c.hasClass("mini_month")||setTimeout(y,500)}function y(){$month=$(".calendar_container .calendar_month");F($month,true)}function k(c){for(var e in l)calendar.appendToCache(e,[c])}function x(c,e){var g=0,b=[],f=function(h){if(c.length>0){var a=c.shift();g++;if(a){a=v(a,null,e);b.push("#event_"+a)}if(g>50){g=0;setTimeout(function(){f(h)},500)}else f(h)}else h&&b.join(",")};setTimeout(function(){f(true)},10)}function F(c,e,g,b){var f,h=true;if(typeof c=="string"){f=c.split("/");g=f[0];f=f[1];c=$(".calendar_month:first");
h=false}else{c.monthLoading();g=parseInt(c.find(".month_number").text(),10);f=parseInt(c.find(".year_number").text(),10)}var a=monthDataURL.replace("%25m",g).replace("%25y",f).replace(/&amp;/g,"&");b=a+(b==false?"":"&include_undated=1");var d=[];l[a]||(l[a]=[]);l[a].contexts_last_update_at=l[a].contexts_last_update_at||{};l[a].contexts_loading=l[a].contexts_loading||{};var j=null,q=true;$(".calendar_links .group_reference_checkbox:checked").each(function(){var t=$(this).attr("id").substring(6);l[a].contexts_last_update_at[t]||
(q=false);if(j!=""&&l[a].contexts_last_update_at[t]){if(!j||l[a].contexts_last_update_at[t]<j)j=l[a].contexts_last_update_at[t]}else j="";if(!l[a].contexts_loading[t])if(!e||!l[a].contexts_last_update_at[t])d.push(t)});b=b+"&last_update_at="+(j||"");var m={};h&&c.find(".calendar_event").each(function(){if($(this).attr("id"))m[$(this).attr("id")]=true});delete m.event_blank;delete m.event_new;delete m.event_id;if(e&&q&&l[a]&&(l[a].dont_retry||l[a].length>0)){var p=$.merge([],l[a]);if(h){x(p);c.monthLoading("remove")}}else{h&&
c.monthLoading("remove");g=[];f=[];for(p in d){f.push(d[p]);if(f.length>=5){g.push(f);f=[]}}f.length>0&&g.push(f);for(p in g){h&&c.monthLoading();(function(t,u,G){for(var H in t)l[u].contexts_loading[t[H]]=true;G=G+"&only_contexts="+t.join(",");$.ajaxJSON(G,"GET",{},function(J){calendar.appendToCache(u,J);$.each(J,function(X,L){var P=(L.calendar_event||L.assignment).context_code,M=(L.calendar_event||L.assignment).updated_at;if(!calendar.lastUpdate[u]||M>calendar.lastUpdate[u])calendar.lastUpdate[u]=
M;if(!l[u].contexts_last_update_at[P]||M>l[u].contexts_last_update_at[P])l[u].contexts_last_update_at[P]=M});var R=(new Date).toString("u"),N;for(N in t){l[u].contexts_last_update_at[t[N]]=l[u].contexts_last_update_at[t[N]]||R;l[u].contexts_loading[t[N]]=false}if(h){x(J,true);c.monthLoading("remove")}},function(){if(l[u]&&l[u].dont_retry)l[u].dont_retry=false;for(var J in t)l[u].contexts_loading[t[J]]=false;h&&c.monthLoading("remove")})})(g[p],a,b)}}}function v(c,e,g){var b=$.extend({},c.assignment),
f=null,h=null;if(c.calendar_event){b=$.extend({},c.calendar_event);f=$.parseFromISO(b.start_at);h=$.parseFromISO(b.end_at);b.start_time_string=f.time_string;b.end_time_string=h.time_string;b.start_time_formatted=f.time_formatted;b.start_date_string=f.date_formatted;b.end_time_formatted=h.time_formatted;b.time_sortable=f.time_sortable;b.event_type="calendar_event";f="calendar_event_"+b.id;v.details_urls=v.details_urls||{};key="calendar_event_"+b.context_type+b.context_id;if(!v.details_urls[key]){h=
S;h=$.replaceTags(h,"context_id",b.context_id);h=$.replaceTags(h,"context_type",b.context_type.toLowerCase());v.details_urls[key]=h}h=v.details_urls[key]}else{f=$.parseFromISO(b.due_at,"due_date");b.start_time_string=f.time_string;b.end_time_string=f.time_string;b.start_time_formatted=f.time_formatted;b.start_date_string=f.date_formatted;b.end_time_formatted=f.time_formatted;b.time_sortable=f.time_sortable;b.start_at=b.due_at;b.event_type="assignment";f="assignment_"+b.id;v.details_urls=v.details_urls||
{};key="assignment_"+b.context_type+b.context_id;if(!v.details_urls[key]){h=T;h=$.replaceTags(h,"context_id",b.context_id);h=$.replaceTags(h,"context_type",b.context_type.toLowerCase());v.details_urls[key]=h}h=v.details_urls[key];h=$.replaceTags(h,"id",b.id);h=$.replaceTags(h,"context_id",b.context_id);h=$.replaceTags(h,"context_type",b.context_type.toLowerCase())}e&&e.attr("id")=="event_new"&&e.attr("id","event_"+f);if(!b.start_at&&!e&&!calendar.showingUndatedEvents){calendar.hiddenUndatedEvents=
calendar.hiddenUndatedEvents||[];calendar.hiddenUndatedEvents.push(c);U.text(calendar.hiddenUndatedEvents.length)}else{if(!e||e.attr("id")!="event_new"&&e.attr("id")!="event_"+f){e=$("#event_"+f+":visible");if(e.length>0&&e.find(".updated_at").text()==b.updated_at)return}e=$("#event_"+f);var a=$.parseFromISO(b.all_day_date);b.all_day_date="";if(b.all_day){b.start_at=b.all_day_date.substring(0,10);if(a.date_timestamp){b.all_day_date=a.date_formatted;b.start_at=a.date_sortable.substring(0,10)}b.start_time_formatted=
"";b.end_time_formatted=""}a=managementContexts&&$.inArray(b.context_code,managementContexts)!=-1;if(b.permissions||a){b.can_edit=a||b.permissions&&b.permissions.update;b.can_delete=a||b.permissions&&b.permissions["delete"]}if(b.workflow_state=="deleted"){e.remove();return f}if(!e||e.length===0){e=V.clone(true);h=$.replaceTags(h,"id",b.id);e.find(".title").attr("href",h);e.toggleClass("assignment",!!c.assignment);g!==true&&e.draggable(O)}else if(e.find(".title").attr("href")==="#"){h=$.replaceTags(h,
"id",b.id);e.find(".title").attr("href",h)}e.fillTemplateData({data:{title:b.title},hrefValues:["id"],id:"event_"+f});e.data("event_data",b);e.toggleClass("draggable",b.can_edit);e.data("description",b.description);e.attr("class");h="group_"+b.context_type.toLowerCase()+"_"+b.context_id;e.addClass(h);e.addClass("event_"+f);a=$(".calendar_undated");if(b.start_at!=null)a=$("#day_"+b.start_at.substring(0,10).replace(/-/g,"_"));e.hasClass("event_pending")||s(e,a,g);g=b.start_time_formatted||"";if(b.start_time_string&&
b.start_time_string!=b.end_time_string)g+=" to "+(b.end_time_formatted||"");event_title=b.title;event_title+=g?" - "+g:"";if(c.assignment&&g)event_title="due: "+event_title;e.find(".calendar_event_text").attr("title",event_title).show();$("#"+h).length>0&&e.showIf($("#"+h).attr("checked"));return f}}function I(c){$(".calendar_month").each(function(){F($(this),c||false,true,null)})}function B(c,e){var g=$("#event_details"),b=$.extend({},c.getTemplateData({textValues:["id","start_time_string","end_time_string",
"start_date_string","title","event_type","can_edit","can_delete","context_id","context_type","all_day"],htmlValues:["description"]}),c.data("event_data"));b.description=c.data("description");b.start_time=b.start_time_string;b.end_time=b.end_time_string;var f={},h="",a="";if(e.find(".day_number").length){h=e.find(".day_number").attr("title").split("/").pop();a=b.start_date_string;a.match(RegExp(h))||(a=a+" "+h)}if(b.all_day=="true"){f=Date.parse(a);b.time_string=$.dateString(f)}else if(b.start_time_string){f=
Date.parse(a);b.time_string=$.dateString(f)}else{b.time_string="No Date Set";b.date=""}g.data("current_event",c).data("current_day",e);g.find(".title").attr("href",c.find(".title").attr("href"));g.find(".view_event_link").attr("href",c.find(".title").attr("href"));g.find(".delete_event_link").attr("href",c.find(".delete_"+b.event_type+"_link").attr("href"));g.find(".edit_event").showIf(b.can_edit);g.find(".delete_event").showIf(b.can_delete);h="Event";c.attr("id")=="event_blank"?$("#edit_event").addClass("new_event"):
$("#edit_event").removeClass("new_event");if(b.event_type=="assignment")h="Assignment";if(b.event_type=="assignment"||b.start_time==b.end_time){if(b.all_day=="true"&&b.event_type=="assignment")b.time_string=b.start_date_string+" at "+b.start_time_string;else if(b.start_time){a=$.dateString(f);b.time_string=a+" at "+b.start_time_string}if(b.event_type=="assignment"&&b.time_string)b.time_string="due: "+b.time_string}b.description=c.data("description");g.fillTemplateData({data:b,htmlValues:["description"]});
b.lock_info&&g.find(".lock_explanation").html(INST.lockExplanation(b.lock_info,"assignment"));$("#edit_event").dialog("close");$("#event_details").dialog("close");$("#event_details").find(".description").css("max-height",Math.max($(window).height()-200,150));g=h=="Event"?i.t("event_details","Event Details"):i.t("assignment_details","Assignment Details");$("#event_details").show().dialog({title:g,width:b.description.length>2E3?Math.max($(window).width()-300,450):450,resizable:true,close:function(){$(document).click();
A()},open:function(){$(document).triggerHandler("event_dialog",$(this))},autoOpen:false}).dialog("open").dialog("option","title",g);c.addClass("selected");C(e.parents(".calendar_day_holder"))}function C(c){$(".calendar_container").data("prevent_hover",true);$(".calendar_day_holder.selected").removeClass("selected");$(".mini_calendar .day.related").removeClass("related");c.addClass("selected");(c=c.find(".day_number").attr("title"))&&$(".mini_calendar .day.date_"+c.replace(/\//g,"_")).addClass("related")}
function A(){$(".calendar_container").data("prevent_hover",false);$(".calendar_day_holder.selected").removeClass("selected");$(".mini_calendar .day.related").removeClass("related")}function z(c,e,g){if(c.attr("id")=="edit_assignment_form")if(c.hasClass("new_event")){c.attr("method","POST");var b=$("#context_urls ."+e+"_add_assignment_url").attr("href")||"";c.find(".more_options_link").attr("href",$("."+e+"_add_assignment_url").attr("href")+"/new")}else{c.attr("method","PUT");b=$("#context_urls ."+
e+"_assignment_url").attr("href")||"";b=$.replaceTags(b,"id",g);c.find(".more_options_link").attr("href",b+"/edit")}else if(c.hasClass("new_event")){c.attr("method","POST");b=$("#context_urls ."+e+"_add_event_url").attr("href")||"";c.find(".more_options_link").attr("href",$("."+e+"_add_event_url").attr("href")+"/new")}else{c.attr("method","PUT");b=$("#context_urls ."+e+"_event_url").attr("href")||"";b=$.replaceTags(b,"id",g);c.find(".more_options_link").attr("href",b+"/edit")}c.attr("action",b)}function w(c,
e){var g=$("#edit_event");$("#edit_event_tabs").show();var b=$.extend({},c.data("event_data"),c.getTemplateData({textValues:["title"]}));b.description=c.data("description");b.context_type=b.context_type||"";b.id=b.id||"";var f=b.context_type.toLowerCase()+"_"+b.context_id;if(!b.context_type||c.attr("id")=="event_blank")f=$("#edit_event select.context_id").val();b.start_time=b.start_time_string||"";b.end_time=b.end_time_string||"";b.date=e.find(".day_number").attr("title");if(b.all_day=="true"){b.start_time=
"";b.end_time="";b.date=b.all_day_date}b.due_at="";var h=Date.parse(b.date+" "+b.start_time)||Date.parse(b.date),a=Date.parse(b.date+" "+b.end_time)||Date.parse(b.date);if(h){b.date=h.toString("MMM d, yyyy");b.due_at=$.datetime.clean(h);if(b.start_time_string)b.start_time=h.toString("h:mmtt").toLowerCase();if(b.end_time_string)b.end_time=a.toString("h:mmtt").toLowerCase()}else b.date="";h=c.attr("id")=="event_blank";a="Event";var d=null;$("#edit_event,#edit_assignment_form,#edit_calendar_event_form").toggleClass("new_event",
h);var j=g.find("#edit_assignment_form").show();j.find("select.context_id").val(f);z(j,f,b.id);var q=g.find("#edit_calendar_event_form").show();q.find("select.context_id").val(f);z(q,f,b.id);if(b.event_type=="assignment"){d=j;a="Assignment"}else d=q;$("#edit_assignment_form,#edit_calendar_event_form").data("event_id",b.id).data("context",f);$("#event_details").data("current_event",c);$("#edit_assignment_form").data("current_event",c);$("#edit_calendar_event_form").data("current_event",c);$("#edit_assignment_form").fillFormData(b,
{object_name:"assignment"});$("#edit_calendar_event_form").fillFormData(b,{object_name:"calendar_event"});$("#event_details").dialog("close");$("#edit_event").dialog("close");C(e.parents(".calendar_day_holder"));h=h?a=="Event"?i.t("titles.add_new_event","Add New Event"):i.t("titles.add_new_assignment","Add New Assignment"):a=="Event"?i.t("titles.edit_event","Edit Event"):i.t("titles.edit_assignment","Edit Assignment");$("#edit_event").show().dialog({title:h,width:400,open:function(){$(document).triggerHandler("edit_event_dialog",
g);var m=g.find("#edit_event_tabs"),p=$("#event_details").data("current_event"),t=$.extend({},p.data("event_data")),u=p.attr("id")=="event_blank",G=$.map($(".group_reference_checkbox:checked"),function(H){return $(H).attr("id").replace("group_","")});$("#edit_event .context_select").each(function(){var H=$(this).find("select.context_id"),J=window.thisElementFiredTheEvent&&($(window.thisElementFiredTheEvent).closest(".group_reference").find(".group_reference_checkbox").attr("id")||"").replace("group_",
"");H.find("option").attr("disabled",function(){return G.length&&$.inArray($(this).val(),G)===-1});if(G.length)H.val(J||G[0]);$(this).showIf(u);H.val(f);H.triggerHandler("change",false)});m.tabs("enable",0);m.tabs("enable",1);p=0;if(t.event_type=="assignment"){p=1;m.tabs("select",1);if(u)m.find(".ui-tabs-nav").show();else{m.find(".ui-tabs-nav").hide();m.tabs("disable",0)}}else{m.tabs("select",0);if(u)m.find(".ui-tabs-nav").show();else{m.find(".ui-tabs-nav").hide();m.tabs("disable",1)}if($("#edit_assignment_form select.context_id option").filter(function(){return!$(this).attr("disabled")}).length===
0){m.tabs("disable",1);p=0}}if(u)p=0;m.tabs("select",p);p==0?$("#edit_calendar_event_form :text:first").focus().select():$("#edit_assignment_form :text:first").focus().select();m.find(".ui-tabs-panel:eq("+m.tabs("option","selected")+") select.context_id").triggerHandler("change");$("#edit_assignment_form").find(".assignment_group_id").val(t.assignment_group_id)},drag:function(){d.hideErrors()},autoSize:true,close:function(){A();var m=$("#edit_event .assignment_group_id");m.length>0&&$("#"+m.attr("id").substring(5)).empty().append(m.children().clone());
m=$("#edit_event_tabs").data("selected.tabs");if($("#edit_event").hasClass("new_event")){var p={};if(m==1){p=$("#edit_assignment_form").getFormData({object_name:"assignment"});p.event_type="assignment";p.start_time_string=p.start_time;p.end_time_string=p.start_time}else{p=$("#edit_calendar_event_form").getFormData({object_name:"calendar_event"});p.event_type="calendar_event";p.start_time_string=p.start_time;p.end_time_string=p.end_time}$("#event_blank").fillTemplateData({data:p})}d.find("input[name='date']").datepicker("hide")},
autoOpen:false,resizable:false,modal:true}).dialog("open").dialog("option","title",h);if(b.context_id&&b.context_type){h=g.find("#edit_event_tabs");b=(""+b.context_type+"_"+b.context_id).toLowerCase();h.data("group_class")&&h.removeClass(h.data("group_class"));h.addClass("group_"+b).data("group_class","group_"+b)}}function D(c){var e=$(".calendar_container .calendar_day_holder.selected:first");if(!e||e.length===0)E(c);else{var g=e.find(".calendar_event"),b=g.filter(".selected:first");if(g.length===
0){if(c=="down")c="right";else if(c=="up")c="left";E(c)}else if(!b||b.length===0){$(".calendar_event.selected").removeClass("selected");b=c=="up"?e.find(".calendar_event:last"):e.find(".calendar_event:first");b.find("a.title").focus();b.addClass("selected");$("html,body").scrollTo(b)}else if((e=c=="up"?b.prev(".calendar_event"):b.next(".calendar_event"))&&e.length>0){$(".calendar_event.selected").removeClass("selected");e.find("a.title").focus();e.addClass("selected");$("html,body").scrollTo(e)}else{if(c==
"down")c="right";else if(c=="up")c="left";E(c)}}}function E(c){var e=$(".calendar_container .calendar_day_holder.selected:first");if(!e||e.length===0){$(".calendar_container .calendar_day_holder.selected").removeClass("selected");$(".calendar_container .calendar_event.selected").removeClass("selected");e=$(".calendar_container .calendar_day_holder .current_month").eq(0).parent();e.addClass("selected");$("html,body").scrollTo(e)}else{var g=e.parents(".calendar_month"),b=null,f=e.attr("id").split("_");
f=new Date(f[1],f[2]-1,f[3]);if(c=="right"){b=e.next().find(".current_month").parent();if(b.length===0)b=e.parent().next(".visible").find(".calendar_day_holder .current_month").eq(0).parent();if(b.length===0){f.setDate(f.getDate()+1);r(g,1);b=$("#day_"+$.datepicker.formatDate("yy_mm_dd",f))}}else if(c=="left"){b=e.prev().find(".current_month").parent();if(b.length===0)b=e.parent().prev(".visible").find(".calendar_day_holder .current_month").filter(":last").parent();if(b.length===0){f.setDate(f.getDate()-
1);r(g,-1);b=$("#day_"+$.datepicker.formatDate("yy_mm_dd",f))}}else if(c=="up"){c=e.parent().children(".calendar_day_holder").index(e);b=e.parent().prev(".visible").children(".calendar_day_holder").eq(c).find(".current_month").parent();if(b.length===0){f.setDate(f.getDate()-7);r(g,-1);b=$("#day_"+$.datepicker.formatDate("yy_mm_dd",f))}}else if(c=="down"){c=e.parent().children(".calendar_day_holder").index(e);b=e.parent().next(".visible").children(".calendar_day_holder").eq(c).find(".current_month").parent();
if(b.length===0){f.setDate(f.getDate()+7);r(g,1);b=$("#day_"+$.datepicker.formatDate("yy_mm_dd",f))}}if(b&&b.length>0){b.focus();$(".calendar_container .calendar_day_holder.selected").removeClass("selected");$(".calendar_container .calendar_day.hover").removeClass("hover");$(".calendar_container .calendar_event.selected").removeClass("selected");b.addClass("selected");b.find(".calendar_day").addClass("hover");$("html,body").scrollTo(b)}}}function W(){$(".calendar_month").each(function(){$(this).data("days",
$(this).find(".calendar_day_holder"))})}function Q(c){var e=$("#event_details"),g=$.extend({},c.data("event_data")),b=g.context_type.toLowerCase()+"_"+g.context_id,f=i.t("prompts.delete_event","Are you sure you want to delete this event?");if(g.event_type=="assignment")f=i.t("prompts.delete_assignment","Are you sure you want to delete this assignment?");var h=$("."+b+"_event_url").attr("href");if(g.event_type=="assignment")h=$("."+b+"_assignment_url").attr("href");h=$.replaceTags(h,"id",g.id);c.confirmDelete({url:h,
message:f,confirmed:function(){e.dialog("close");$(this).dim()},success:function(){$(document).triggerHandler("delete_event");$(this).fadeOut(function(){$(this).remove();var a=c.attr("id").split("_").pop(),d=c.hasClass("assignment")?"assignment":"calendar_event";calendar.removeFromCache({asset_string:d+"_"+a})})}})}window.calendar={viewItem:function(){},showingUndatedEvents:false,appendToCache:function(c,e){var g={};l[c]=l[c]||[];$.each(e,function(b,f){var h=null;h=f.calendar_event?"calendar_event_"+
f.calendar_event.id:"assignment_"+f.assignment.id;g[h]=f});$.each(l[c],function(b,f){var h=null;h=f.calendar_event?"calendar_event_"+f.calendar_event.id:"assignment_"+f.assignment.id;if(g[h]){l[c][b]=g[h];g[h]=null}});$.each(g,function(b,f){f&&l[c].push(f)})},removeFromCache:function(c){for(var e in l){for(var g=$.merge([],l[e]),b=[],f=false,h=0;h<g.length;h++){var a=g[h].assignment?"assignment":"calendar_event";a=a+"_"+g[h][a].id;if(c.asset_string&&c.asset_string==a)f=true;else b.push(g[h])}if(f)l[e]=
b}},lastUpdate:{}};var K=null,O={helper:function(){var c=$(this).outerWidth(),e=$(this).clone();e.width(c).css("zIndex",20);$(this).parents(".calendar_container").append(e);return e},scroll:true,drag:function(c,e){if(!$.browser.msie){var g=n(c,e);if(!(g&&g.hasClass("drop_target"))){$(".drop_target").removeClass("drop_target");g&&g.closest(".calendar_day_holder,.mini_calendar_day").addClass("drop_target")}}},start:function(c){$(document).data("dragging",true);$(this).parents(".calendar_day_holder").addClass("selected");
if($(this).hasClass("event_pending")||!($(this).data("event_data")||{}).can_edit){c.preventDefault();c.stopPropagation();return false}setTimeout(o,50);$(this).addClass("event_pending")},stop:function(c,e){$(document).data("dragging",false);$("td.selected").removeClass("selected");$(".drop_target").removeClass("drop_target");var g=n(c,e),b=$(this);if(g&&g[0]!=b.parents(".calendar_day")[0]){var f=$.extend({},b.getTemplateData({textValues:["start_date_string","start_time_string","end_time_string","event_type",
"id","context_id","context_type","all_day"]}),b.data("event_data")),h=f.context_type.toLowerCase()+"_"+f.context_id,a,d,j=f.event_type;if(f.all_day=="true"){f.start_time_string="";f.end_time_string=""}if(g.hasClass("calendar_day_undated"))d=a=null;else{b.parents(".calendar_day").find(".day_number").attr("title");var q=g.find(".day_number").attr("title");a=$.parseDateTime(q,f.start_time_string);d=$.parseDateTime(q,f.end_time_string)}q=$("#context_urls ."+h+"_event_url").attr("href");if(j=="assignment"){f=
$.extend(f,$.formatDateTime(a,{object_name:"assignment",property_name:"due_at"}));q=$("#context_urls ."+h+"_assignment_url").attr("href")}else{f=$.extend(f,$.formatDateTime(a,{object_name:"calendar_event",property_name:"start_at"}));f=$.extend(f,$.formatDateTime(d,{object_name:"calendar_event",property_name:"end_at"}))}q=$.replaceTags(q,"id",f.id);var m=null;if(g.hasClass("mini_calendar_day")){m=g.find(".day_number").attr("title")||"";if(h=Date.parse(m))g=$("#day_"+h.toString("yyyy_MM_dd")).find(".calendar_day")}s(b,
g.parent());$.ajaxJSON(q,"PUT",f,function(p){b.removeClass("event_pending");v(p);k(p);if(!g.length&&m)$.flashMessage(i.t("notices.event_moved","%{event} was moved to %{day}",{event:b.find(".title").text()||i.t("default_title","event"),day:m}))})}else $(this).removeClass("event_pending")}},l={};$.fn.monthLoading=function(c){$.fn.monthLoading.cnt=Math.max($.fn.monthLoading.cnt||0,0);if(c)$.fn.monthLoading.cnt--;else $.fn.monthLoading.cnt++;this.find(".refresh_calendar_link").find(".static").showIf($.fn.monthLoading.cnt<=
0).end().find(".animated").showIf($.fn.monthLoading.cnt>0);return this};var S=$("#event_details").find(".calendar_event_url").attr("href"),T=$("#event_details").find(".assignment_url").attr("href"),V=$("#event_blank"),U=$(".show_undated_link .undated_count");$(document).ready(function(){$(".calendar_day.today").removeClass("today");$("#day_"+(new Date).toString("yyyy_MM_dd")).children(".calendar_day").addClass("today");$(".show_undated_link").click(function(a){a.preventDefault();calendar.showingUndatedEvents=
true;$(".undated_link").hide();events=(calendar.hiddenUndatedEvents||[]).sort(function(d,j){var q=(d.calendar_event||d.assignment||{}).title||"",m=(j.calendar_event||j.assignment||{}).title||"";return q<m?0:m>q?1:0});x(events||[],true);$(".undated_content").show()});$("#edit_calendar_event_form .more_options_link").click(function(a){a.preventDefault();a=$(this).attr("href").split("#");var d=$("#edit_calendar_event_form").getFormData({object_name:"calendar_event"}),j={};if(d.title)j.title=d.title;
if(d.date){j.start_at=d.date+" "+(d.start_time||"");j.end_at=d.date+" "+(d.end_time||"")}j.return_to=location.href;a[0]+="?"+$.param(j);location.href=a.join("#")});$(".calendar_event").live("mouseover",function(){!$(this).hasClass("ui-draggable")&&$(this).hasClass("draggable")&&$(this).draggable(O)});$("#edit_assignment_form .more_options_link").click(function(a){a.preventDefault();a=$(this).attr("href").split("#");var d=$("#edit_assignment_form").getFormData({object_name:"assignment"}),j={};if(d.title)j.title=
d.title;if(d.due_at)j.due_at=d.due_at;if(d.assignment_group_id)j.assignment_group_id=d.assignment_group_id;j.return_to=location.href;a[0]+="?"+$.param(j);location.href=a.join("#")});$(".calendar_feed_link").click(function(a){a.preventDefault();$("#calendar_feed_box").find(".calendar_feed_url").val($(this).attr("href")).end().find(".show_calendar_feed_link").attr("href",$(this).attr("href"));$("#calendar_feed_box").dialog("close").dialog({title:i.t("feed_dialog_title","Calendar Feed"),width:375,autoOpen:false}).dialog("open")});
$("#calendar_feed_box .calendar_feed_url").focus(function(){$(this).select()});$(".calendar_day_holder").focus(function(){$(".calendar_container .calendar_day.hover").removeClass("hover");$(".calendar_container .calendar_event.selected").removeClass("selected");$(this).find(".calendar_day").addClass("hover")});$(".calendar_event a").focus(function(){$(".calendar_container .calendar_day.hover").removeClass("hover");$(".calendar_container .calendar_event.selected").removeClass("selected");$(this).parents(".calendar_event").addClass("selected");
$(this).parents(".calendar_day").addClass("hover")});$("#edit_event select.context_id").change(function(a,d){var j=$(this).val(),q=$("#"+j+"_assignment_groups").clone(true).attr("id","temp_"+j+"_assignment_groups");attachAddAssignmentGroup(q,$("#context_urls ."+j+"_add_assignment_group_url").attr("href"));$(this).parents("form").find(".assignment_group_select").empty().append(q);q=$(this).parents("form");var m=q.data("event_id");z(q,j,m);d!==false&&$(this).parents("#edit_event").find("select.context_id").not($(this)).val($(this).val()).triggerHandler("change",
false);q=$(this).closest("#edit_event");q.data("group_class")&&q.removeClass(q.data("group_class"));q.addClass("group_"+j).data("group_class","group_"+j)});$("#edit_assignment_form .datetime_field, #edit_calendar_event_form .datetime_field").datetime_field();$("#edit_calendar_event_form .time_field").time_field().blur(function(){var a=$("#edit_calendar_event_form .time_field.start_time").next(".datetime_suggest").text();if($("#edit_calendar_event_form .time_field.start_time").next(".datetime_suggest").hasClass("invalid_datetime"))a=
null;a=a||$("#edit_calendar_event_form .time_field.start_time").val();var d=$("#edit_calendar_event_form .time_field.end_time").next(".datetime_suggest").text();if($("#edit_calendar_event_form .time_field.end_time").next(".datetime_suggest").hasClass("invalid_datetime"))d=null;d=d||$("#edit_calendar_event_form .time_field.end_time").val();a=Date.parse(a);d=Date.parse(d);a=a||d;d=d||a;if($(this).hasClass("end_time")){if(a>d)a=d}else if(d<a)d=a;a&&$("#edit_calendar_event_form .time_field.start_time").val(a.toString("h:mmtt").toLowerCase());
d&&$("#edit_calendar_event_form .time_field.end_time").val(d.toString("h:mmtt").toLowerCase())});$("#edit_calendar_event_form .date_field").date_field();$("#edit_event_form input[name='date']").datepicker();$(".calendar_month").delegate(".next_month_link","click",function(a){a.preventDefault();a=$(".calendar_month .month_name").text()+" "+$(".calendar_month .year_number").text();a=Date.parse(a)||new Date;a.setMonth(a.getMonth()+1);var d={};try{d=$.parseJSON($.decodeFromHex(location.hash.substring(1)))||
{}}catch(j){d={}}d.month=a.getMonth()+1;d.year=a.getFullYear();location.replace("#"+$.encodeToHex(JSON.stringify(d)))}).delegate(".prev_month_link","click",function(a){a.preventDefault();a=$(".calendar_month .month_name").text()+" "+$(".calendar_month .year_number").text();a=Date.parse(a)||new Date;a.setMonth(a.getMonth()-1);var d={};try{d=$.parseJSON($.decodeFromHex(location.hash.substring(1)))||{}}catch(j){d={}}d.month=a.getMonth()+1;d.year=a.getFullYear();location.replace("#"+$.encodeToHex(JSON.stringify(d)))});
var c=parseInt($("#max_calendar_count").text(),10)||10,e=function(){e.log=true};setInterval(function(){if(e.log){e.log=false;monthDataURL.replace("%25m",0).replace("%25y",0).replace(/&amp;/g,"&");var a=[];$(".calendar_links .group_reference_checkbox:checked").each(function(){var d=$(this).attr("id").substring(6);a.push(d)});$.store.userSet("checked_calendar_codes",a.join(","))}},1E3);$(".group_reference_checkbox").bind("change click",function(){var a=this;setTimeout(function(){$("."+$(a).attr("id")+
":not(.group_reference)").showIf($(a).attr("checked"));$(".calendar_links .group_reference_checkbox:checked").length>c&&$(".calendar_links .group_reference_checkbox:checked").not(a).filter(":first").attr("checked",false).change();$(a).attr("checked")&&I(true);e();$(".calendars_open_count").text($(".calendar_links .group_reference_checkbox:checked").length)},10)}).filter(":last").change();$(".calendar_container").delegate(".calendar_day","mouseover",function(a){if(!$(a.liveFired||$(this).parents(".calendar_container")).data("prevent_hover")){$(".calendar_day.hover").removeClass("hover");
$(this).addClass("hover");(a=$(this).find(".day_number").attr("title"))&&!$(document).data("dragging")&&$(".mini_calendar .day.date_"+a.replace(/\//g,"_")).addClass("related")}}).delegate(".calendar_day","mouseout",function(a){if(!$(a.liveFired||$(this).parents(".calendar_container")).data("prevent_hover")){$(this).removeClass("hover");(a=$(this).find(".day_number").attr("title"))&&$(".mini_calendar .day.date_"+a.replace(/\//g,"_")).removeClass("related")}});$(".mini_month").delegate(".next_month_link",
"mousedown",function(a){a.preventDefault();r($(a.liveFired||$(this).parents(".mini_month")),1)}).delegate(".prev_month_link","mousedown",function(a){a.preventDefault();r($(a.liveFired||$(this).parents(".mini_month")),-1)}).delegate(".next_month_link,.prev_month_link","click",function(a){a.preventDefault()}).delegate(".day_number","click",function(a){a.preventDefault();var d=$(this).attr("title");r($(a.liveFired||$(this).parents(".mini_month")),d);r($(".calendar_container .calendar_month"),d)});$(document).click(function(){var a=
$(this);$(".calendar_container .calendar_event.selected").each(function(){$(this).parent()[0]!=a[0]&&$(this).removeClass("selected")});$(".calendar_container .calendar_day_holder.selected").each(function(){$(this)[0]!=a.parent()[0]&&$(this).removeClass("selected")})});$(".calendar_event").live("click",function(a){a.preventDefault();a.stopPropagation();$(".calendar_day_holder.selected,.calendar_event.selected").removeClass("selected");B($(this),$(this).parents(".calendar_day"))});$(".calendar_container").delegate(".calendar_day",
"click",function(a){if(!($(a.target).closest(".calendar_event").length>0)){a.preventDefault();a.stopPropagation();if(canCreateEvent){w($("#event_blank"),$(this));var d=($(".group_reference_checkbox:checked:first").attr("id")||"").replace(/^group_/,"");d||(d=($(".group_reference.default_context").find(".group_reference_checkbox").attr("id")||"").replace(/^group_/,""));d&&$("#edit_event .context_select select.context_id").each(function(){$(this).val(d);if(this.selectedIndex<0)this.selectedIndex=0;$(this).triggerHandler("change",
false)})}}});$(document).delegate(".add_event_link","click",function(a){window.thisElementFiredTheEvent=this;a.preventDefault();w($("#event_blank"),$(this));a=($(this).closest(".group_reference").find(".group_reference_checkbox").attr("id")||"").replace("group_","");$("#edit_event .context_select select.context_id").val(a).triggerHandler("change",false);window.thisElementFiredTheEvent=undefined});$(document).keycodes([i.t("keycodes.next_day","ctrl+right"),i.t("keycodes.previous_day","ctrl+left"),
i.t("keycodes.next_week","ctrl+down"),i.t("keycodes.previous_week","ctrl+up")].join(" "),function(a){a.preventDefault();a.stopPropagation();var d;switch(a.keyString){case i.t("keycodes.next_day","ctrl+right"):d="right";break;case i.t("keycodes.previous_day","ctrl+left"):d="left";break;case i.t("keycodes.next_week","ctrl+down"):d="down";break;case i.t("keycodes.previous_week","ctrl+up"):d="up"}E(d)});$(document).keycodes([i.t("keycodes.next_event","j"),i.t("keycodes.previous_event","k"),i.t("keycodes.open",
"o"),i.t("keycodes.edit","e"),i.t("keycodes.delete","d"),i.t("keycodes.new","n"),i.t("keycodes.refresh","r")].join(" "),function(a){a.preventDefault();a.stopPropagation();var d=$(".calendar_event.selected:first"),j=$(".calendar_day_holder.selected:first");if(a.keyString==i.t("keycodes.next_event","j"))D("down");else if(a.keyString==i.t("keycodes.previous_event","k"))D("up");else if(a.keyString==i.t("keycodes.open","o"))d.click();else if(a.keyString==i.t("keycodes.delete","d"))d.length>0&&d.find(".can_delete").text()==
"true"&&Q(d);else if(a.keyString==i.t("keycodes.edit","e"))d.length>0&&d.find(".can_edit").text()=="true"&&w(d,j.children(".calendar_day"));else if(a.keyString==i.t("keycodes.new","n"))w($("#event_blank"),j.children(".calendar_day"));else a.keyString==i.t("keycodes.refresh","r")&&I()});$("#edit_calendar_event_form").formSubmit({object_name:"calendar_event",required:["title"],processData:function(a){if(a.start_time)if(!a.end_time)a.end_time=a.start_time;var d=Date.parse(a.date+" "+a.start_time);a.start_at=
"";a.end_at="";if(d){a.time_sortable=d.toString("HH:mm");a.event_date_string=d.toString("yyyy_MM_dd");a.start_at=$.datetime.process(d);a.start_time=d.toString("hh:mmtt").toLowerCase()}else{a.time_sortable="0";a.event_date_string=null}if(a.start_time&&!a.end_time)a.end_time=a.start_time;if(d=Date.parse(a.date+" "+a.end_time)){a.end_at=$.datetime.process(d);a.end_time=d.toString("hh:mmtt").toLowerCase()}a["calendar_event[start_at]"]=a.start_at;a["calendar_event[end_at]"]=a.end_at;return a},beforeSubmit:function(a){var d=
$(this).data("current_event");if(!d)return false;if(d.attr("id")=="event_blank"){d=d.clone(true).attr("id","event_new");d.draggable(O)}a=$.extend(a,$(this).getFormData({object_name:"calendar_event"}));a.start_time_string=a.start_time;a.end_time_string=a.end_time;a.event_type="calendar_event";d.fillTemplateData({data:a});var j=$(this).find("select.context_id").val();d.addClass("group_"+j);$("#group_"+j).attr("checked",true).change();d.find(".calendar_event_text").attr("title",a.title);d.addClass("event_pending");
j=$(".calendar_undated");if(a.event_date_string)j=$("#day_"+a.event_date_string);s(d,j);$("#edit_event").dialog("close");return d},success:function(a,d){d.removeClass("event_pending");$(document).triggerHandler("add_event",d);v(a,d);k(a)}});$("#edit_calendar_event_form input[name='date'],#edit_assignment_form input[name='date']").change(function(){$(".calendar_day.hover").removeClass("hover");$(".calendar_day_holder.selected").removeClass("selected");var a=$(this).val().split("/"),d=null;if(a.length==
3)d=a[2]+"_"+a[0]+"_"+a[1];d&&C($("#day_"+d))});$("#edit_assignment_form").formSubmit({object_name:"assignment",required:["title"],processData:function(a){var d=Date.parse(a.due_at);a.time_sortable="0";a.event_date_string="";a.start_time="";if(d){a["assignment[due_at]"]=$.datetime.process(d);a.time_sortable=d.toString("HH:mm");a.event_date_string=d.toString("yyyy_MM_dd");a.start_time=d.toString("hh:mmtt").toLowerCase()}a.start_time_string=a.start_time;a.end_time_string=a.start_time;a.event_type="assignment";
return a},beforeSubmit:function(a){var d=$(this).data("current_event");if(!d)return false;if(d.attr("id")=="event_blank"){d=d.clone(true).attr("id","event_new");d.draggable(O)}var j=$(this).find("select.context_id").val();d.addClass("group_"+j);$("#group_"+j).attr("checked",true).change();d.find(".calendar_event_text").attr("title",a.title);d.fillTemplateData({data:a});d.find(".calendar_event_text").attr("title",a.title);d.addClass("event_pending");s(d,$("#day_"+a.event_date_string));$("#edit_event").dialog("close");
return d},success:function(a,d){d.removeClass("event_pending");$(document).triggerHandler("add_event",d);v(a,d);k(a)}});$(".refresh_calendar_link").click(function(a){a.preventDefault();a=$(this).parents(".calendar_month");a.length>0?F(a):I()});$("#event_details").delegate(".edit_event_link","click",function(a){a.preventDefault();var d=$("#event_details");a=d.data("current_event");d=d.data("current_day");a&&d&&w(a,d)}).delegate(".delete_event_link","click",function(a){a.preventDefault();a=$("#event_details").data("current_event");
Q(a)});$(document).fragmentChange(function(a,d){if(d.indexOf("#calendar_event_")==0||d.indexOf("#assignment_")==0){var j="event_"+d.substring(1);j=$("#"+j);if(j.length>0){j.addClass("selected");$("html,body").scrollTo(j.parents(".calendar_day"));j.click()}}});$("#edit_event_tabs").tabs().bind("tabsselect",function(a,d){$(document).triggerHandler("event_tab_select",d.index);$(d.panel).find("select.context_id").triggerHandler("change")});var g=$.store.userGet("checked_calendar_codes");if(g){g=g.split(/,/);
var b=0,f;for(f in g){var h=$("#group_"+g[f]);h.attr("checked",true);h.length>0&&b++}b==0&&$(".group_reference .group_reference_checkbox:lt(10)").each(function(){$(this).attr("checked",true)})}else $(".group_reference .group_reference_checkbox:lt(10)").each(function(){$(this).attr("checked",true)});setTimeout(I,3E3);setInterval(I,6E5);setTimeout(W,1E3)});$(function(){$("#right-side").delegate(".group_reference","mouseenter mouseleave",function(c){$(this).find(".add_event_link").showIf(c.type==="mouseenter"&&
$(this).find(".group_reference_checkbox").attr("checked"))})});$(function(){$(document).fragmentChange(function(){var c=null;try{c=$.parseJSON($.decodeFromHex(document.location.hash.substring(1)))}catch(e){}if(c&&c.month&&parseInt(c.month,10)&&c.year&&parseInt(c.year,10)){var g=$(".calendar_month .month_name").text()+" "+$(".calendar_month .year_number").text();g=Date.parse(g)||new Date;var b=Date.parse(c.month+" "+c.year)||new Date;if(!(b.getMonth()==g.getMonth()&&b.getFullYear()==g.getFullYear())){g=
$.datepicker.formatDate("mm/dd/yy",b);r($(".calendar_month"),g);r($(".calendar_container").find(".mini_month"),g)}}if(c&&c.show){var f=c.show.split(","),h=!f&&!f.length,a=false,d=[];$(".group_reference_checkbox").each(function(){var j=this.checked;a=(this.checked=$.inArray($(this).attr("id"),f)>-1||h)||a;this.checked!=j&&d.push(this)});!a&&f!="nothing"&&$(".group_reference_checkbox").each(function(){var j=this.checked;this.checked=true;this.checked!=j&&d.push(this)});$.each(d,function(){$(this).triggerHandler("change",
"dontUpdateFragment")})}});$(".group_reference_checkbox").bind("change click",function(){setTimeout(function(){if(c==="dontUpdateFragment")return true;var c=null;try{c=$.parseJSON($.decodeFromHex(document.location.hash.substring(1)))}catch(e){}var g=[];$(".group_reference_checkbox:checked").each(function(){g.push($(this).attr("id"))});var b={};b.show=g.join(",")||"nothing";var f=$(".calendar_month:first .month_number").text(),h=$(".calendar_month:first .year_number").text();b.month=c&&c.month||f;
b.year=c&&c.year||h;location.replace("#"+$.encodeToHex(JSON.stringify(b)))},10)})})})(jQuery)});
var calendarMonths=function(){function i(n){return{day:n.getDate(),month:n.getMonth(),year:n.getFullYear()}}var o;I18n.scoped("calendars",function(n){o=n.t("#date.month_names")});return{changeMonth:function(n,s){n.data("calendar_objects");var r={},y=null;if(typeof s=="string")(y=$.datepicker.parseDate("mm/dd/yy",s))&&y.setDate(1);if(!y){var k=parseInt(n.find(".month_number").text(),10),x=parseInt(n.find(".year_number").text(),10);y=new Date(x,k+s-1,1)}r={month_name:o[y.getMonth()+1],month_number:y.getMonth()+
1,year_number:y.getFullYear()};n.fillTemplateData({data:r});k=new Date;r=i(k);var F=i(y);k=y;k.setDate(0);k.setDate(k.getDate()-k.getDay());x=i(k);var v=null;if(F.day!=x.day){k.setDate(1);k.setMonth(k.getMonth()+1);k.setDate(0);v={day:k.getDate(),month:x.month,year:x.year};k.setDate(1);k.setMonth(k.getMonth()+1)}k.setMonth(y.getMonth()+1);k.setDate(0);y={day:k.getDate(),month:F.month,year:F.yearh};k.setDate(k.getDate()+1);k.setDate(k.getDate()+(6-k.getDay()));k.setDate(k.getDate()+7);var I=i(k),B=
n.data("days");if(!B){B=n.find(".calendar_day_holder");n.data("days",B)}if(n.hasClass("mini_month"))B=n.find(".day");n.find(".calendar_event").remove();var C=0,A=x.day;k=x.month;for(x=x.year;A<=I.day||k!=I.month;){var z=B.eq(C);if(z.length>0){for(var w=z.attr("class").split(" "),D=[],E=0;E<w.length;E++)w[E].indexOf("date_")!=0&&D.push(w[E]);z.attr("class",D.join(" "))}z.show().addClass("visible").parents("tr").show().addClass("visible");w=k<9?"0"+(k+1):k+1;D=A<10?"0"+A:A;id="day_"+x+"_"+w+"_"+D;if(n.hasClass("mini_month"))id=
"mini_"+id;z.attr("id",id).find(".day_number").text(A).attr("title",w+"/"+D+"/"+x).addClass("date_"+w+"_"+D+"_"+x);w=z.children("div");if(n.hasClass("mini_month"))w=z;w.removeClass("current_month other_month today");k==F.month?w.addClass("current_month"):w.addClass("other_month");k==r.month&&A==r.day&&x==r.year&&w.addClass("today");A++;C++;if(v&&A>v.day&&k==v.month||A>y.day&&k==y.month){k+=1;if(k>=12){k-=12;x++}A=1}}for(;C<B.length;){z=B.eq(C);z.parents("tr").hide().removeClass("visible");z.hide().removeClass("visible");
C++}n.hasClass("mini_month")}}}();
I18n.scoped("content_locks",function(i){INST.lockExplanation=function(o,n){if(o.lock_at)switch(n){case "quiz":return i.t("messages.quiz_locked_at","This quiz was locked %{at}.",{at:$.parseFromISO(o.lock_at).datetime_formatted});case "assignment":return i.t("messages.assignment_locked_at","This assignment was locked %{at}.",{at:$.parseFromISO(o.lock_at).datetime_formatted});case "topic":return i.t("messages.topic_locked_at","This topic was locked %{at}.",{at:$.parseFromISO(o.lock_at).datetime_formatted});case "file":return i.t("messages.file_locked_at",
"This file was locked %{at}.",{at:$.parseFromISO(o.lock_at).datetime_formatted});case "page":return i.t("messages.page_locked_at","This page was locked %{at}.",{at:$.parseFromISO(o.lock_at).datetime_formatted});default:return i.t("messages.content_locked_at","This content was locked %{at}.",{at:$.parseFromISO(o.lock_at).datetime_formatted})}else if(o.unlock_at)switch(n){case "quiz":return i.t("messages.quiz_locked_until","This quiz is locked until %{date}.",{date:$.parseFromISO(o.unlock_at).datetime_formatted});
case "assignment":return i.t("messages.assignment_locked_until","This assignment is locked until %{date}.",{date:$.parseFromISO(o.unlock_at).datetime_formatted});case "topic":return i.t("messages.topic_locked_until","This topic is locked until %{date}.",{date:$.parseFromISO(o.unlock_at).datetime_formatted});case "file":return i.t("messages.file_locked_until","This file is locked until %{date}.",{date:$.parseFromISO(o.unlock_at).datetime_formatted});case "page":return i.t("messages.page_locked_until",
"This page is locked until %{date}.",{date:$.parseFromISO(o.unlock_at).datetime_formatted});default:return i.t("messages.content_locked_until","This content is locked until %{date}.",{date:$.parseFromISO(o.unlock_at).datetime_formatted})}else if(o.context_module){var s="";switch(n){case "quiz":s+=i.t("messages.quiz_locked_module","This quiz is part of the module *%{module}* and hasn't been unlocked yet.",{module:$.htmlEscape(o.context_module.name),wrapper:"<b>$1</b>"});break;case "assignment":s+=
i.t("messages.assignment_locked_module","This assignment is part of the module *%{module}* and hasn't been unlocked yet.",{module:$.htmlEscape(o.context_module.name),wrapper:"<b>$1</b>"});break;case "topic":s+=i.t("messages.topic_locked_module","This topic is part of the module *%{module}* and hasn't been unlocked yet.",{module:$.htmlEscape(o.context_module.name),wrapper:"<b>$1</b>"});break;case "file":s+=i.t("messages.file_locked_module","This file is part of the module *%{module}* and hasn't been unlocked yet.",
{module:$.htmlEscape(o.context_module.name),wrapper:"<b>$1</b>"});break;case "page":s+=i.t("messages.page_locked_module","This page is part of the module *%{module}* and hasn't been unlocked yet.",{module:$.htmlEscape(o.context_module.name),wrapper:"<b>$1</b>"});break;default:s+=i.t("messages.content_locked_module","This content is part of the module *%{module}* and hasn't been unlocked yet.",{module:$.htmlEscape(o.context_module.name),wrapper:"<b>$1</b>"})}if($("#context_modules_url").length>0){s+=
"<br/>";s+="<a href='"+$("#context_modules_url").attr("href")+"'>";s+=i.t("messages.visit_modules_page_for_details","Visit the modules page for information on how to unlock this content.");s+="</a>";return s}}else switch(n){case "quiz":return i.t("messages.quiz_locked_no_reason","This quiz is locked.  No other reason has been provided.");case "assignment":return i.t("messages.assignment_locked_no_reason","This assignment is locked.  No other reason has been provided.");case "topic":return i.t("messages.topic_locked_no_reason",
"This topic is locked.  No other reason has been provided.");case "file":return i.t("messages.file_locked_no_reason","This file is locked.  No other reason has been provided.");case "page":return i.t("messages.page_locked_no_reason","This page is locked.  No other reason has been provided.");default:return i.t("messages.content_locked_no_reason","This content is locked.  No other reason has been provided.")}};$(document).ready(function(){$(".content_lock_icon").live("click",function(o){if($(this).data("lock_reason")){o.preventDefault();
var n=$(this).data("lock_reason"),s=n.type;o=$("<div/>");o.html(INST.lockExplanation(n,s));var r=$("#lock_reason_dialog");if(r.length===0){r=$("<div/>").attr("id","lock_reason_dialog");$("body").append(r.hide());n="<div class='lock_reason_content'></div><div class='button-container'><button type='button' class='button'>"+$.h(i.t("buttons.ok_thanks","Ok, Thanks"))+"</button></div>";r.append(n);r.find(".button-container .button").click(function(){r.dialog("close")})}r.find(".lock_reason_content").empty().append(o);
r.dialog("close").dialog({autoOpen:false,title:i.t("titles.content_is_locked","Content Is Locked")}).dialog("open")}})})});
$.extend(true,I18n=I18n||{},{translations:{es:{content_locks:{buttons:{ok_thanks:"Ok, Gracias"},messages:{page_locked_no_reason:"Esta p\u00e1gina est\u00e1 bloqueada. No se ha provisto otra raz\u00f3n.",assignment_locked_no_reason:"Esta tarea esta bloqueada. No se ha provisto otra raz\u00f3n.",content_locked_no_reason:"Este contenido est\u00e1 bloqueado. No se ha provisto otra raz\u00f3n.",file_locked_until:"Este archivo ha sido bloqueado hasta %{date}.",page_locked_at:"Esta p\u00e1gina fue bloqueado en %{at}.",
quiz_locked_module:"Esta evaluaci\u00f3n es parte del m\u00f3dulo *%{module}* y a\u00fan no ha sido desbloqueado.",page_locked_until:"Esta p\u00e1gina est\u00e1 bloqueada hasta %{date}.",assignment_locked_at:"Esta tarea fue bloqueada en %{at}.",topic_locked_at:"Este tema fue bloqueado en %{at}.",content_locked_at:"Este contenido fue bloqueado en %{at}.",topic_locked_until:"Este tema est\u00e1 bloqueado hasta %{date}.",quiz_locked_no_reason:"Esta evaluaci\u00f3n est\u00e1 bloqueada. No se ha provisto otra raz\u00f3n.",
content_locked_until:"Este contenido est\u00e1 bloqueado hasta %{date}.",assignment_locked_module:"Esta tarea es parte del m\u00f3dulo *%{module}* y a\u00fan no ha sido desbloqueada.",topic_locked_module:"Este tema es parte del m\u00f3dulo *%{module}* y a\u00fan no ha sido desbloqueado.",file_locked_no_reason:"Este archivo est\u00e1 bloqueado. No se ha provisto otra raz\u00f3n.",file_locked_at:"Este archivo fue bloqueado en %{at}.",visit_modules_page_for_details:"Visite la p\u00e1gina de los m\u00f3dulos para informaci\u00f3n de c\u00f3mo desbloquear este contenido.",
quiz_locked_at:"Esta evaluaci\u00f3n fue bloqueada en %{at}.",page_locked_module:"Esta p\u00e1gina es parte del m\u00f3dulo *%{module}* y a\u00fan no ha sido desbloqueado.",file_locked_module:"Este archivo es parte del m\u00f3dulo *%{module}* y no ha sido desbloqueado a\u00fan.",assignment_locked_until:"Esta tarea est\u00e1 bloqueada hasta %{date}.",content_locked_module:"Este contenido es parte del m\u00f3dulo *%{module}* y a\u00fan no ha sido desbloqueado.",topic_locked_no_reason:"Este tema est\u00e1 bloqueado. No se ha provisto otra raz\u00f3n.",
quiz_locked_until:"Esta evaluaci\u00f3n est\u00e1 bloqueada hasta %{date}."},titles:{content_is_locked:"El Contenido est\u00e1 Bloqueado"}},calendars:{keycodes:{previous_day:"ctrl + izquierda","new":"n",edit:"e",open:"o","delete":"d",next_day:"ctrl + derecha",next_event:"j",refresh:"r",next_week:"ctrl + abajo",previous_week:"ctrl + arriba",previous_event:"k"},feed_dialog_title:"Canal del Calendario",prompts:{delete_assignment:"\u00bfEst\u00e1 seguro que quiere borrar esta tarea?",delete_event:"\u00bfEst\u00e1 seguro que quiere borrar este evento?"},
titles:{add_new_event:"Agregar Evento Nuevo",add_new_assignment:"Agregar Tarea Nueva",edit_assignment:"Editar la Tarea",edit_event:"Editar el Evento"},assignment_details:"Detalles de la Tarea",notices:{event_moved:"%{event} fue movido a %{day}"},default_title:"evento",event_details:"Detalles del Evento"}},em2:{content_locks:{messages:{quiz_locked_module:"This assessment is part of the module *%{module}* and hasn't been unlocked yet.",quiz_locked_no_reason:"This assessment is locked.  No other reason has been provided.",
quiz_locked_at:"This assessment was locked %{at}.",quiz_locked_until:"This assessment is locked until %{date}."}}}}});
