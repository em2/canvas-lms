I18n.scoped("grading_standards",function(i){$(document).ready(function(){$(".add_standard_link").click(function(a){a.preventDefault();a=$("#grading_standard_blank").clone(true).attr("id","grading_standard_new");$("#standards").append(a.show());a.find(".edit_grading_standard_link").click()});$(".edit_letter_grades_link").click(function(a){a.preventDefault();$("#edit_letter_grades_form").dialog("close").dialog({title:i.t("titles.grading_scheme_info","View/Edit Grading Scheme"),autoOpen:false,width:600,
height:310}).dialog("open")});$(".grading_standard .delete_grading_standard_link").click(function(a){a.preventDefault();a=$(this).parents(".grading_standard");var b=a.find(".update_grading_standard_url").attr("href");a.confirmDelete({url:b,message:i.t("confirm.delete_grading_scheme","Are you sure you want to delete this grading scheme?"),success:function(){$(this).slideUp(function(){$(this).remove()})},error:function(){$.flashError(i.t("errors.cannot_delete_grading_scheme","There was a problem deleting this grading scheme"))}})});
$(".grading_standard .remove_grading_standard_link").click(function(a){function b(){$("#edit_assignment_form .grading_standard_id").val("");$("#assignment_grading_type").val("points").change();$("#course_grading_standard_enabled").attr("checked",false).change();$("#course_form .grading_scheme_set").text(i.t("grading_scheme_not_set","Not Set"));e.addClass("editing");e.find(".update_grading_standard_url").attr("href",$("#update_grading_standard_url").attr("href"));var f={title:"",id:null,data:$.parseJSON($("#default_grading_standard_data").val())};
e.fillTemplateData({data:f,id:"grading_standard_blank",avoid:".find_grading_standard",hrefValues:["id"]}).find(".edit_grading_standard_link").removeClass("read_only");e.triggerHandler("grading_standard_updated",f);$("#edit_letter_grades_form").dialog("close");e.undim()}a.preventDefault();if(!confirm(i.t("confirm.unlink_grading_scheme","Are you sure you want to unlink this grading scheme?")))return false;var e=$(this).parents(".grading_standard");e.dim();a={"assignment[grading_standard_id]":"","assignment[grading_type]":"points"};
var c=$("#edit_assignment_form").attr("action");if($("#update_course_url").length){a={"course[grading_standard_id]":""};c=$("#update_course_url").attr("href")}else if(c&&c.match(/assignments$/))c=null;c?$.ajaxJSON(c,"PUT",a,b,function(){$.flashError(i.t("errors.cannot_remove_grading_scheme","There was a problem removing this grading scheme.  Please reload the page and try again."))}):b()});$(".grading_standard .edit_grading_standard_link").click(function(a){a.preventDefault();var b=$(this).parents(".grading_standard");
b.addClass("editing");$(this).hasClass("read_only")&&b.attr("id","grading_standard_blank");b.find(".grading_standard_row").each(function(){var e=$(this).getTemplateData({textValues:["min_score","name"]});$(this).find(".standard_value").val(e.min_score).end().find(".standard_name").val(e.name)});$("#standards").ifExists(function(){$("html,body").scrollTo(b)});b.find(":text:first").blur().focus().select()});$(".grading_standard .grading_standard_brief").find(".collapse_data_link,.expand_data_link").click(function(a){a.preventDefault();
a=$(this).parents(".grading_standard_brief");a.find(".collapse_data_link,.expand_data_link").toggle();a.find(".details").slideToggle()});$(".grading_standard_select").live("click",function(a){a.preventDefault();a=$(this).getTemplateData({textValues:["id"]}).id;$(".grading_standard .grading_standards_select .grading_standard_select").removeClass("selected_side_tab");$(this).addClass("selected_side_tab");$(".grading_standard .grading_standards .grading_standard_brief").hide();$("#grading_standard_brief_"+
a).show()});$(".grading_standard").find(".find_grading_standard_link,.cancel_find_grading_standard_link").click(function(a){a.preventDefault();$(this).parents(".grading_standard").find(".display_grading_standard,.find_grading_standard").toggle();var b=$(this).parents(".grading_standard").find(".find_grading_standard:visible");if(b.length>0&&!b.hasClass("loaded")){b.find(".loading_message").text(i.t("status.loading_grading_standards","Loading Grading Standards..."));a=b.find(".grading_standards_url").attr("href");
$.ajaxJSON(a,"GET",{},function(e){if(e.length===0)b.find(".loading_message").text(i.t("no_grading_standards","No grading standards found"));else{b.find(".loading_message").remove();for(var c in e){var f=e[c].grading_standard;f.user_name=f.display_name;var d=b.find(".grading_standards_select .grading_standard_select.blank:first").clone(true);d.fillTemplateData({data:f}).data("context_code",f.context_code).removeClass("blank");b.find(".grading_standards_select").append(d.show());d=b.find(".grading_standard_brief.blank:first").clone(true);
d.fillTemplateData({data:f,id:"grading_standard_brief_"+f.id}).data("context_code",f.context_code);d.removeClass("blank");for(var h=0;h<f.data.length;h++){var g=f.data[h];g={name:g[0],value:h==0?100:"< "+f.data[h-1][1]*100,next_value:g[1]*100};var j=d.find(".details_row.blank:first").clone(true);j.removeClass("blank");j.fillTemplateData({data:g});d.find(".details > table").append(j.show())}b.find(".grading_standards").append(d)}b.find(".grading_standards_select .grading_standard_select:visible:first a:first").click()}b.addClass("loaded");
b.find(".grading_standards_holder").slideDown()},function(){b.find(".loading_message").text(i.t("errors.cannot_load_grading_standards","Loading Grading Standards Failed.  Please Try Again"))})}});$(".grading_standard .grading_standard_brief .select_grading_standard_link").click(function(a){a.preventDefault();a=$(this).parents(".grading_standard_brief").getTemplateData({textValues:["id","title"],dataValues:["context_code"]});var b=a.id,e=a.title,c=[];$(this).parents(".grading_standard_brief").find(".details_row:not(.blank)").each(function(){var f=
$(this).find(".name").text(),d=parseFloat($(this).find(".next_value").text())/100;if(isNaN(d))d="";c.push([f,d])});$(this).parents(".grading_standard").triggerHandler("grading_standard_updated",{id:b,data:c,title:e});b=$("#edit_letter_grades_form").data().context_code;$(this).parents(".grading_standard").find(".edit_grading_standard_link").toggleClass("read_only",b!=a.context_code);$(this).parents(".find_grading_standard").find(".cancel_find_grading_standard_link").click()});$(".grading_standard .cancel_button").click(function(){$(this).parents(".grading_standard").removeClass("editing").find(".insert_grading_standard").hide();
var a=$(this).parents(".grading_standard");a.find(".to_add").remove();a.find(".to_delete").removeClass("to_delete").show();a.attr("id")=="grading_standard_new"&&a.remove()});$(".grading_standard").bind("grading_standard_updated",function(a,b){var e=$(this);e.addClass("editing");e.find(".update_grading_standard_url").attr("href",$("#update_grading_standard_url").attr("href"));e.fillTemplateData({data:b,id:"grading_standard_"+(b.id||"blank"),avoid:".find_grading_standard",hrefValues:["id"]}).fillFormData(b,
{object_name:"grading_standard"});var c=e.find(".insert_grading_standard:first").clone(true),f=e.find(".grading_standard_row:first").clone(true).removeClass("blank"),d=e.find(".grading_standard_data");d.empty();d.append(c.clone(true).show());for(var h in b.data){var g=f.clone(true),j=b.data[h];g.removeClass("to_delete").removeClass("to_add");g.find(".standard_name").val(j[0]).attr("name","grading_standard[standard_data][scheme_"+h+"][name]").end().find(".standard_value").val(j[1]*100).attr("name",
"grading_standard[standard_data][scheme_"+h+"][value]");d.append(g.show());d.append(c.clone(true).show())}d.find(":text:first").blur();d.append(f.hide());d.append(c.hide());e.find(".grading_standard_row").each(function(){$(this).find(".name").text($(this).find(".standard_name").val()).end().find(".min_score").text($(this).find(".standard_value").val()).end().find(".max_score").text($(this).find(".edit_max_score").text())});e.removeClass("editing");e.find(".insert_grading_standard").hide();if(b.id){e.find(".remove_grading_standard_link").removeClass("read_only");
e={"assignment[grading_standard_id]":b.id,"assignment[grading_type]":"letter_grade"};c=$("#edit_assignment_form").attr("action");$("#edit_assignment_form .grading_standard_id").val(b.id);if($("#update_course_url").length){e={"course[grading_standard_id]":b.id};c=$("#update_course_url").attr("href")}else if(c&&c.match(/assignments$/))c=null;c&&$.ajaxJSON(c,"PUT",e,function(k){$("#course_form .grading_scheme_set").text(k&&k.course&&k.course.grading_standard_title||i.t("grading_scheme_currently_set",
"Currently Set"))},function(){})}else e.find(".remove_grading_standard_link").addClass("read_only")});$(".grading_standard .save_button").click(function(){var a=$(this).parents(".grading_standard"),b=$("#edit_letter_grades_form .create_grading_standard_url,#create_grading_standard_url").attr("href"),e="POST";if(a.attr("id")!="grading_standard_blank"&&a.attr("id")!="grading_standard_new"){b=$(this).parents(".grading_standard").find(".update_grading_standard_url").attr("href");e="PUT"}var c=a.find(".standard_title,.grading_standard_row:visible").getFormData();
a.find("button").attr("disabled",true).filter(".save_button").text(i.t("status.saving","Saving..."));$.ajaxJSON(b,e,c,function(f){f=f.grading_standard;a.find("button").attr("disabled",false).filter(".save_button").text(i.t("buttons.save","Save"));a.triggerHandler("grading_standard_updated",f)},function(){a.find("button").attr("disabled",false).filter(".save_button").text(i.t("errors.save_failed","Save Failed"))})});$(".grading_standard thead").mouseover(function(){if($(this).parents(".grading_standard").hasClass("editing")){$(this).parents(".grading_standard").find(".insert_grading_standard").hide();
$(this).parents(".grading_standard").find(".insert_grading_standard:first").show()}});$(".grading_standard .grading_standard_row").mouseover(function(a){if($(this).parents(".grading_standard").hasClass("editing")){$(this).parents(".grading_standard").find(".insert_grading_standard").hide();a=a.pageY;var b=$(this).offset(),e=$(this).height();a>b.top+e/2?$(this).next(".insert_grading_standard").show():$(this).prev(".insert_grading_standard").show()}});$(".grading_standard .insert_grading_standard_link").click(function(a){a.preventDefault();
if(!($(this).parents(".grading_standard").find(".grading_standard_row").length>40)){a=$(this).parents(".grading_standard");for(var b=a.find(".grading_standard_row:first").clone(true).removeClass("blank"),e=a.find(".insert_grading_standard:first").clone(true),c=null;!c||$(".standard_name[name='grading_standard[standard_data][scheme_"+c+"][name]']").length>0;)c=Math.round(Math.random()*1E4);b.find(".standard_name").val("-").attr("name","grading_standard[standard_data][scheme_"+c+"][name]");b.find(".standard_value").attr("name",
"grading_standard[standard_data][scheme_"+c+"][value]");$(this).parents(".insert_grading_standard").after(b.show());b.after(e);a.find(":text:first").blur();b.find(":text:first").focus().select();b.addClass("to_add")}});$(".grading_standard .delete_row_link").click(function(a){a.preventDefault();if(!($(this).parents(".grading_standard").find(".grading_standard_row:visible").length<2)){a=$(this).parents(".grading_standard_row");a.prev(".insert_grading_standard").length>0?a.prev(".insert_grading_standard").remove():
a.next(".insert_grading_standard").remove();a.fadeOut(function(){$(this).addClass("to_delete");$(".grading_standard input[type='text']:first").triggerHandler("change")})}});$(".grading_standard input[type='text']").bind("blur change",function(){var a=$(this).parents(".grading_standard"),b=parseFloat($(this).parents(".grading_standard_row").find(".standard_value").val());b=Math.round(b*10)/10;$(this).parents(".grading_standard_row").find(".standard_value").val(b);if(isNaN(b))b=null;var e=b||100;b=
b||0;var c=a.find(".grading_standard_row:not(.blank,.to_delete)");for(a=c.index($(this).parents(".grading_standard_row"))+1;a<c.length;a++){var f=c.eq(a),d=parseFloat(f.find(".standard_value").val());if(isNaN(d))d=null;if(a==c.length-1)d=0;else if(!d||d>e-0.1)d=parseInt(e)-1;f.find(".standard_value").val(d);e=d}for(a=c.index($(this).parents(".grading_standard_row"))-1;a>=0;a--){f=c.eq(a);d=parseFloat(f.find(".standard_value").val());if(isNaN(d))d=null;if(a==c.length-1)d=0;else if(!d||d<b+0.1)d=parseInt(b)+
1;b=d;f.find(".standard_value").val(d)}e=100;c.each(function(h){var g=parseFloat($(this).find(".standard_value").val());h=c.index(this);if(isNaN(g))g=null;if(h==c.length-1)g=0;else if(!g||g>e-0.1)g=parseInt(e)-1;$(this).find(".standard_value").val(g);e=g});b=0;for(a=c.length-1;a>=0;a--){f=c.eq(a);d=parseFloat(f.find(".standard_value").val());if(isNaN(d))d=null;if(a==c.length-1)d=0;else if(!d||d<b+0.1)d=parseInt(b)+1;b=d;f.find(".standard_value").val(d)}c.each(function(h){h=c.eq(h-1);var g=0;if(h&&
h.length>0){g=parseFloat(h.find(".standard_value").val());if(isNaN(g))g=0;$(this).find(".edit_max_score").text("< "+g)}});c.filter(":first").find(".edit_max_score").text(100)})})});
$.extend(true,I18n=I18n||{},{translations:{es:{grading_standards:{grading_scheme_not_set:"No Establecido",buttons:{save:"Guardar"},no_grading_standards:"No se encontraron estandares de calificaci\u00f3n",confirm:{delete_grading_scheme:"\u00bfSeguro que quiere borrar este esquema de calificaci\u00f3n?",unlink_grading_scheme:"\u00bfSeguro que quiere desenlazar este esquema de calificaci\u00f3n?"},errors:{save_failed:"Guardado Fall\u00f3",cannot_delete_grading_scheme:"Hubo un problema borrando este esquema de calificaci\u00f3n",
cannot_remove_grading_scheme:"Hubo un problema removiendo este esquema de calificaci\u00f3n. Por favor recargue la p\u00e1gina e intente de nuevo.",cannot_load_grading_standards:"Fall\u00f3 la Carga de Estandares de Calificaci\u00f3n. Intente de Nuevo."},titles:{grading_scheme_info:"Ver/Editar Esquema de Calificaci\u00f3n"},grading_scheme_currently_set:"Establecido Actualmente",status:{saving:"Guardando...",loading_grading_standards:"Cargando los Estandares de Calificaci\u00f3n..."}}}}});
