I18n.scoped("sis_import",function(c){$(document).ready(function(){function j(){r.showIf(k.attr("checked"));s.showIf(k.attr("checked"));l.disableIf(m.attr("checked"));m.disableIf(l.attr("checked"))}function o(a){var d="";if(a.processing_errors&&a.processing_errors.length>0){d+="<li>"+c.t("headers.import_errors","Errors that prevent importing")+"\n<ul>";for(var f in a.processing_errors){var b=a.processing_errors[f];d+="<li>"+$.htmlEscape(b[0])+" - "+$.htmlEscape(b[1])+"</li>"}d+="</ul>\n</li>"}if(a.processing_warnings&&
a.processing_warnings.length>0){d+="<li>"+c.t("headers.import_warnings","Warnings")+"\n<ul>";for(f in a.processing_warnings){b=a.processing_warnings[f];d+="<li>"+$.htmlEscape(b[0])+" - "+$.htmlEscape(b[1])+"</li>"}d+="</ul>\n</li>"}d+="</ul>";return d}function p(a){if(!(a.data&&a.data.counts))return"";output="<ul><li>"+c.t("headers.imported_items","Imported Items")+"<ul>";output+="<li>"+c.t("import_counts.accounts","Accounts: %{account_count}",{account_count:a.data.counts.accounts})+"</li>";output+=
"<li>"+c.t("import_counts.terms","Terms: %{term_count}",{term_count:a.data.counts.terms})+"</li>";output+="<li>"+c.t("import_counts.courses","Courses: %{course_count}",{course_count:a.data.counts.courses})+"</li>";output+="<li>"+c.t("import_counts.sections","Sections: %{section_count}",{section_count:a.data.counts.sections})+"</li>";output+="<li>"+c.t("import_counts.users","Users: %{user_count}",{user_count:a.data.counts.users})+"</li>";output+="<li>"+c.t("import_counts.enrollments","Enrollments: %{enrollment_count}",
{enrollment_count:a.data.counts.enrollments})+"</li>";output+="<li>"+c.t("import_counts.crosslists","Crosslists: %{crosslist_count}",{crosslist_count:a.data.counts.xlists})+"</li>";output+="</ul></li></ul>";return output}function n(){$("#sis_importer").html(c.t("status.processing","Processing")+" <div style='font-size: 0.6em;'>"+c.t("notices.processing_takes_awhile","this may take a bit...")+"</div>").attr("disabled",true);$(".instruction").hide();$(".progress_bar_holder").slideDown();$(".copy_progress").progressbar();
g="nothing";var a=0,d=function(){if(g=="nothing"){a++;var b=($(".copy_progress").progressbar("option","value")||0)+0.25;a<10&&$(".copy_progress").progressbar("option","value",b);setTimeout(d,2E3)}else{g="nothing";a=0;setTimeout(d,1E4)}},f=function(){$.ajaxJSON(location.href,"GET",{},function(b){g="updating";b=b.sis_batch;var i=0;if(b){i=Math.max($(".copy_progress").progressbar("option","value")||0,b.progress);$(".copy_progress").progressbar("option","value",i);$("#import_log").empty();if(b.sis_batch_log_entries)for(var e in b.sis_batch_log_entries){var h=
b.sis_batch_log_entries[e].sis_batch_log_entry;i=h.text.split("\\n");if($("#import_log #log_"+h.id).length==0){h=$("<div id='log_"+h.id+"'/>");for(var t in i){var q=$("<div/>");q.text(i[t]);h.append(q)}$("#import_log").append(h)}}}if(!b||b.workflow_state=="imported"){$("#sis_importer").hide();$(".copy_progress").progressbar("option","value",100);$(".progress_message").html(c.t("messages.import_complete_success","The import is complete and all records were successfully imported.")+p(b))}else if(b.workflow_state==
"failed"){code="sis_batch_"+b.id;$(".progress_bar_holder").hide();$("#sis_importer").hide();e=c.t("errors.import_failed_code",'There was an error importing your SIS data. No records were imported.  Please notify your system administrator and give them the following code: "%{code}"',{code:code});$(".sis_messages .error_message").html(e);$(".sis_messages").show()}else if(b.workflow_state=="failed_with_messages"){$(".progress_bar_holder").hide();$("#sis_importer").hide();e=c.t("errors.import_failed_messages",
"No SIS records were imported. The import failed with these messages:");e+=o(b);$(".sis_messages .error_message").html(e);$(".sis_messages").show()}else if(b.workflow_state=="imported_with_messages"){$(".progress_bar_holder").hide();$("#sis_importer").hide();e=c.t("messages.import_complete_warnings","The SIS data was imported but with these messages:");e+=o(b);e+=p(b);$(".sis_messages").show().html(e)}else setTimeout(f,1500)},function(){setTimeout(f,3E3)})};setTimeout(f,2E3);setTimeout(d,1E3)}var g=
"nothing";$("#batch_mode").change(function(){$("#batch_mode_term_id").showIf($(this).attr("checked"))}).change();var k=$("#override_sis_stickiness"),l=$("#add_sis_stickiness"),m=$("#clear_sis_stickiness"),r=$("#add_sis_stickiness_container"),s=$("#clear_sis_stickiness_container");k.change(j);l.change(j);m.change(j);j(null);$("#sis_importer").formSubmit({fileUpload:true,success:function(a){if(a&&a.sis_batch)n();else{$(".sis_messages .error_message").text(a.error_message);$(".sis_messages").show();
a.batch_in_progress&&n()}},error:function(a){$(this).find(".submit_button").attr("disabled",false).text(c.t("buttons.process_data","Process Data"));$(this).formErrors(a)}});(function(){g="checking";$.ajaxJSON(location.href,"GET",{},function(a){g="nothing";if((a=a.sis_batch)&&(a.workflow_state=="importing"||a.workflow_state=="created")){g="nothing";n()}})})()})});
$.extend(true,I18n=I18n||{},{translations:{es:{sis_import:{messages:{import_complete_success:"La importaci\u00f3n est\u00e1 completa y todos los registros fueron importados con \u00e9xito.",import_complete_warnings:"La informaci\u00f3n de SIS fue importada pero con estos mensajes:"},buttons:{process_data:"Procesar la Informaci\u00f3n"},errors:{import_failed_messages:"No se pudieron importar los registros de SIS. La importaci\u00f3n fall\u00f3 con estos mensajes:",import_failed_code:'Ocurri\u00f3 un error al importar su informaci\u00f3n de SIS. No se importaron registros. Por favor notifique al administrador de su sistema y proveales el siguiente c\u00f3digo: "%{code}"'},
notices:{processing_takes_awhile:"esto puede tomar un tiempo..."},import_counts:{crosslists:"Lista Cruzadas: %{crosslist_count}",courses:"Cursos: %{course_count}",sections:"Secciones: %{section_count}",accounts:"Cuentas: %{account_count}",enrollments:"Inscripciones: %{enrollment_count}",users:"Usuarios: %{user_count}",terms:"Per\u00edodos: %{term_count}"},status:{processing:"Procesando"},headers:{import_errors:"Errores que previenen la importaci\u00f3n",imported_items:"Elementos Importados",import_warnings:"Alertas"}}}}});
