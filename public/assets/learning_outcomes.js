I18n.scoped("learning_outcomes",function(h){var d={ratingCounter:0,updateOutcome:function(a,b){if(!b||b.length===0)b=$("#outcome_"+a.id);if(!b||b.length===0){b=$("#outcome_blank").clone(true).removeAttr("id");$("#outcomes .outcome_group:first").append(b.show());$("#outcomes .outcome_group:first .child_outcomes").sortable("refresh")}a.asset_string=$.underscore("learning_outcome_"+a.id);b.find("textarea.description").val(a.description);b.fillTemplateData({data:a,id:"outcome_"+a.id,htmlValues:["description"],
hrefValues:["id"]});b.addClass("loaded");b.find(".rubric_criterion .rating:not(.blank)").remove();if(a.data&&a.data.rubric_criterion){for(var c in a.data.rubric_criterion.ratings){var f=a.data.rubric_criterion.ratings[c],g=b.find(".rubric_criterion .rating.blank:first").clone(true).removeClass("blank");d.ratingCounter++;g.find(".description").text(f.description);g.find(".points").text(f.points);b.find(".add_holder").before(g.show())}b.find(".mastery_points").text(a.data.rubric_criterion.mastery_points);
b.find(".points_possible").text(a.data.rubric_criterion.points_possible)}if(a.permissions){b.find(".edit_outcome_link").showIf(a.permissions.update&&e);var e=a.context_code==$("#find_outcome_dialog .context_code").text();b.find(".really_delete_outcome_link").showIf(e);b.find(".remove_outcome_link").showIf(!e)}return b},sizeRatings:function(){},hideEditOutcome:function(){$("#edit_outcome_form textarea").editorBox("destroy");var a=$("#outcomes #edit_outcome_form").prev(".learning_outcome");$("body").append($("#edit_outcome_form").hide());
a.attr("id")=="outcome_new"?a.remove():a.show()},editOutcome:function(a,b){if(a&&a.length>0&&!a.hasClass("loaded"))a.find(".show_details_link").triggerHandler("click",function(){d.editOutcome(a,b)});else{d.hideEditOutcome();if(!a||a.length===0){a=$("#outcome_blank").clone(true).attr("id","outcome_new");if(!b||b.length==0)b=$("#outcomes .outcome_group:first");$("#outcomes .child_outcomes:first").append(a.show());b.find(".child_outcomes").sortable("refresh")}var c=$("#edit_outcome_form");c.attr("action",
a.find(".edit_outcome_link").attr("href"));c.attr("method","PUT");if(a.attr("id")=="outcome_new"){c.attr("action",$("#outcome_links .add_outcome_url").attr("href"));c.attr("method","POST")}var f=a.getTemplateData({textValues:["short_description","description","mastery_points"]});f.description=a.find("textarea.description").val()||a.find("textarea.description").html();c.fillFormData(f,{object_name:"learning_outcome"});c.find("#outcome_include_rubric_example").attr("checked",true).change();c.find(".rubric_criterion .rating:not(.blank)").remove();
a.find(".rubric_criterion .rating:not(.blank)").each(function(){c.find("#outcome_include_rubric_example").attr("checked",true);var g=c.find(".rubric_criterion .rating.blank:first").clone(true).removeClass("blank"),e=$(this).getTemplateData({textValues:["description","points"]}),i=d.ratingCounter++;g.find(".outcome_rating_description").val(e.description).attr("name","learning_outcome[rubric_criterion][ratings]["+i+"][description]");g.find(".outcome_rating_points").val(e.points).attr("name","learning_outcome[rubric_criterion][ratings]["+
i+"][points]");c.find(".add_holder").before(g.show())});c.find(".mastery_points").val(f.mastery_points);c.find("#outcome_include_rubric_example").change();a.after(c.show());a.hide();c.find(":text:visible:first").focus().select();c.find("textarea").editorBox()}},deleteOutcome:function(a){a.confirmDelete({message:h.t("remove_learning_outcome","Are you sure you want to remove this learning outcome?"),url:a.find(".delete_outcome_link").attr("href"),success:function(){$(this).slideUp(function(){$(this).remove()})}})},
updateOutcomeGroup:function(a,b){if(!b||b.length===0)b=$("#group_"+a.id);if(!b||b.length===0){b=$("#group_blank").clone(true).removeAttr("id");$("#outcomes .outcome_group:first").append(b.show());$("#outcomes .outcome_group:first .child_outcomes").sortable("refresh");b.find(".child_outcomes").sortable(d.sortableOptions);$(".outcome_group .child_outcomes").sortable("option","connectWith",".child_outcomes")}a.asset_string=$.underscore("learning_outcome_group_"+a.id);b.find("textarea.description").val(a.description);
b.fillTemplateData({data:a,id:"group_"+a.id,hrefValues:["id"],htmlValues:["description"]});return b},hideEditOutcomeGroup:function(){$("#edit_outcome_group_form textarea").editorBox("destroy");var a=$("#outcomes #edit_outcome_group_form").prev(".outcome_group");$("body").append($("#edit_outcome_group_form").hide());a.attr("id")=="group_new"?a.remove():a.show()},editOutcomeGroup:function(a){d.hideEditOutcomeGroup();if(!a||a.length===0){a=$("#group_blank").clone(true).attr("id","group_new");$("#outcomes .child_outcomes:first").append(a.show());
$("#outcomes .outcome_group:first .child_outcomes").sortable("refresh");a.find(".child_outcomes").sortable(d.sortableOptions);$(".outcome_group .child_outcomes").sortable("option","connectWith",".child_outcomes")}var b=$("#edit_outcome_group_form");b.attr("action",a.find(".edit_group_link").attr("href"));b.attr("method","PUT");if(a.attr("id")=="group_new"){b.attr("action",$("#outcome_links .add_outcome_group_url").attr("href"));b.attr("method","POST")}var c=a.getTemplateData({textValues:["title",
"description"]});c.description=a.find("textarea.description").val();b.fillFormData(c,{object_name:"learning_outcome_group"});a.after(b.show());a.hide();b.find(":text:visible:first").focus().select();b.find("textarea").editorBox()},deleteOutcomeGroup:function(a){a.confirmDelete({message:h.t("remove_outcome_group","Are you sure you want to remove this learning outcome group and all its outcomes?"),url:a.find(".delete_group_link").attr("href"),success:function(){$(this).slideUp(function(){$(this).remove()})}})},
sortableOptions:{axis:"y",connectWith:"#outcomes .child_outcomes",containment:"#outcomes",handle:".reorder_link",update:function(a,b){var c=$(b.item).parent().closest(".outcome_group"),f=c.children(".header").getTemplateData({textValues:["asset_string","id"]}).id,g={};f=$.replaceTags($("#outcome_links .reorder_items_url").attr("href"),"id",f);c=c.find(".child_outcomes").children(".learning_outcome, .outcome_group").map(function(k,j){return $(j).children(".header").getTemplateData({textValues:["asset_string",
"id"]}).asset_string});for(var e=0,i=c.length;e<i;e++)g["ordering["+c[e]+"]"]=e;$.ajaxJSON(f,"POST",g)}}};$(document).ready(function(){$("#outcome_information_link").click(function(a){a.preventDefault();$("#outcome_criterion_dialog").dialog("close").dialog({autoOpen:false,title:h.t("outcome_criterion","Learning Outcome Criterion"),width:400}).dialog("open")});$(".show_details_link,.hide_details_link").click(function(a,b){a.preventDefault();var c=$(this).closest(".learning_outcome");if($(this).hasClass("show_details_link"))if(c.hasClass("loaded"))c.addClass("expanded");
else{var f=$(this);f.text("loading details...");var g=c.find("a.show_details_link").attr("href");$.ajaxJSON(g,"GET",{},function(e){f.text(h.t("show_details","show details"));d.updateOutcome(e.learning_outcome,c);c.addClass("expanded");b&&$.isFunction(b)&&b()},function(){f.text(h.t("details_failed_to_load","details failed to load, please try again"))})}else c.removeClass("expanded")});$("#outcomes .child_outcomes").sortable(d.sortableOptions);$(".delete_group_link").click(function(a){a.preventDefault();
d.deleteOutcomeGroup($(this).closest(".outcome_group"))});$(".edit_group_link").click(function(a){a.preventDefault();d.editOutcomeGroup($(this).closest(".outcome_group"))});$("#find_outcome_dialog .select_outcomes_link").click(function(a){a.preventDefault();$("#find_outcome_dialog .select_outcome_checkbox:checked").each(function(){var b=$(this).parents(".outcomes_dialog_select").getTemplateData({textValues:["id"]}).id,c=$("#outcome_dialog_"+b);b=c.getTemplateData({textValues:["id"]}).id;var f=$("#outcomes .outcome_group:first > .header").getTemplateData({textValues:["id"]}).id;
b=$.replaceTags($("#find_outcome_dialog .add_outcome_url").attr("href"),"learning_outcome_id",b);b=$.replaceTags(b,"learning_outcome_group_id",f);f=c.getTemplateData({textValues:["id","short_description","description"]});f.permissions={};c=d.updateOutcome(f);$("html,body").scrollTo(c);c.loadingImage();$("#find_outcome_dialog").dialog("close");$.ajaxJSON(b,"POST",{},function(g){c.loadingImage("remove");d.updateOutcome(g.learning_outcome)},function(){c.loadingImage("remove");c.remove()})})});$(".edit_outcome_link").click(function(a){a.preventDefault();
d.editOutcome($(this).parents(".learning_outcome"))});$(".delete_outcome_link").click(function(a){a.preventDefault();d.deleteOutcome($(this).parents(".learning_outcome"))});$(".add_outcome_link").click(function(a){a.preventDefault();a=$(this).closest(".outcome_group");if(a.length==0)a=null;d.editOutcome(null,a)});$(".add_outcome_group_link").click(function(a){a.preventDefault();d.editOutcomeGroup()});$("#edit_outcome_group_form .cancel_button").click(function(){d.hideEditOutcomeGroup()});$("#edit_outcome_form .cancel_button").click(function(){d.hideEditOutcome()});
$("#find_outcome_dialog .outcomes_dialog_select").click(function(a){if(!($(a.target).closest("input").length>0)){a.preventDefault();$("#find_outcome_dialog .outcomes_dialog_select.selected_side_tab").removeClass("selected_side_tab");$(this).addClass("selected_side_tab");a=$(this).getTemplateData({textValues:["id"]}).id;$("#find_outcome_dialog").find(".outcomes_dialog_outcome").hide().end().find("#outcome_dialog_"+a).show()}});$(".find_outcome_link").click(function(a){var b=$("#find_outcome_dialog");
a.preventDefault();b.dialog("close").dialog({autoOpen:true,width:600,height:350,title:h.t("find_existing_outcome","Find Existing Outcome")}).dialog("open");if(!b.hasClass("loaded")){b.find(".loading_message").text(h.t("loading_outcomes","Loading outcomes..."));a=b.find(".outcomes_url").attr("href");$.ajaxJSON(a,"GET",{},function(c){b.find(".loading_message").remove();c.length===0&&b.find(".loading_message").text("No outcomes found");for(var f in c){var g=c[f].learning_outcome,e=b.find(".outcomes_dialog_select.blank:first").clone(true);
e.fillTemplateData({data:g}).removeClass("blank");b.find(".outcomes_dialog_outcomes_select").append(e.show());e=b.find(".outcomes_dialog_outcome.blank:first").clone(true);e.removeClass("blank");e.data("outcome",g);e.find(".criterion.blank").hide();g.outcome_total=g.points_possible;e.fillTemplateData({data:g,htmlValues:["description"],id:"outcome_dialog_"+g.id});b.find(".outcomes_dialog_outcomes").append(e)}b.find(".outcomes_dialog_holder").show();b.find(".outcomes_dialog_outcomes_select .outcomes_dialog_select:visible:first").click();
b.addClass("loaded")},function(){b.find(".loading_message").text(h.t("loading_outcomes_failed","Loading outcomes failed, please try again"))})}});$("#edit_outcome_form").formSubmit({processData:function(a){a.learning_outcome_group_id=$(this).closest(".outcome_group").find(".header").first().getTemplateData({textValues:["id"]}).id;return a},beforeSubmit:function(){var a=$(this).prev(".outcome");a.attr("id")=="outcome_new"&&a.attr("id","outcome_adding");$(this).loadingImage()},success:function(a){$(this).loadingImage("remove");
d.updateOutcome(a.learning_outcome,$(this).prev(".learning_outcome"));d.hideEditOutcome()},error:function(a){$(this).loadingImage("remove");$(this).formErrors(a)}});$("#edit_outcome_group_form").formSubmit({processData:function(a){var b=$(this).parent().closest(".outcome_group").children(".header").getTemplateData({textValues:["id"]}).id;a["learning_outcome_group[learning_outcome_group_id]"]=b;return a},beforeSubmit:function(){var a=$(this).prev(".outcome_group");a.attr("id")=="group_new"&&a.attr("id",
"group_adding");$(this).loadingImage()},success:function(a){$(this).loadingImage("remove");d.updateOutcomeGroup(a.learning_outcome_group,$(this).prev(".outcome_group"));d.hideEditOutcomeGroup()},error:function(a){$(this).loadingImage("remove");$(this).formErrors(a)}});$("#edit_outcome_form .switch_views_link").click(function(a){a.preventDefault();$("#edit_outcome_form textarea:first").editorBox("toggle")});$("#outcome_include_rubric_example").change(function(){var a=$(this).parents("form");a.find(".rubric_criterion").showIf($(this).attr("checked"));
a.find(".outcome_rating_points:first").blur();a.find(".outcome_criterion_title").val()||a.find(".outcome_criterion_title").val(a.find(".outcome_short_description").val());if(a.find(".rating:not(.blank)").length===0){var b=a.find(".rating.blank:first").clone(true).removeClass("blank"),c=d.ratingCounter++;b.find(".outcome_rating_description").val(h.t("criteria.exceeds_expectations","Exceeds Expectations")).attr("name","learning_outcome[rubric_criterion][ratings]["+c+"][description]");b.find(".outcome_rating_points").val("5").attr("name",
"learning_outcome[rubric_criterion][ratings]["+c+"][points]");a.find(".add_holder").before(b.show());c=d.ratingCounter++;b=a.find(".rating.blank:first").clone(true).removeClass("blank");b.find(".outcome_rating_description").val(h.t("criteria.meets_expectations","Meets Expectations")).attr("name","learning_outcome[rubric_criterion][ratings]["+c+"][description]");b.find(".outcome_rating_points").val("3").attr("name","learning_outcome[rubric_criterion][ratings]["+c+"][points]");a.find(".add_holder").before(b.show());
c=d.ratingCounter++;b=a.find(".rating.blank:first").clone(true).removeClass("blank");b.find(".outcome_rating_description").val(h.t("criteria.does_not_meet_expectations","Does Not Meet Expectations")).attr("name","learning_outcome[rubric_criterion][ratings]["+c+"][description]");b.find(".outcome_rating_points").val("0").attr("name","learning_outcome[rubric_criterion][ratings]["+c+"][points]");a.find(".add_holder").before(b.show());a.find(".mastery_points").val("3")}a.find(".outcome_rating_points:first").blur()});
$("#edit_outcome_form .outcome_rating_points").blur(function(){var a=0;$(this).val(parseFloat($(this).val()));$("#edit_outcome_form .rating:not(.blank) .outcome_rating_points").each(function(){var b=parseFloat($(this).val(),10);if(b)a=Math.max(b,a)});$("#edit_outcome_form .points_possible").text(a)});$("#edit_outcome_form .mastery_points").blur(function(){$(this).val(parseFloat($(this).val())||0)});$("#edit_outcome_form .add_rating_link").click(function(a){a.preventDefault();a=$(this).parents("table").find("tr.rating:visible:first").clone(true).removeClass("blank");
if(a.length===0)a=$(this).parents("table").find("tr.rating.blank").clone(true).removeClass("blank");$(this).parents("table").find(".criterion_title").after(a.show());var b=d.ratingCounter++;a.find(".outcome_rating_description").attr("name","learning_outcome[rubric_criterion][ratings]["+b+"][description]");a.find(".outcome_rating_points").attr("name","learning_outcome[rubric_criterion][ratings]["+b+"][points]");a.find(".outcome_rating_points").val(parseFloat(a.find(".outcome_rating_points").val(),
10)+1);a.find(".outcome_rating_points:first").blur();d.sizeRatings()});$("#edit_outcome_form .delete_rating_link").click(function(a){a.preventDefault();$(this).parents("tr").remove();d.sizeRatings()})})});
$.extend(true,I18n=I18n||{},{translations:{es:{learning_outcomes:{show_details:"mostrar los detalles",outcome_criterion:"Criterio de Resultados de Aprendizaje",remove_learning_outcome:"\u00bfEst\u00e1 seguro que quiere remover este resultado de aprendizaje?",loading_outcomes:"Cargando resultados...",loading_outcomes_failed:"Cargado de los resultados fall\u00f3, intente de nuevo",criteria:{meets_expectations:"Cumple con las Expectativas",exceeds_expectations:"Excede las Expectaciones",does_not_meet_expectations:"No cumple con las Expectativas"},
find_existing_outcome:"Encontrar un Resultado Existente",remove_outcome_group:"\u00bfSeguro que quiere remover este grupo de resultados de aprendizaje y todos sus resultados?",details_failed_to_load:"la carga de los detalles fall\u00f3, intente de nuevo"}}}});
