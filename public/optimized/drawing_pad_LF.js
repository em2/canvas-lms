function prepareCanvasLF(a,b,c,d,e){function f(a,b){var c,d,e;c=0,d=0;for(e in a)d++;for(e in a)K[e]=new Image,K[e].onload=function(){if(++c>=d)return b()},K[e].crossOrigin="",K[e].src=a[e]}function g(){c=!1,t()}function h(){c=!0,t()}function i(a){c&&(y=!0,k(a))}function j(a){c&&(y=!1,l(a))}function k(a){if(c){var b=m(a);w=b.x,x=b.y,q(),u()}}function l(a){if(c){a.preventDefault();var b=n(a);w=b.x,x=b.y,q(),u(),y||(y=!0)}}function m(a){var b=v.getBoundingClientRect();return{x:a.clientX-b.left,y:a.clientY-b.top}}function n(a){var b=v.getBoundingClientRect();return{x:a.targetTouches[0].clientX-b.left,y:a.targetTouches[0].clientY-b.top}}function o(){c&&(y=!1,R=!1)}function p(){c&&(y=!1,R=!1)}function q(){w>V+X&&x>Z&&!y&&(x<Z+_?(T="marker1",U="normal",S=H):x<Z+_*2?(T="marker2",U="normal",S=G):x<Z+_*3&&(T="eraser",U="huge",S=I)),R=!0,r()}function r(){c&&R&&(L.push(w),M.push(x),O.push(T),N.push(S),P.push(U),Q.push(y),$("#explain_canvas_"+b+"_click_x_data").val(L.toString()),$("#explain_canvas_"+b+"_click_y_data").val(M.toString()),$("#explain_canvas_"+b+"_click_color_data").val(N.toString()),$("#explain_canvas_"+b+"_click_tool_data").val(O.toString()),$("#explain_canvas_"+b+"_click_size_data").val(P.toString()),$("#explain_canvas_"+b+"_click_drag_data").val(Q.toString()),$("#explain_canvas_"+b+"_click_x_data").change())}function s(){z.clearRect(0,0,A,B)}function t(){s(),z.drawImage(K.whiteBackgroundImage,0,0,A,B),T==="marker1"&&c===!0?z.drawImage(K.marker1BackgroundImage,0,0,A,B):T!=="marker2"&&T!=="marker"||c!==!0?T==="eraser"&&c===!0?z.drawImage(K.eraserBackgroundImage,0,0,A,B):c?alert("Error: Current Tool is undefined"):z.drawImage(K.plainBackgroungImage,0,0,A-104,B):z.drawImage(K.marker2BackgroundImage,0,0,A,B),c===!0&&(z.beginPath(),z.moveTo(bc,bd),z.lineTo(bc+10,bd+6),z.lineTo(bc,bd+11),z.lineTo(bc,bd),z.closePath(),z.fillStyle=H,z.fill(),z.beginPath(),z.moveTo(bc,be),z.lineTo(bc+10,be+6),z.lineTo(bc,be+11),z.lineTo(bc,be),z.closePath(),z.fillStyle=G,z.fill()),z.save(),z.beginPath(),z.rect(V,W,X,Y),z.clip();var a,b=0;for(;b<L.length;b++)P[b]==="small"?a=2:P[b]==="normal"?a=3:P[b]==="large"?a=10:P[b]==="huge"?a=20:(alert("Error: Radius is zero for click "+b),a=0),z.beginPath(),Q[b]?z.moveTo(L[b-1],M[b-1]):z.moveTo(L[b],M[b]),z.lineTo(L[b],M[b]),z.closePath(),O[b]==="eraser"?z.strokeStyle=I:z.strokeStyle=N[b],z.lineJoin="round",z.lineWidth=a,z.stroke(),bb=b;z.restore(),z.globalAlpha=1,z.drawImage(K.outlineImage,V,W+Y/2-bf/2,X,bf)}function u(){var a,b;b=bb;for(;b<L.length;b++)P[b]==="small"?a=2:P[b]==="normal"?a=3:P[b]==="large"?a=10:P[b]==="huge"?a=20:(alert("Error: Radius is zero for click "+b),a=0),z.beginPath(),Q[b]&&b?z.moveTo(L[b-1],M[b-1]):z.moveTo(L[b],M[b]),z.lineTo(L[b],M[b]),z.closePath(),O[b]==="eraser"?z.strokeStyle=I:z.strokeStyle=N[b],z.lineJoin="round",z.lineWidth=a,z.stroke(),bb=b;T==="marker1"&&c===!0?z.drawImage(K.marker1BackgroundImage,0,0,A,B):T!=="marker2"&&T!=="marker"||c!==!0?T==="eraser"&&c===!0?z.drawImage(K.eraserBackgroundImage,0,0,A,B):c?alert("Error: Current Tool is undefined"):z.drawImage(K.plainBackgroungImage,0,0,A-104,B):z.drawImage(K.marker2BackgroundImage,0,0,A,B),c===!0&&(z.beginPath(),z.moveTo(bc,bd),z.lineTo(bc+10,bd+6),z.lineTo(bc,bd+11),z.lineTo(bc,bd),z.closePath(),z.fillStyle=H,z.fill(),z.beginPath(),z.moveTo(bc,be),z.lineTo(bc+10,be+6),z.lineTo(bc,be+11),z.lineTo(bc,be),z.closePath(),z.fillStyle=G,z.fill()),z.drawImage(K.outlineImage,V,W+Y/2-bf/2,X,bf)}if(d===!0)return;var v,w,x,y=!1,z,A=713,B=332,C=25,D=8,E="#cb3594",F="#659b41",G="#0033ff",H="#000000",I="#FFFFFF",J={},K={},L=new Array,M=new Array,N=new Array,O=new Array,P=new Array,Q=new Array,R=!1,S=G,T="marker2",U="normal",V=1,W=1,X=600,Y=330,Z=30,_=38,ba=0,bb=0,bc=644,bd=44,be=83,bf=150;if($("#explain_canvas_"+b+"_click_x_data").val().length>0){L=$("#explain_canvas_"+b+"_click_x_data").val(),L=L.split(","),M=$("#explain_canvas_"+b+"_click_y_data").val(),M=M.split(","),N=$("#explain_canvas_"+b+"_click_color_data").val(),N=N.split(","),O=$("#explain_canvas_"+b+"_click_tool_data").val(),O=O.split(","),P=$("#explain_canvas_"+b+"_click_size_data").val(),P=P.split(","),Q=$("#explain_canvas_"+b+"_click_drag_data").val(),Q=Q.split(",");for(var bg=0;bg<L.length;bg++)L[bg]=parseInt(L[bg]),M[bg]=parseInt(M[bg]);for(var bg=0;bg<Q.length;bg++)Q[bg]==="true"?Q[bg]=!0:Q[bg]=!1}var bh=document.getElementById(a),v=document.createElement("canvas");v.setAttribute("width",A),v.setAttribute("height",B),v.setAttribute("id","canvas_"+a),v.setAttribute("name","canvas_"+a),bh.appendChild(v),typeof G_vmlCanvasManager!="undefined"&&(v=G_vmlCanvasManager.initElement(v));var z=v.getContext("2d");return J={marker1BackgroundImage:"../../../../images/canvas_drawing/marker1-background_LF.png",marker2BackgroundImage:"../../../../images/canvas_drawing/marker2-background_LF.png",eraserBackgroundImage:"../../../../images/canvas_drawing/eraser-background_LF.png",plainBackgroungImage:"../../../../images/canvas_drawing/plain-background_LF.png",whiteBackgroundImage:"../../../../images/canvas_drawing/background-white_LF.png",outlineImage:e},$("#canvas_"+a).bind("mousedown",function(a){i(a.originalEvent)}),$("#canvas_"+a).bind("mousemove",function(a){k(a.originalEvent)}),$(document.body).bind("mouseup",function(a){o()}),$("#canvas_"+a).bind("touchstart",function(a){j(a.originalEvent)}),$("#canvas_"+a).bind("touchmove",function(a){l(a.originalEvent)}),$("#canvas_"+a).bind("touchend",function(a){p()}),$(document.body).bind("touchcancel",function(a){p()}),$("#canvas_"+a).bind("hideYerStuff",function(a){g()}),$("#canvas_"+a).bind("showYerStuff",function(a){h()}),f(J,t)}