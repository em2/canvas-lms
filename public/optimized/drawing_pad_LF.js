function prepareCanvasLF(a,b,c,d,e){function f(){++bd>=bc&&t()}function g(){c=!1,t()}function h(){c=!0,t()}function i(a){c&&(z=!0,k(a))}function j(a){c&&(z=!1,l(a))}function k(a){if(c){var b=m(a);x=b.x,y=b.y,q(),u()}}function l(a){if(c){a.preventDefault();var b=n(a);x=b.x,y=b.y,q(),u(),z||(z=!0)}}function m(a){var b=w.getBoundingClientRect();return{x:a.clientX-b.left,y:a.clientY-b.top}}function n(a){var b=w.getBoundingClientRect();return{x:a.targetTouches[0].clientX-b.left,y:a.targetTouches[0].clientY-b.top}}function o(){c&&(z=!1,T=!1)}function p(){c&&(z=!1,T=!1)}function q(){x>X+Z&&y>ba&&!z&&(y<ba+bb?(V="marker",W="normal"):y<ba+bb*2&&(V="eraser",W="huge")),T=!0,r()}function r(){c&&T&&(N.push(x),O.push(y),Q.push(V),P.push(U),R.push(W),S.push(z),$("#explain_canvas_"+b+"_click_x_data").val(N.toString()),$("#explain_canvas_"+b+"_click_y_data").val(O.toString()),$("#explain_canvas_"+b+"_click_color_data").val(P.toString()),$("#explain_canvas_"+b+"_click_tool_data").val(Q.toString()),$("#explain_canvas_"+b+"_click_size_data").val(R.toString()),$("#explain_canvas_"+b+"_click_drag_data").val(S.toString()),$("#explain_canvas_"+b+"_click_x_data").change())}function s(){A.clearRect(0,0,B,C)}function t(){if(bd<bc)return;s(),A.drawImage(M,0,0,B,C),V=="marker"&&c==1?A.drawImage(J,0,0,B,C):V=="eraser"&&c==1?A.drawImage(K,0,0,B,C):c?alert("Error: Current Tool is undefined"):A.drawImage(L,0,0,B-104,C),c==1&&(A.beginPath(),A.moveTo(bf,bg),A.lineTo(bf+10,bg+6),A.lineTo(bf,bg+11),A.lineTo(bf,bg),A.closePath(),A.fillStyle=H,A.fill()),A.save(),A.beginPath(),A.rect(X,Y,Z,_),A.clip();var a,b=0;for(;b<N.length;b++)R[b]=="small"?a=2:R[b]=="normal"?a=3:R[b]=="large"?a=10:R[b]=="huge"?a=20:(alert("Error: Radius is zero for click "+b),a=0),A.beginPath(),S[b]?A.moveTo(N[b-1],O[b-1]):A.moveTo(N[b],O[b]),A.lineTo(N[b],O[b]),A.closePath(),Q[b]=="eraser"?A.strokeStyle="white":A.strokeStyle=P[b],A.lineJoin="round",A.lineWidth=a,A.stroke(),be=b;A.restore(),A.globalAlpha=1,A.drawImage(v,X,Y+_/2-bi/2,Z,bi)}function u(){var a,b;b=be;for(;b<N.length;b++)R[b]=="small"?a=2:R[b]=="normal"?a=3:R[b]=="large"?a=10:R[b]=="huge"?a=20:(alert("Error: Radius is zero for click "+b),a=0),A.beginPath(),S[b]&&b?A.moveTo(N[b-1],O[b-1]):A.moveTo(N[b],O[b]),A.lineTo(N[b],O[b]),A.closePath(),Q[b]=="eraser"?A.strokeStyle="white":A.strokeStyle=P[b],A.lineJoin="round",A.lineWidth=a,A.stroke(),be=b;V=="marker"&&c==1?A.drawImage(J,0,0,B,C):V=="eraser"&&c==1?A.drawImage(K,0,0,B,C):c?alert("Error: Current Tool is undefined"):A.drawImage(L,0,0,B-104,C),c==1&&(A.beginPath(),A.moveTo(bf,bg),A.lineTo(bf+10,bg+6),A.lineTo(bf,bg+11),A.lineTo(bf,bg),A.closePath(),A.fillStyle=H,A.fill()),A.drawImage(v,X,Y+_/2-bi/2,Z,bi)}if(d==1)return;var v=new Image;v.crossOrigin="";var w,x,y,z=!1,A,B=713,C=332,D=25,E=8,F="#cb3594",G="#659b41",H="#0033ff",I="#000000",J=new Image,K=new Image,L=new Image,M=new Image,N=new Array,O=new Array,P=new Array,Q=new Array,R=new Array,S=new Array,T=!1,U=H,V="marker",W="normal",X=1,Y=1,Z=600,_=330,ba=65,bb=38,bc=5,bd=0,be=0,bf=644,bg=65,bh=650,bi=150;if($("#explain_canvas_"+b+"_click_x_data").val().length>0){N=$("#explain_canvas_"+b+"_click_x_data").val(),N=N.split(","),O=$("#explain_canvas_"+b+"_click_y_data").val(),O=O.split(","),P=$("#explain_canvas_"+b+"_click_color_data").val(),P=P.split(","),Q=$("#explain_canvas_"+b+"_click_tool_data").val(),Q=Q.split(","),R=$("#explain_canvas_"+b+"_click_size_data").val(),R=R.split(","),S=$("#explain_canvas_"+b+"_click_drag_data").val(),S=S.split(",");for(var bj=0;bj<N.length;bj++)N[bj]=parseInt(N[bj]),O[bj]=parseInt(O[bj]);for(var bj=0;bj<S.length;bj++)S[bj]=="true"?S[bj]=!0:S[bj]=!1}var bk=document.getElementById(a),w=document.createElement("canvas");w.setAttribute("width",B),w.setAttribute("height",C),w.setAttribute("id","canvas_"+a),w.setAttribute("name","canvas_"+a),bk.appendChild(w),typeof G_vmlCanvasManager!="undefined"&&(w=G_vmlCanvasManager.initElement(w));var A=w.getContext("2d");J.onload=function(){f()},J.src="../../../../images/canvas_drawing/marker-background_LF.png",K.onload=function(){f()},K.src="../../../../images/canvas_drawing/eraser-background_LF.png",L.onload=function(){f()},L.src="../../../../images/canvas_drawing/plain-background_LF.png",v.onload=function(){f()},v.src=e,M.onload=function(){f()},M.src="../../../../images/canvas_drawing/background-white_LF.png",$("#canvas_"+a).bind("mousedown",function(a){i(a.originalEvent)}),$("#canvas_"+a).bind("mousemove",function(a){k(a.originalEvent)}),$(document.body).bind("mouseup",function(a){o()}),$("#canvas_"+a).bind("touchstart",function(a){j(a.originalEvent)}),$("#canvas_"+a).bind("touchmove",function(a){l(a.originalEvent)}),$("#canvas_"+a).bind("touchend",function(a){p()}),$(document.body).bind("touchcancel",function(a){p()}),$("#canvas_"+a).bind("hideYerStuff",function(a){g()}),$("#canvas_"+a).bind("showYerStuff",function(a){h()})}