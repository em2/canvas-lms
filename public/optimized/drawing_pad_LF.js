function prepareCanvasLF(a,b,c,d,e){function f(){++_>=Z&&r()}function g(){c=!1,r()}function h(){c=!0,r()}function i(){c&&(w=!0,k())}function j(){c&&(w=!1,l())}function k(a){if(!a)var a=event;c&&(u=a.pageX-t.offsetLeft,v=a.pageY-t.parentNode.parentNode.parentNode.parentNode.parentNode.offsetTop-t.offsetTop+60,o(),r())}function l(a){if(!a)var a=event;c&&(a.preventDefault(),u=a.targetTouches[0].pageX-t.offsetLeft,v=a.targetTouches[0].pageY-t.parentNode.parentNode.parentNode.parentNode.parentNode.offsetTop-t.offsetTop+60,o(),r(),w||(w=!0))}function m(){c&&(w=!1,P=!1)}function n(){c&&(w=!1,P=!1)}function o(){u>T+V+16&&v>X&&!w&&(v<X+Y*2?(R="marker",S="normal"):v<X+Y*3&&(R="eraser",S="huge")),P=!0,p()}function p(){c&&P&&(J.push(u),K.push(v),M.push(R),L.push(Q),N.push(S),O.push(w),$("#explain_canvas_"+b+"_click_x_data").val(J.toString()),$("#explain_canvas_"+b+"_click_y_data").val(K.toString()),$("#explain_canvas_"+b+"_click_color_data").val(L.toString()),$("#explain_canvas_"+b+"_click_tool_data").val(M.toString()),$("#explain_canvas_"+b+"_click_size_data").val(N.toString()),$("#explain_canvas_"+b+"_click_drag_data").val(O.toString()),$("#explain_canvas_"+b+"_click_x_data").change())}function q(){x.clearRect(0,0,y,z)}function r(){if(_<Z)return;q(),R=="marker"&&c==1?x.drawImage(G,0,0,y,z):R=="eraser"&&c==1?x.drawImage(H,0,0,y,z):c?alert("Error: Current Tool is undefined"):x.drawImage(I,0,0,y-104,z);var a=649,b=37;c==1&&(x.beginPath(),x.moveTo(a,b),x.lineTo(a+10,b+6),x.lineTo(a,b+11),x.lineTo(a,b),x.closePath(),x.fillStyle=E,x.fill()),x.save(),x.beginPath(),x.rect(T,U,V,W),x.clip();var d,e=0;for(;e<J.length;e++)N[e]=="small"?d=2:N[e]=="normal"?d=3:N[e]=="large"?d=10:N[e]=="huge"?d=20:(alert("Error: Radius is zero for click "+e),d=0),x.beginPath(),O[e]?x.moveTo(J[e-1]-15,K[e-1]-70):x.moveTo(J[e]-15,K[e]-70),x.lineTo(J[e]-15,K[e]-70),x.closePath(),M[e]=="eraser"?x.strokeStyle="white":x.strokeStyle=L[e],x.lineJoin="round",x.lineWidth=d,x.stroke();x.restore(),x.globalAlpha=1,x.drawImage(s,T,U,V,W)}if(d==1)return;var s=new Image;s.src=e;var t,u,v,w=!1,x,y=722,z=170,A=25,B=8,C="#cb3594",D="#659b41",E="#0033ff",F="#000000",G=new Image,H=new Image,I=new Image,J=new Array,K=new Array,L=new Array,M=new Array,N=new Array,O=new Array,P=!1,Q=E,R="marker",S="normal",T=10,U=10,V=600,W=150,X=55,Y=38,Z=3,_=0;if($("#explain_canvas_"+b+"_click_x_data").val().length>0){J=$("#explain_canvas_"+b+"_click_x_data").val(),J=J.split(","),K=$("#explain_canvas_"+b+"_click_y_data").val(),K=K.split(","),L=$("#explain_canvas_"+b+"_click_color_data").val(),L=L.split(","),M=$("#explain_canvas_"+b+"_click_tool_data").val(),M=M.split(","),N=$("#explain_canvas_"+b+"_click_size_data").val(),N=N.split(","),O=$("#explain_canvas_"+b+"_click_drag_data").val(),O=O.split(",");for(var ba=0;ba<J.length;ba++)J[ba]=parseInt(J[ba]),K[ba]=parseInt(K[ba]);for(var ba=0;ba<O.length;ba++)O[ba]=="true"?O[ba]=!0:O[ba]=!1}var bb=document.getElementById(a),t=document.createElement("canvas");t.setAttribute("width",y),t.setAttribute("height",z),t.setAttribute("id","canvas_"+a),t.setAttribute("name","canvas_"+a),bb.appendChild(t),typeof G_vmlCanvasManager!="undefined"&&(t=G_vmlCanvasManager.initElement(t));var x=t.getContext("2d");G.onload=function(){f()},G.src="../../../../images/canvas_drawing/marker-background_LF.png",H.onload=function(){f()},H.src="../../../../images/canvas_drawing/eraser-background_LF.png",I.onload=function(){f()},I.src="../../../../images/canvas_drawing/plain-background_LF.png",$("#canvas_"+a).bind("mousedown",function(a){i()}),$("#canvas_"+a).bind("mousemove",function(a){k(a.originalEvent)}),$(document.body).bind("mouseup",function(a){m()}),$("#canvas_"+a).bind("touchstart",function(a){j()}),$("#canvas_"+a).bind("touchmove",function(a){l(a.originalEvent)}),$("#canvas_"+a).bind("touchend",function(a){n()}),$(document.body).bind("touchcancel",function(a){n()}),$("#canvas_"+a).bind("hideYerStuff",function(a){g()}),$("#canvas_"+a).bind("showYerStuff",function(a){h()})}