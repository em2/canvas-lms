function prepareCanvasLF(a,b,c,d,e){function T(a,b){var c,d,e;c=0,d=0;for(e in a)d++;for(e in a)u[e]=new Image,u[e].onload=function(){if(++c>=d)return b()},u[e].crossOrigin="",u[e].src=a[e]}function U(){c=!1,bg()}function V(){c=!0,bg()}function W(a){c&&(i=!0,Y(a))}function X(a){c&&(i=!1,Z(a))}function Y(a){if(c){var b=_(a);g=b.x,h=b.y,bd(),bh()}}function Z(a){if(c){a.preventDefault();var b=ba(a);g=b.x,h=b.y,bd(),bh(),i||(i=!0)}}function _(a){var b=f.getBoundingClientRect();return{x:a.clientX-b.left,y:a.clientY-b.top}}function ba(a){var b=f.getBoundingClientRect();return{x:a.targetTouches[0].clientX-b.left,y:a.targetTouches[0].clientY-b.top}}function bb(){c&&(i=!1,B=!1)}function bc(){c&&(i=!1,B=!1)}function bd(){g>F+H&&h>J&&!i&&(h<J+K?(D="marker1",E="normal",C=r):h<J+K*2?(D="marker2",E="normal",C=q):h<J+K*3&&(D="eraser",E="huge",C=s)),B=!0,be()}function be(){c&&B&&(v.push(g),w.push(h),y.push(D),x.push(C),z.push(E),A.push(i),$("#explain_canvas_"+b+"_click_x_data").val(v.toString()),$("#explain_canvas_"+b+"_click_y_data").val(w.toString()),$("#explain_canvas_"+b+"_click_color_data").val(x.toString()),$("#explain_canvas_"+b+"_click_tool_data").val(y.toString()),$("#explain_canvas_"+b+"_click_size_data").val(z.toString()),$("#explain_canvas_"+b+"_click_drag_data").val(A.toString()),$("#explain_canvas_"+b+"_click_x_data").change())}function bf(){j.clearRect(0,0,k,l)}function bg(){bf(),j.drawImage(u.whiteBackgroundImage,0,0,k,l),D==="marker1"&&c===!0?j.drawImage(u.marker1BackgroundImage,0,0,k,l):D!=="marker2"&&D!=="marker"||c!==!0?D==="eraser"&&c===!0?j.drawImage(u.eraserBackgroundImage,0,0,k,l):c?alert("Error: Current Tool is undefined"):j.drawImage(u.plainBackgroungImage,0,0,k-104,l):j.drawImage(u.marker2BackgroundImage,0,0,k,l),c===!0&&(j.beginPath(),j.moveTo(N,O),j.lineTo(N+10,O+6),j.lineTo(N,O+11),j.lineTo(N,O),j.closePath(),j.fillStyle=r,j.fill(),j.beginPath(),j.moveTo(N,P),j.lineTo(N+10,P+6),j.lineTo(N,P+11),j.lineTo(N,P),j.closePath(),j.fillStyle=q,j.fill()),j.save(),j.beginPath(),j.rect(F,G,H,I),j.clip();var a,b=0;for(;b<v.length;b++)z[b]==="small"?a=2:z[b]==="normal"?a=3:z[b]==="large"?a=10:z[b]==="huge"?a=20:(alert("Error: Radius is zero for click "+b),a=0),j.beginPath(),A[b]?j.moveTo(v[b-1],w[b-1]):j.moveTo(v[b],w[b]),j.lineTo(v[b],w[b]),j.closePath(),y[b]==="eraser"?j.strokeStyle=s:j.strokeStyle=x[b],j.lineJoin="round",j.lineWidth=a,j.stroke(),M=b;j.restore(),j.globalAlpha=1,j.drawImage(u.outlineImage,F,G+I/2-Q/2,H,Q)}function bh(){var a,b;b=M;for(;b<v.length;b++)z[b]==="small"?a=2:z[b]==="normal"?a=3:z[b]==="large"?a=10:z[b]==="huge"?a=20:(alert("Error: Radius is zero for click "+b),a=0),j.beginPath(),A[b]&&b?j.moveTo(v[b-1],w[b-1]):j.moveTo(v[b],w[b]),j.lineTo(v[b],w[b]),j.closePath(),y[b]==="eraser"?j.strokeStyle=s:j.strokeStyle=x[b],j.lineJoin="round",j.lineWidth=a,j.stroke(),M=b;D==="marker1"&&c===!0?j.drawImage(u.marker1BackgroundImage,0,0,k,l):D!=="marker2"&&D!=="marker"||c!==!0?D==="eraser"&&c===!0?j.drawImage(u.eraserBackgroundImage,0,0,k,l):c?alert("Error: Current Tool is undefined"):j.drawImage(u.plainBackgroungImage,0,0,k-104,l):j.drawImage(u.marker2BackgroundImage,0,0,k,l),c===!0&&(j.beginPath(),j.moveTo(N,O),j.lineTo(N+10,O+6),j.lineTo(N,O+11),j.lineTo(N,O),j.closePath(),j.fillStyle=r,j.fill(),j.beginPath(),j.moveTo(N,P),j.lineTo(N+10,P+6),j.lineTo(N,P+11),j.lineTo(N,P),j.closePath(),j.fillStyle=q,j.fill()),j.drawImage(u.outlineImage,F,G+I/2-Q/2,H,Q)}if(d===!0)return;var f,g,h,i=!1,j,k=713,l=332,m=25,n=8,o="#cb3594",p="#659b41",q="#0033ff",r="#000000",s="#FFFFFF",t={},u={},v=new Array,w=new Array,x=new Array,y=new Array,z=new Array,A=new Array,B=!1,C=q,D="marker2",E="normal",F=1,G=1,H=600,I=330,J=30,K=38,L=0,M=0,N=644,O=44,P=83,Q=150;if($("#explain_canvas_"+b+"_click_x_data").val().length>0){v=$("#explain_canvas_"+b+"_click_x_data").val(),v=v.split(","),w=$("#explain_canvas_"+b+"_click_y_data").val(),w=w.split(","),x=$("#explain_canvas_"+b+"_click_color_data").val(),x=x.split(","),y=$("#explain_canvas_"+b+"_click_tool_data").val(),y=y.split(","),z=$("#explain_canvas_"+b+"_click_size_data").val(),z=z.split(","),A=$("#explain_canvas_"+b+"_click_drag_data").val(),A=A.split(",");for(var R=0;R<v.length;R++)v[R]=parseInt(v[R]),w[R]=parseInt(w[R]);for(var R=0;R<A.length;R++)A[R]==="true"?A[R]=!0:A[R]=!1}var S=document.getElementById(a),f=document.createElement("canvas");f.setAttribute("width",k),f.setAttribute("height",l),f.setAttribute("id","canvas_"+a),f.setAttribute("name","canvas_"+a),S.appendChild(f),typeof G_vmlCanvasManager!="undefined"&&(f=G_vmlCanvasManager.initElement(f));var j=f.getContext("2d");return t={marker1BackgroundImage:"../../../../images/canvas_drawing/marker1-background_LF.png",marker2BackgroundImage:"../../../../images/canvas_drawing/marker2-background_LF.png",eraserBackgroundImage:"../../../../images/canvas_drawing/eraser-background_LF.png",plainBackgroungImage:"../../../../images/canvas_drawing/plain-background_LF.png",whiteBackgroundImage:"../../../../images/canvas_drawing/background-white_LF.png",outlineImage:e},$("#canvas_"+a).bind("mousedown",function(a){W(a.originalEvent)}),$("#canvas_"+a).bind("mousemove",function(a){Y(a.originalEvent)}),$(document.body).bind("mouseup",function(a){bb()}),$("#canvas_"+a).bind("touchstart",function(a){X(a.originalEvent)}),$("#canvas_"+a).bind("touchmove",function(a){Z(a.originalEvent)}),$("#canvas_"+a).bind("touchend",function(a){bc()}),$(document.body).bind("touchcancel",function(a){bc()}),$("#canvas_"+a).bind("hideYerStuff",function(a){U()}),$("#canvas_"+a).bind("showYerStuff",function(a){V()}),T(t,bg)}