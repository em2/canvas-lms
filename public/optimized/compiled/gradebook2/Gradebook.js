(function(){var a=function(a,b){return function(){return a.apply(b,arguments)}},b=Array.prototype.indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(this[b]===a)return b;return-1};define(["i18n!gradebook2","compiled/gradebook2/GRADEBOOK_TRANSLATIONS","jquery","compiled/grade_calculator","vendor/spin","compiled/multi_grid","compiled/SubmissionDetailsDialog","compiled/gradebook2/AssignmentGroupWeightsDialog","compiled/gradebook2/SubmissionCell","compiled/gradebook2/GradebookHeaderMenu","str/htmlEscape","jst/gradebook_uploads_form","jst/gradebook2/section_to_show_menu","jst/gradebook2/column_header","jst/gradebook2/group_total_cell","jst/gradebook2/row_student_name","jst/_avatar","jquery.ajaxJSON","jquery.instructure_date_and_time","jquery.instructure_jquery_patches","jquery.instructure_misc_helpers","jquery.instructure_misc_plugins","vendor/jquery.ba-tinypubsub","vendor/jquery.store","jqueryui/mouse","jqueryui/position","jqueryui/sortable","compiled/jquery.kylemenu","compiled/jquery/fixDialogButtons"],function(c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){var s;return s=function(){function t(b){var c;this.options=b,this.initGrid=a(this.initGrid,this),this.initHeader=a(this.initHeader,this),this.hoverMinimizedCell=a(this.hoverMinimizedCell,this),this.unminimizeColumn=a(this.unminimizeColumn,this),this.minimizeColumn=a(this.minimizeColumn,this),this.fixColumnReordering=a(this.fixColumnReordering,this),this.unhighlightColumns=a(this.unhighlightColumns,this),this.highlightColumn=a(this.highlightColumn,this),this.calculateStudentGrade=a(this.calculateStudentGrade,this),this.groupTotalFormatter=a(this.groupTotalFormatter,this),this.staticCellFormatter=a(this.staticCellFormatter,this),this.cellFormatter=a(this.cellFormatter,this),this.updateSubmissionsFromExternal=a(this.updateSubmissionsFromExternal,this),this.updateSubmission=a(this.updateSubmission,this),this.gotSubmissionsChunk=a(this.gotSubmissionsChunk,this),this.getSubmissionsChunks=a(this.getSubmissionsChunks,this),this.buildRows=a(this.buildRows,this),this.handleAssignmentMutingChange=a(this.handleAssignmentMutingChange,this),this.rowFilter=a(this.rowFilter,this),this.columnSortFn=a(this.columnSortFn,this),this.arrangeColumnsBy=a(this.arrangeColumnsBy,this),this.gotChunkOfStudents=a(this.gotChunkOfStudents,this),this.gotSections=a(this.gotSections,this),this.gotAssignmentGroups=a(this.gotAssignmentGroups,this),this.chunk_start=0,this.students={},this.rows=[],this.studentsPage=1,this.sortFn=function(a){return a.sortable_name},this.assignmentsToHide=(e.store.userGet("hidden_columns_"+this.options.context_code)||"").split(","),this.sectionToShow=Number(e.store.userGet("grading_show_only_section"+this.options.context_id))||void 0,this.show_attendance=e.store.userGet("show_attendance_"+this.options.context_code)==="true",this.include_ungraded_assignments=e.store.userGet("include_ungraded_assignments_"+this.options.context_code)==="true",e.subscribe("assignment_group_weights_changed",this.buildRows),e.subscribe("assignment_muting_toggled",this.handleAssignmentMutingChange),e.subscribe("submissions_updated",this.updateSubmissionsFromExternal),c=e.when(e.ajaxJSON(this.options.students_url,"GET"),e.ajaxJSON(this.options.assignment_groups_url,"GET",{},this.gotAssignmentGroups),e.ajaxJSON(this.options.sections_url,"GET",{},this.gotSections)).then(a(function(a){var b,c,d;return c=a[0],b=a[1],d=a[2],this.gotChunkOfStudents(c,d)},this)),this.spinner=new g,e(this.spinner.spin().el).css({opacity:.5,top:"50%",left:"50%"}).addClass("use-css-transitions-for-show-hide").appendTo("#main")}var s;return s={assignment:{min:10,max:200},assignmentGroup:{min:35,max:200},total:{min:85,max:100}},t.prototype.gotAssignmentGroups=function(a){var b,c,d,f,g;this.assignmentGroups={},this.assignments={},new j({context:this.options,assignmentGroups:a}),g=[];for(d=0,f=a.length;d<f;d++)c=a[d],m(c),this.assignmentGroups[c.id]=c,g.push(function(){var a,d,f,g;f=c.assignments,g=[];for(a=0,d=f.length;a<d;a++)b=f[a],m(b),b.assignment_group=c,b.due_at&&(b.due_at=e.parseFromISO(b.due_at)),g.push(this.assignments[b.id]=b);return g}.call(this));return g},t.prototype.gotSections=function(a){var b,c,d;this.sections={};for(c=0,d=a.length;c<d;c++)b=a[c],m(b),this.sections[b.id]=b;return this.sections_enabled=a.length>1},t.prototype.gotChunkOfStudents=function(a,b){var c,d,f,g,h,i,j,k;for(i=0,j=a.length;i<j;i++)f=a[i],d=f.user,d.enrollment=f,(g=this.students)[k=d.id]||(g[k]=m(d)),(h=this.students[d.id]).sections||(h.sections=[]),this.students[d.id].sections.push(f.course_section_id);return c=b.getResponseHeader("Link"),c&&c.match(/rel="next"/)?(this.studentsPage+=1,e.ajaxJSON(this.options.students_url,"GET",{page:this.studentsPage},this.gotChunkOfStudents)):this.gotAllStudents()},t.prototype.gotAllStudents=function(){var a,b,c,d,f,g,h,i;h=this.students;for(b in h){f=h[b],f.computed_current_score||(f.computed_current_score=0),f.computed_final_score||(f.computed_final_score=0),f.secondary_identifier=f.sis_login_id||f.login_id,this.sections_enabled&&(d=e.toSentence(function(){var a,b,d,e;d=f.sections,e=[];for(a=0,b=d.length;a<b;a++)c=d[a],e.push(this.sections[c].name);return e}.call(this).sort())),f.display_name=r({avatar_image_url:f.avatar_url,display_name:f.name,url:f.enrollment.grades.html_url,sectionNames:d}),i=this.assignments;for(b in i)a=i[b],f[g="assignment_"+b]||(f[g]={assignment_id:b,user_id:f.id});this.rows.push(f)}return this.initGrid(),this.buildRows(),this.getSubmissionsChunks(),this.initHeader()},t.prototype.arrangeColumnsBy=function(a){var b;return a&&a!==this._sortColumnsBy&&(this.$columnArrangementTogglers.each(function(){return e(this).closest("li").showIf(e(this).data("arrangeColumnsBy")!==a)}),this._sortColumnsBy=a,e.store[a==="due_date"?"userSet":"userRemove"]("sort_grade_colums_by_"+this.options.context_id,a),b=this.gradeGrid.getColumns(),b.sort(this.columnSortFn),this.gradeGrid.setColumns(b),this.fixColumnReordering(),this.buildRows()),this._sortColumnsBy||(this._sortColumnsBy=e.store.userGet("sort_grade_colums_by_"+this.options.context_id)||"assignment_group")},t.prototype.columnSortFn=function(a,b){var c,d,e,f,g,h;if(b.type==="total_grade")return-1;if(a.type==="total_grade")return 1;if(b.type==="assignment_group"&&a.type!=="assignment_group")return-1;if(a.type==="assignment_group"&&b.type!=="assignment_group")return 1;if(a.type==="assignment_group"&&b.type==="assignment_group")return a.object.position-b.object.position;if(a.type==="assignment"&&b.type==="assignment")return this.arrangeColumnsBy()==="assignment_group"?(e=a.object.assignment_group.position-b.object.assignment_group.position,f=a.object.position-b.object.position,e*1e6+f):(c=((g=a.object.due_at)!=null?g.timestamp:void 0)||Number.MAX_VALUE,d=((h=b.object.due_at)!=null?h.timestamp:void 0)||Number.MAX_VALUE,c===d?a.object.name===b.object.name?0:a.object.name>b.object.name?1:-1:c-d);throw"unhandled column sort condition"},t.prototype.rowFilter=function(a){var c;return!this.sectionToShow||(c=this.sectionToShow,b.call(a.sections,c)>=0)},t.prototype.handleAssignmentMutingChange=function(a){var b,c;return c=this.gradeGrid.getColumnIndex("assignment_"+a.id),b=this.gradeGrid.getColumns()[c],b.name=this.assignmentHeaderHtml(a),this.gradeGrid.setColumns(this.gradeGrid.getColumns()),this.fixColumnReordering(),this.buildRows()},t.prototype.buildRows=function(){var a,b,c,d,e,f,g,h,i,j;this.rows.length=0,d={},g=this.gradeGrid.getColumns();for(c in g)a=g[c],""+((h=a.object)!=null?h.submission_types:void 0)=="attendance"&&(a.unselectable=!this.show_attendance,a.cssClass=this.show_attendance?"":"completely-hidden",this.$grid.find("[id*='"+a.id+"']").showIf(this.show_attendance));i=this.students;for(c in i)e=i[c],e.row=-1,this.rowFilter(e)&&(this.rows.push(e),this.calculateStudentGrade(e),d[e.id]=this.sortFn(e));this.rows.sort(function(a,b){return d[a.id]<d[b.id]?-1:d[a.id]>d[b.id]?1:0}),j=this.rows;for(b=0,f=j.length;b<f;b++)e=j[b],e.row=b;return this.multiGrid.invalidate()},t.prototype.getSubmissionsChunks=function(){var a,b,c,d,f,g;g=[];for(;;){f=this.rows.slice(this.chunk_start,this.chunk_start+this.options.chunk_size);if(!f.length){this.allSubmissionsLoaded=!0;break}c={student_ids:function(){var a,b,c;c=[];for(a=0,b=f.length;a<b;a++)d=f[a],c.push(d.id);return c}(),assignment_ids:function(){var c,d;c=this.assignments,d=[];for(b in c)a=c[b],d.push(b);return d}.call(this),response_fields:["user_id","url","score","grade","submission_type","submitted_at","assignment_id","grade_matches_current_submission"]},e.ajaxJSON(this.options.submissions_url,"GET",c,this.gotSubmissionsChunk),g.push(this.chunk_start+=this.options.chunk_size)}return g},t.prototype.gotSubmissionsChunk=function(a){var b,c,d,e,f,g,h,i;for(e=0,g=a.length;e<g;e++){b=a[e],c=this.students[b.user_id],i=b.submissions;for(f=0,h=i.length;f<h;f++)d=i[f],this.updateSubmission(d);c.loaded=!0,this.multiGrid.invalidateRow(c.row),this.calculateStudentGrade(c)}return this.multiGrid.render()},t.prototype.updateSubmission=function(a){var b;return b=this.students[a.user_id],a.submitted_at&&(a.submitted_at=e.parseFromISO(a.submitted_at)),b["assignment_"+a.assignment_id]=a},t.prototype.updateSubmissionsFromExternal=function(a){var b,c,d,e;for(d=0,e=a.length;d<e;d++)c=a[d],b=this.students[c.user_id],this.updateSubmission(c),this.multiGrid.invalidateRow(b.row),this.calculateStudentGrade(b);return this.multiGrid.render()},t.prototype.cellFormatter=function(a,b,c){var d;return this.rows[a].loaded?c==null?this.staticCellFormatter(a,b,"-"):(d=this.assignments[c.assignment_id],d==null?this.staticCellFormatter(a,b,""):d.grading_type==="points"&&d.points_possible?k.out_of.formatter(a,b,c,d):(k[d.grading_type]||k).formatter(a,b,c,d)):this.staticCellFormatter(a,b,"")},t.prototype.staticCellFormatter=function(a,b,c){return"<div class='cell-content gradebook-cell'>"+c+"</div>"},t.prototype.groupTotalFormatter=function(a,b,c,d,e){var g,h;return c==null?"":(h=Math.round(c.score/c.possible*1e3)/10,isNaN(h)&&(h=0),c.possible&&this.options.grading_standard&&d.type==="total_grade"&&(g=f.letter_grade(this.options.grading_standard,h)),q({score:c.score,possible:c.possible,letterGrade:g,percentage:h}))},t.prototype.calculateStudentGrade=function(a){var b,c,d,e,f,g,h,i,j;if(a.loaded){b=this.include_ungraded_assignments?"final":"current",f=function(){var b;b=[];for(d in a)g=a[d],d.match(/^assignment_(?!group)/)&&b.push(g);return b}(),e=INST.GradeCalculator.calculate(f,this.assignmentGroups,this.options.group_weighting_scheme),j=e.group_sums;for(h=0,i=j.length;h<i;h++)c=j[h],a["assignment_group_"+c.group.id]=c[b];return a.total_grade=e[b]}},t.prototype.highlightColumn=function(a){var b;return isNaN(a)&&(b=a.currentTarget.className.match(/c\d+/),b&&(a=b.toString().replace("c",""))),this.$grid.find(".slick-header-column:eq("+a+")").addClass("hovered-column")},t.prototype.unhighlightColumns=function(){return this.$grid.find(".hovered-column").removeClass("hovered-column")},t.prototype.fixColumnReordering=function(){var b,c,d,f,g,h,i;return b=e("#gradebook_grid").find(".slick-header-columns"),h=b.sortable("option","items"),g='> *:not([id*="assignment_group"]):not([id*="total_grade"])',(f=function(){var a;return b.sortable("option","items",g),a=e(h,b).not(e(g,b)),a.data("sortable-item",null)})(),(d=a(function(){return b.find(".gradebook-header-drop").click(a(function(a){var b;return b=e(a.target),b.data("gradebookHeaderMenu")||b.data("gradebookHeaderMenu",new l(this.assignments[b.data("assignmentId")],b,this)),!1},this))},this))(),i=b.sortable("option","stop"),(c=function(){return b.sortable("option","stop",function(a,e){var g;return b.sortable("option","items",h),g=i.apply(this,arguments),f(),d(),c(),g})})()},t.prototype.minimizeColumn=function(a){var b,c;return b=a.index(),c=this.gradeGrid.getColumns()[b],c.cssClass=(c.cssClass||"").replace(" minimized","")+" minimized",c.unselectable=!0,c.unminimizedName=c.name,c.name="",c.minimized=!0,this.$grid.find(".l"+b).add(a).addClass("minimized"),this.assignmentsToHide.push(c.id),e.store.userSet("hidden_columns_"+this.options.context_code,e.uniq(this.assignmentsToHide).join(","))},t.prototype.unminimizeColumn=function(a){var b,c;return b=a.index(),c=this.gradeGrid.getColumns()[b],c.cssClass=(c.cssClass||"").replace(" minimized",""),c.unselectable=!1,c.name=c.unminimizedName,c.minimized=!1,this.$grid.find(".l"+b).add(a).removeClass("minimized"),a.find(".slick-column-name").html(c.name),this.assignmentsToHide=e.grep(this.assignmentsToHide,function(a){return a!==c.id}),e.store.userSet("hidden_columns_"+this.options.context_code,e.uniq(this.assignmentsToHide).join(","))},t.prototype.hoverMinimizedCell=function(b){var f,g,h,i,j,l,m;return f=e(b.currentTarget).removeClass("hover"),h=this.gradeGrid.getColumns()[f.index()],g=h.object,j=f.offset(),i=[g.name],f.hasClass("slick-cell")?(l=this.rows[this.gradeGrid.getCellFromEvent(b).row][h.id],g.points_possible!=null?i.push(""+((m=l.score)!=null?m:"--")+" / "+g.points_possible):l.score!=null&&i.push(l.score),Array.prototype.push.apply(i,e.map(k.classesBasedOnSubmission(l,g),a(function(a){return d["#submission_tooltip_"+a]},this)))):g.points_possible!=null&&i.push(c.t("points_out_of","out of %{points_possible}",{points_possible:g.points_possible})),f.data("tooltip",e("<span />",{"class":"gradebook-tooltip",css:{left:j.left-15,top:j.top,zIndex:1e4,display:"block"},html:i.join("<br />")}).appendTo("body").css("top",function(a,b){return parseInt(b)-e(this).outerHeight()}))},t.prototype.unhoverMinimizedCell=function(a){var b;if(b=e(this).data("tooltip"))return a.toElement===b[0]?b.mouseleave(function(){return b.remove()}):b.remove()},t.prototype.fixMaxHeaderWidth=function(){return this.$grid.find(".slick-header-columns").width(1e6)},t.prototype.onGridInit=function(){var b,c;return this.fixColumnReordering(),c={},e(this.spinner.el).remove(),e("#gradebook_wrapper").show(),this.$grid=b=e("#gradebook_grid").fillWindowWithMe({alsoResize:"#gradebook_students_grid",onResize:a(function(){return this.multiGrid.resizeCanvas()},this)}).delegate(".slick-cell",{"mouseenter.gradebook focusin.gradebook":this.highlightColumn,"mouseleave.gradebook focusout.gradebook":this.unhighlightColumns,"mouseenter focusin":function(a){return b.find(".hover, .focus").removeClass("hover focus"),e(this).addClass(a.type==="mouseenter"?"hover":"focus")},"mouseleave focusout":function(){return e(this).removeClass("hover focus")}}).delegate(".gradebook-cell-comment","click.gradebook",a(function(a){var b;return a.preventDefault(),b=e(a.currentTarget).data(),i.open(this.assignments[b.assignmentId],this.students[b.userId],this.options)},this)).delegate(".minimized",{mouseenter:this.hoverMinimizedCell,mouseleave:this.unhoverMinimizedCell}),this.fixMaxHeaderWidth(),e("#gradebook_grid .slick-resizable-handle").live("drag",a(function(b,c){return this.$grid.find(".slick-header-column").each(a(function(a,b){var c,d;c=e(b),d=this.gradeGrid.getColumns()[a];if(c.outerWidth()>minimumAssignmentColumWidth){if(d.minimized)return this.unminimizeColumn(c)}else if(!d.minimized)return this.minimizeColumn(c)},this))},this)),e(document).trigger("gridready")},t.prototype.initHeader=function(){var b,d,f,g,h,i,j,k,l;if(this.sections_enabled){g=c.t("all_sections","All Sections"),j=[{name:g,checked:!this.sectionToShow}],l=this.sections;for(h in l)i=l[h],j.push({name:i.name,id:h,checked:this.sectionToShow===h});b=e(o({sections:j,scrolling:j.length>15})),(k=a(function(){return e("#section_being_shown").html(this.sectionToShow?this.sections[this.sectionToShow].name:g)},this))(),e("#section_to_show").after(b).show().kyleMenu({buttonOpts:{icons:{primary:"ui-icon-sections",secondary:"ui-icon-droparrow"}}}),b.bind("menuselect",a(function(a,c){return this.sectionToShow=Number(b.find('[aria-checked="true"] input[name="section_to_show_radio"]').val())||void 0,e.store[this.sectionToShow?"userSet":"userRemove"]("grading_show_only_section"+this.options.context_id,this.sectionToShow),k(),this.buildRows()},this))}return d=e("#gradebook_settings").next(),e.each(["show_attendance","include_ungraded_assignments"],a(function(b,c){return d.find("#"+c).prop("checked",this[c]).change(a(function(a){return this[c]=e(a.target).is(":checked"),e.store.userSet(""+c+"_"+this.options.context_code,""+this[c]),c==="show_attendance"&&this.gradeGrid.setColumns(this.getVisibleGradeGridColumns()),this.buildRows()},this))},this)),e.detect(this.gradeGrid.getColumns(),function(){var a;return((a=this.object)!=null?a.submission_types:void 0)==="attendance"})||d.find("#show_attendance").hide(),this.$columnArrangementTogglers=e("#gradebook-toolbar [data-arrange-columns-by]").bind("click",a(function(a){var b;return a.preventDefault(),b=e(a.currentTarget).data("arrangeColumnsBy"),this.arrangeColumnsBy(b)},this)),this.arrangeColumnsBy("assignment_group"),e("#gradebook_settings").show().kyleMenu({buttonOpts:{icons:{primary:"ui-icon-cog",secondary:"ui-icon-droparrow"}}}),f=null,d.find(".gradebook_upload_link").click(a(function(a){var b;return a.preventDefault(),f||(b={download_gradebook_csv_url:""+this.options.context_url+"/gradebook.csv",action:""+this.options.context_url+"/gradebook_uploads",authenticityToken:e("#ajax_authenticity_token").text()},f=e(n(b)).dialog({bgiframe:!0,autoOpen:!1,modal:!0,width:720,resizable:!1}).fixDialogButtons().delegate("#gradebook-upload-help-trigger","click",function(){return e(this).hide(),e("#gradebook-upload-help").show()})),f.dialog("open")},this))},t.prototype.getVisibleGradeGridColumns=function(){var a,b,c,d,e,f;b=[],f=this.allAssignmentColumns;for(d=0,e=f.length;d<e;d++)a=f[d],c=""+a.object.submission_types,c==="not_graded"||c==="attendance"&&!this.show_attendance||b.push(a);return b.concat(this.aggregateColumns)},t.prototype.assignmentHeaderHtml=function(a){return p({assignment:a,href:a.html_url,showPointsPossible:a.points_possible!=null})},t.prototype.initGrid=function(){var d,f,g,i,j,l,m,n,o,p,q,r,t,u;return d=e('<span style="padding:10px" />').appendTo("#content"),u=function(a,b,c){var e;return e=Math.max(d.text(a).outerWidth(),b),Math.min(e,c)},this.parentColumns=[{id:"student",name:c.t("student_name","Student Name"),field:"display_name",width:150,cssClass:"meta-cell",resizable:!1,sortable:!0},{id:"secondary_identifier",name:c.t("secondary_id","Secondary ID"),field:"secondary_identifier",width:100,cssClass:"meta-cell secondary_identifier_cell",resizable:!1,sortable:!0}],this.allAssignmentColumns=function(){var c,d;c=this.assignments,d=[];for(n in c)f=c[n],q=f&&f.grading_type==="points"&&f.points_possible!=null&&k.out_of,o=q?70:90,i="assignment_"+n,g={id:i,field:i,name:this.assignmentHeaderHtml(f),object:f,formatter:this.cellFormatter,editor:q||k[f.grading_type]||k,minWidth:s.assignment.min,maxWidth:s.assignment.max,width:u(f.name,o,s.assignment.max),sortable:!0,toolTip:f.name,type:"assignment"},b.call(this.assignmentsToHide,i)>=0&&(g.width=10,a(function(b){return e(document).bind("gridready",a(function(){return this.minimizeColumn(this.$grid.find("[id*='"+b+"']"))},this)).unbind("gridready.render").bind("gridready.render",a(function(){return this.gradeGrid.invalidate()},this))},this)(i)),d.push(g);return d}.call(this),this.aggregateColumns=function(){var a,b;a=this.assignmentGroups,b=[];for(n in a)l=a[n],m=""+l.name,l.group_weight!=null&&(r=c.toPercentage(l.group_weight,{precision:0}),m+="<div class='assignment-points-possible'>\n  "+c.t("percent_of_grade","%{percentage} of grade",{percentage:r})+"\n</div>"),b.push({id:"assignment_group_"+n,field:"assignment_group_"+n,formatter:this.groupTotalFormatter,name:m,toolTip:l.name,object:l,minWidth:s.assignmentGroup.min,maxWidth:s.assignmentGroup.max,width:u(l.name,s.assignmentGroup.min,s.assignmentGroup.max),cssClass:"meta-cell assignment-group-cell",sortable:!0,type:"assignment_group"});return b}.call(this),this.aggregateColumns.push({id:"total_grade",field:"total_grade",formatter:this.groupTotalFormatter,name:"Total",minWidth:s.total.min,maxWidth:s.total.max,width:u("Total",s.total.min,s.total.max),cssClass:"total-cell",sortable:!0,type:"total_grade"}),d.remove(),p=e.extend({enableCellNavigation:!1,enableColumnReorder:!1,enableAsyncPostRender:!0,asyncPostRenderDelay:1,autoEdit:!0,rowHeight:35,headerHeight:38},this.options),j=[{selector:"#gradebook_students_grid",columns:this.parentColumns},{selector:"#gradebook_grid",columns:this.getVisibleGradeGridColumns(),options:{enableCellNavigation:!0,editable:!0,syncColumnCellResize:!0,enableColumnReorder:!0}}],this.multiGrid=new h(this.rows,p,j,1),this.gradeGrid=this.multiGrid.grids[1],this.gradeGrid.onCellChange.subscribe(a(function(a,b){return this.calculateStudentGrade(b.item),this.gradeGrid.invalidate()},this)),t=a(function(a){var b,c,d,e;this.rows.sort(a),e=this.rows;for(b=0,d=e.length;b<d;b++)c=e[b],c.row=b;return this.multiGrid.invalidate()},this),this.gradeGrid.onSort.subscribe(a(function(a,b){return t(function(a,c){var d,e,f,g;return d=(f=a[b.sortCol.field])!=null?f.score:void 0,e=(g=c[b.sortCol.field])!=null?g.score:void 0,!d&&d!==0&&(d=-99999999999),!e&&e!==0&&(e=-99999999999),b.sortAsc?e-d:d-e})},this)),this.multiGrid.grids[0].onSort.subscribe(a(function(a,b){var c;return c={display_name:"sortable_name",secondary_identifier:"secondary_identifier"}[b.sortCol.field],t(function(a,d){var e;return e=a[c]<d[c]?-1:a[c]>d[c]?1:0,b.sortAsc?e:0-e})},this)),this.multiGrid.parent_grid.onKeyDown.subscribe(function(){return!1}),this.onGridInit()},t}()})}).call(this)