(function(){var a={};define("use",{version:"0.2.0",load:function(b,c,d,e){var f=e.use&&e.use[b];if(!f)return d();a[b]={deps:f.deps||[],attach:f.attach},c(f.deps||[],function(){c([b],function(){return attach=f.attach,e.isBuild?d():typeof attach=="function"?d(attach.apply(window,arguments)):d(window[attach])})})},write:function(b,c,d){var e=a[c],f={attach:null,deps:""};typeof attach=="function"?f.attach="return "+e.attach.toString()+";":f.attach="return window['"+e.attach+"'];",e.deps.length&&(f.deps="'"+e.deps.toString().split(",").join("','")+"'"),d(["define('",b,"!",c,"', ","[",f.deps,"],","function() {",f.attach,"}",");\n"].join(""))}})})(),function(){function a(b,c,d){if(b===c)return b!==0||1/b==1/c;if(b==null||c==null)return b===c;b._chain&&(b=b._wrapped),c._chain&&(c=c._wrapped);if(b.isEqual&&x.isFunction(b.isEqual))return b.isEqual(c);if(c.isEqual&&x.isFunction(c.isEqual))return c.isEqual(b);var e=j.call(b);if(e!=j.call(c))return!1;switch(e){case"[object String]":return b==String(c);case"[object Number]":return b!=+b?c!=+c:b==0?1/b==1/c:b==+c;case"[object Date]":case"[object Boolean]":return+b==+c;case"[object RegExp]":return b.source==c.source&&b.global==c.global&&b.multiline==c.multiline&&b.ignoreCase==c.ignoreCase}if(typeof b!="object"||typeof c!="object")return!1;var f=d.length;while(f--)if(d[f]==b)return!0;d.push(b);var g=0,h=!0;if(e=="[object Array]"){g=b.length,h=g==c.length;if(h)while(g--)if(!(h=g in b==g in c&&a(b[g],c[g],d)))break}else{if("constructor"in b!="constructor"in c||b.constructor!=c.constructor)return!1;for(var i in b)if(x.has(b,i)){g++;if(!(h=x.has(c,i)&&a(b[i],c[i],d)))break}if(h){for(i in c)if(x.has(c,i)&&!(g--))break;h=!g}}return d.pop(),h}var b=this,c=b._,d={},e=Array.prototype,f=Object.prototype,g=Function.prototype,h=e.slice,i=e.unshift,j=f.toString,k=f.hasOwnProperty,l=e.forEach,m=e.map,n=e.reduce,o=e.reduceRight,p=e.filter,q=e.every,r=e.some,s=e.indexOf,t=e.lastIndexOf,u=Array.isArray,v=Object.keys,w=g.bind,x=function(a){return new E(a)};typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=x),exports._=x):b._=x,x.VERSION="1.3.1";var y=x.each=x.forEach=function(a,b,c){if(a==null)return;if(l&&a.forEach===l)a.forEach(b,c);else if(a.length===+a.length){for(var e=0,f=a.length;e<f;e++)if(e in a&&b.call(c,a[e],e,a)===d)return}else for(var g in a)if(x.has(a,g)&&b.call(c,a[g],g,a)===d)return};x.map=x.collect=function(a,b,c){var d=[];return a==null?d:m&&a.map===m?a.map(b,c):(y(a,function(a,e,f){d[d.length]=b.call(c,a,e,f)}),a.length===+a.length&&(d.length=a.length),d)},x.reduce=x.foldl=x.inject=function(a,b,c,d){var e=arguments.length>2;a==null&&(a=[]);if(n&&a.reduce===n)return d&&(b=x.bind(b,d)),e?a.reduce(b,c):a.reduce(b);y(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)});if(!e)throw new TypeError("Reduce of empty array with no initial value");return c},x.reduceRight=x.foldr=function(a,b,c,d){var e=arguments.length>2;a==null&&(a=[]);if(o&&a.reduceRight===o)return d&&(b=x.bind(b,d)),e?a.reduceRight(b,c):a.reduceRight(b);var f=x.toArray(a).reverse();return d&&!e&&(b=x.bind(b,d)),e?x.reduce(f,b,c,d):x.reduce(f,b)},x.find=x.detect=function(a,b,c){var d;return z(a,function(a,e,f){if(b.call(c,a,e,f))return d=a,!0}),d},x.filter=x.select=function(a,b,c){var d=[];return a==null?d:p&&a.filter===p?a.filter(b,c):(y(a,function(a,e,f){b.call(c,a,e,f)&&(d[d.length]=a)}),d)},x.reject=function(a,b,c){var d=[];return a==null?d:(y(a,function(a,e,f){b.call(c,a,e,f)||(d[d.length]=a)}),d)},x.every=x.all=function(a,b,c){var e=!0;return a==null?e:q&&a.every===q?a.every(b,c):(y(a,function(a,f,g){if(!(e=e&&b.call(c,a,f,g)))return d}),!!e)};var z=x.some=x.any=function(a,b,c){b||(b=x.identity);var e=!1;return a==null?e:r&&a.some===r?a.some(b,c):(y(a,function(a,f,g){if(e||(e=b.call(c,a,f,g)))return d}),!!e)};x.include=x.contains=function(a,b){var c=!1;return a==null?c:s&&a.indexOf===s?a.indexOf(b)!=-1:(c=z(a,function(a){return a===b}),c)},x.invoke=function(a,b){var c=h.call(arguments,2);return x.map(a,function(a){return(x.isFunction(b)?b||a:a[b]).apply(a,c)})},x.pluck=function(a,b){return x.map(a,function(a){return a[b]})},x.max=function(a,b,c){if(!b&&x.isArray(a)&&a[0]===+a[0])return Math.max.apply(Math,a);if(!b&&x.isEmpty(a))return-Infinity;var d={computed:-Infinity};return y(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g>=d.computed&&(d={value:a,computed:g})}),d.value},x.min=function(a,b,c){if(!b&&x.isArray(a)&&a[0]===+a[0])return Math.min.apply(Math,a);if(!b&&x.isEmpty(a))return Infinity;var d={computed:Infinity};return y(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g<d.computed&&(d={value:a,computed:g})}),d.value},x.shuffle=function(a){var b=[],c;return y(a,function(a,d,e){d==0?b[0]=a:(c=Math.floor(Math.random()*(d+1)),b[d]=b[c],b[c]=a)}),b},x.sortBy=function(a,b,c){return x.pluck(x.map(a,function(a,d,e){return{value:a,criteria:b.call(c,a,d,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;return c<d?-1:c>d?1:0}),"value")},x.groupBy=function(a,b){var c={},d=x.isFunction(b)?b:function(a){return a[b]};return y(a,function(a,b){var e=d(a,b);(c[e]||(c[e]=[])).push(a)}),c},x.sortedIndex=function(a,b,c){c||(c=x.identity);var d=0,e=a.length;while(d<e){var f=d+e>>1;c(a[f])<c(b)?d=f+1:e=f}return d},x.toArray=function(a){return a?a.toArray?a.toArray():x.isArray(a)?h.call(a):x.isArguments(a)?h.call(a):x.values(a):[]},x.size=function(a){return x.toArray(a).length},x.first=x.head=function(a,b,c){return b!=null&&!c?h.call(a,0,b):a[0]},x.initial=function(a,b,c){return h.call(a,0,a.length-(b==null||c?1:b))},x.last=function(a,b,c){return b!=null&&!c?h.call(a,Math.max(a.length-b,0)):a[a.length-1]},x.rest=x.tail=function(a,b,c){return h.call(a,b==null||c?1:b)},x.compact=function(a){return x.filter(a,function(a){return!!a})},x.flatten=function(a,b){return x.reduce(a,function(a,c){return x.isArray(c)?a.concat(b?c:x.flatten(c)):(a[a.length]=c,a)},[])},x.without=function(a){return x.difference(a,h.call(arguments,1))},x.uniq=x.unique=function(a,b,c){var d=c?x.map(a,c):a,e=[];return a.length<3&&(b=!0),x.reduce(d,function(c,d,f){if(b?x.last(c)!==d||!c.length:!x.include(c,d))c.push(d),e.push(a[f]);return c},[]),e},x.union=function(){return x.uniq(x.flatten(arguments,!0))},x.intersection=x.intersect=function(a){var b=h.call(arguments,1);return x.filter(x.uniq(a),function(a){return x.every(b,function(b){return x.indexOf(b,a)>=0})})},x.difference=function(a){var b=x.flatten(h.call(arguments,1),!0);return x.filter(a,function(a){return!x.include(b,a)})},x.zip=function(){var a=h.call(arguments),b=x.max(x.pluck(a,"length")),c=new Array(b);for(var d=0;d<b;d++)c[d]=x.pluck(a,""+d);return c},x.indexOf=function(a,b,c){if(a==null)return-1;var d,e;if(c)return d=x.sortedIndex(a,b),a[d]===b?d:-1;if(s&&a.indexOf===s)return a.indexOf(b);for(d=0,e=a.length;d<e;d++)if(d in a&&a[d]===b)return d;return-1},x.lastIndexOf=function(a,b){if(a==null)return-1;if(t&&a.lastIndexOf===t)return a.lastIndexOf(b);var c=a.length;while(c--)if(c in a&&a[c]===b)return c;return-1},x.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=arguments[2]||1;var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=new Array(d);while(e<d)f[e++]=a,a+=c;return f};var A=function(){};x.bind=function(a,b){var c,d;if(a.bind===w&&w)return w.apply(a,h.call(arguments,1));if(!x.isFunction(a))throw new TypeError;return d=h.call(arguments,2),c=function(){if(this instanceof c){A.prototype=a.prototype;var e=new A,f=a.apply(e,d.concat(h.call(arguments)));return Object(f)===f?f:e}return a.apply(b,d.concat(h.call(arguments)))}},x.bindAll=function(a){var b=h.call(arguments,1);return b.length==0&&(b=x.functions(a)),y(b,function(b){a[b]=x.bind(a[b],a)}),a},x.memoize=function(a,b){var c={};return b||(b=x.identity),function(){var d=b.apply(this,arguments);return x.has(c,d)?c[d]:c[d]=a.apply(this,arguments)}},x.delay=function(a,b){var c=h.call(arguments,2);return setTimeout(function(){return a.apply(a,c)},b)},x.defer=function(a){return x.delay.apply(x,[a,1].concat(h.call(arguments,1)))},x.throttle=function(a,b){var c,d,e,f,g,h=x.debounce(function(){g=f=!1},b);return function(){c=this,d=arguments;var i=function(){e=null,g&&a.apply(c,d),h()};e||(e=setTimeout(i,b)),f?g=!0:a.apply(c,d),h(),f=!0}},x.debounce=function(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,c||a.apply(e,f)};c&&!d&&a.apply(e,f),clearTimeout(d),d=setTimeout(g,b)}},x.once=function(a){var b=!1,c;return function(){return b?c:(b=!0,c=a.apply(this,arguments))}},x.wrap=function(a,b){return function(){var c=[a].concat(h.call(arguments,0));return b.apply(this,c)}},x.compose=function(){var a=arguments;return function(){var b=arguments;for(var c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},x.after=function(a,b){return a>0?function(){if(--a<1)return b.apply(this,arguments)}:b()},x.keys=v||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[];for(var c in a)x.has(a,c)&&(b[b.length]=c);return b},x.values=function(a){return x.map(a,x.identity)},x.functions=x.methods=function(a){var b=[];for(var c in a)x.isFunction(a[c])&&b.push(c);return b.sort()},x.extend=function(a){return y(h.call(arguments,1),function(b){for(var c in b)a[c]=b[c]}),a},x.defaults=function(a){return y(h.call(arguments,1),function(b){for(var c in b)a[c]==null&&(a[c]=b[c])}),a},x.clone=function(a){return x.isObject(a)?x.isArray(a)?a.slice():x.extend({},a):a},x.tap=function(a,b){return b(a),a},x.isEqual=function(b,c){return a(b,c,[])},x.isEmpty=function(a){if(a==null)return!0;if(x.isArray(a)||x.isString(a))return a.length===0;for(var b in a)if(x.has(a,b))return!1;return!0},x.isElement=function(a){return!!a&&a.nodeType==1},x.isArray=u||function(a){return j.call(a)=="[object Array]"},x.isObject=function(a){return a===Object(a)},x.isArguments=function(a){return j.call(a)=="[object Arguments]"},x.isArguments(arguments)||(x.isArguments=function(a){return!!a&&!!x.has(a,"callee")}),x.isFunction=function(a){return j.call(a)=="[object Function]"},x.isString=function(a){return j.call(a)=="[object String]"},x.isNumber=function(a){return j.call(a)=="[object Number]"},x.isNaN=function(a){return a!==a},x.isBoolean=function(a){return a===!0||a===!1||j.call(a)=="[object Boolean]"},x.isDate=function(a){return j.call(a)=="[object Date]"},x.isRegExp=function(a){return j.call(a)=="[object RegExp]"},x.isNull=function(a){return a===null},x.isUndefined=function(a){return a===void 0},x.has=function(a,b){return k.call(a,b)},x.noConflict=function(){return b._=c,this},x.identity=function(a){return a},x.times=function(a,b,c){for(var d=0;d<a;d++)b.call(c,d)},x.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},x.mixin=function(a){y(x.functions(a),function(b){G(b,x[b]=a[b])})};var B=0;x.uniqueId=function(a){var b=B++;return a?a+b:b},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var C=/.^/,D=function(a){return a.replace(/\\\\/g,"\\").replace(/\\'/g,"'")};x.template=function(a,b){var c=x.templateSettings,d="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+a.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(c.escape||C,function(a,b){return"',_.escape("+D(b)+"),'"}).replace(c.interpolate||C,function(a,b){return"',"+D(b)+",'"}).replace(c.evaluate||C,function(a,b){return"');"+D(b).replace(/[\r\n\t]/g," ")+";__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",e=new Function("obj","_",d);return b?e(b,x):function(a){return e.call(this,a,x)}},x.chain=function(a){return x(a).chain()};var E=function(a){this._wrapped=a};x.prototype=E.prototype;var F=function(a,b){return b?x(a).chain():a},G=function(a,b){E.prototype[a]=function(){var a=h.call(arguments);return i.call(a,this._wrapped),F(b.apply(x,a),this._chain)}};x.mixin(x),y(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=e[a];E.prototype[a]=function(){var c=this._wrapped;b.apply(c,arguments);var d=c.length;return(a=="shift"||a=="splice")&&d===0&&delete c[0],F(c,this._chain)}}),y(["concat","join","slice"],function(a){var b=e[a];E.prototype[a]=function(){return F(b.apply(this._wrapped,arguments),this._chain)}}),E.prototype.chain=function(){return this._chain=!0,this},E.prototype.value=function(){return this._wrapped}}.call(this),define("underscore",function(){}),define("use!underscore",[],function(){return window._}),define("translations/gradebook",["i18nObj","jquery"],function(a,b){b.extend(!0,a,{translations:{em2:{gradebook:{alerts:{no_active_students:"Sorry, there are either no active students in the class or none are gradable by you."},confirms:{unsaved_changes:"The following students have unsaved changes to their assessment submissions: \n%{users}\nContinue anyway?"},links:{finish_scoring:"Finish Scoring this Assessment",view_quiz:"View this Assessment"}}},es:{gradebook:{alerts:{no_active_students:"Perdón, no hay estudiantes activos en este curso o no pueden ser calificados por usted.",no_students_in_section:"No se pudieron encontrar estudiantes en esa sección, regresando para mostrar todas las secciones.",none_to_update:"Nada que Actualizar",scores_updated:{one:"1 calificación de estudiante actualizada",other:"%{count} calificaciones de estudiantes actualizados"},students_updated:{one:"1 Estudiante Actualizado",other:"%{count} estudiantes actualizados"}},assignment_details:"Detalles de la Tarea",buttons:{change_section:"Cambiar Sección",saving_settings:"Guardar Configuraciones...",submit_comment:"Enviar Comentario",submitting:"Enviando...",upload_data:"Cargar Información"},cancel_button:"Cancelar",click_to_change:"Haga click para probar una calificación diferente",click_to_expand:"Haga click para expandir",computing_grades:"Computando Calificaciones...",confirms:{delete_comment:"¿Seguro que quiere borrar este comentario?",unsaved_changes:"Los siguientes estudiantes tienen cambios no guardados en los envíos de sus evaluaciones: \n%{users}\n¿Continuar?"},curve_grade_for_course:"Aplicar Curva a %{assignment}",curve_grades:"Aplicar Curva a los Grados",default_grade_for_course:"Calificación Predeterminada para %{assignment}",download_scores:"Descargar Calificaciones (%{format})",download_submissions:"Descargar los Envíos",edit_view_rubric:"Ver Rúbrica",errors:{failed_to_load:"El libro de calificaciones no se pudo cargar, intente recargar la página",none_to_update:"Nada que Actualizar",select_an_option:"Por favor seleccione una opción",upload_as_zip:"Por favor cargue los archivos como un .zip"},grade:"grado: %{grade}",graded_by_me:"%{graded_time} por mí",graded_then_resubmitted:"calificado, luego reenviado (%{when})",hide_all_things:"Esconder %{things}",hide_column:"Esconder Columna",hide_student_name:"Esconder los Nombres de los Estudiantes",ignore_ungraded:"Ignorar Tareas No Calificadas",include_ungraded:"Incluír Tareas Actualizadas",labels:{details:"Detalles"},links:{download_attachment:"Descargando %{attachment}",finish_scoring:"Terminar la Calificación de esta Evaluación",go_to_submission:"Ir al URL de Envío",submission_details:"Detalles de Envío",view_quiz:"Ver esta Evaluación",view_submission:"Ver Envío"},loud_late:"TARDE",message_students_who:"Enviar Mensaje a Estudiante Que...",mute_assignment:"Obviar Tarea",new_assessment:"[Tarea Nueva]",no_submission_time:"ningun tiempo de envío",nth_student:"Estudiante %{n}",percent:"Porcentaje",publish_to_sis:"Publicar calificaciones a SIS",reupload_submission_files:"Recargar los Archivos de Envío",reupload_submissions:"Recargar los Envíos",set_default_grade:"Establecer Calificación Predeterminada",set_group_weights:"Establecer Peso por Grupo",show_student_name:"Mostrar los Nombres de Estudiantes",showing_all_sections:"Mostrando Todas las Secciones",showing_section:"Mostrando la Sección: %{section}",sort_columns_by:"Ordenar Columnas Por...",sort_rows_by:"Ordenar Filas Por...",speed_grader:"Calificador Rápido",student:"Estudiante",student_mute_notification:"El instructor está trabajando en las calificaciones",student_name:"Nombre del Estudiante",students_who:{havent_submitted_yet:"Aún no ha enviado",scored_less_than:"Obtuvo menos de",scored_more_than:"Obtuvo más de"},submission_information:"Información del Envío",teacher_muted_title:"Tarea ha sido obviada",titles:{assignment_groups:"Grupos de Trabajo",click_to_record:"Haga click en el micrófono para grabar sus comentarios",dropped_assignment_no_total:"Esta tarea no será considerada en el cálculo total",hypothetical_score:'Esta es una calificación "que pasa si"',loading:"Cargando...",turnitin_score:"Calificación de Similaridad de Turnitin -- más información"},tooltips:{submission_dropped:"Este envío se eliminó para la calificación",submitted_late:"Este envío se envió tarde"},unmute_assignment:"Activar Tarea",unmute_button:"Activar la Tarea",upload_scores:"Cargar Calificaciones (desde %{format})",view_grading_history:"Ver el Historial de Calificación"},not_applicable:"N/A"}}})}),define("translations/message_students",["i18nObj","jquery"],function(a,b){b.extend(!0,a,{translations:{es:{message_students:{buttons:{send_message:"Enviar Mensaje",send_message_failed:"Envío del Mensaje Falló, intente de nuevo",sending_message:"Enviando Mensaje..."},message_student:"Enviar Mensaje a Estudiantes para %{course_name}",send_message:"Enviar el Mensaje"}}}})}),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}};define("compiled/grade_calculator",["INST","jquery","jquery.instructure_misc_helpers"],function(b,c){var d;return d=function(){function b(){}return b.calculate=function(b,d,e){var f;return f={},f.group_sums=c.map(d,a(function(a){return{group:a,current:this.create_group_sum(a,b,!0),"final":this.create_group_sum(a,b,!1)}},this)),f.current=this.calculate_total(f.group_sums,!0,e),f["final"]=this.calculate_total(f.group_sums,!1,e),f},b.create_group_sum=function(a,b,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D;l={submissions:[],score:0,possible:0,submission_count:0},w=a.assignments;for(m=0,q=w.length;m<q;m++){e=w[m],f={score:0,possible:0,percent:0,drop:!1,submitted:!1},k=c.detect(b,function(){return this.assignment_id===e.id}),k==null&&(k={score:null}),k.assignment_group_id=a.id,(x=k.points_possible)==null&&(k.points_possible=e.points_possible),f.submission=k,l.submissions.push(f);if(!d||k.score!=null&&k.score!=="")f.score=this.parse(k.score),f.possible=this.parse(e.points_possible),f.percent=this.parse(f.score/f.possible),f.submitted=k.score!=null&&k.score!=="",f.submitted&&(l.submission_count+=1)}l.submissions.sort(function(a,b){return a.percent-b.percent}),i=c.extend({drop_lowest:0,drop_highest:0,never_drop:[]},a.rules),g=0,y=["low","high"];for(n=0,r=y.length;n<r;n++){h=y[n],z=l.submissions;for(o=0,s=z.length;o<s;o++)f=z[o],!f.drop&&i["drop_"+h+"est"]>0&&c.inArray(f.assignment_id,i.never_drop)===-1&&f.possible>0&&f.submitted&&(f.drop=!0,(A=f.submission)!=null&&(A.drop=!0),i["drop_"+h+"est"]-=1,g+=1)}g>0&&g===l.submission_count&&(l.submissions[l.submissions.length-1].drop=!1,(B=l.submissions[l.submissions.length-1].submission)!=null&&(B.drop=!1),g-=1),l.submission_count-=g,C=l.submissions;for(p=0,t=C.length;p<t;p++)j=C[p],j.drop||(l.score+=j.score);D=l.submissions;for(v=0,u=D.length;v<u;v++)j=D[v],j.drop||(l.possible+=j.possible);return l},b.calculate_total=function(a,b,c){var d,e,f,g,h,i,j,k,l;e=b?"current":"final";if(c==="percent"){h=0,g=0,j=0;for(k=0,l=a.length;k<l;k++)d=a[k],d.group.group_weight>0&&(d[e].submission_count>0&&d[e].possible>0&&(i=d[e].score/d[e].possible,h+=d.group.group_weight*i,g+=d.group.group_weight),j+=d.group.group_weight);return b&&g<100&&(f=j<100?j:100,h=h*f/g),{score:h,possible:100}}return{score:this.sum(function(){var b,c,f;f=[];for(b=0,c=a.length;b<c;b++)d=a[b],f.push(d[e].score);return f}()),possible:this.sum(function(){var b,c,f;f=[];for(b=0,c=a.length;b<c;b++)d=a[b],f.push(d[e].possible);return f}())}},b.sum=function(a){var b,c,d,e;b=0;for(d=0,e=a.length;d<e;d++)c=a[d],b+=c;return b},b.parse=function(a){var b;return b=parseFloat(a),b&&isFinite(b)?b:0},b.letter_grade=function(a,b){var d,e;return b<0&&(b=0),e=c.grep(a,function(c,d){return b>=c[1]*100||d===a.length-1}),d=e[0],d[0]},b}(),window.INST.GradeCalculator=d})}.call(this),define("datagrid",["INST","jquery","ajax_errors","jquery.instructure_jquery_patches","jquery.instructure_misc_plugins","jquery.keycodes","jquery.scrollToVisible","vendor/jquery.scrollTo","jqueryui/position"],function(a,b){var c={columns:[],rows:[],dataRows:[],dataFragment:document.createDocumentFragment(),cells:{},divs:{},init:function(d,e){var f=e.onReady,g=e.tick,h=e.maxWidth||150;c.borderSize=e.borderSize||1,e.scroll&&b.isFunction(e.scroll)&&(c.scrollCallback=e.scroll),c.table=d,c.toggleCallback=e.toggle;var i=d.find("tr:first td"),j=d.find("tr"),k=0;i.each(function(a){var d=c.columns[a]=b(this);d.metrics={width:Math.min(d.width(),h),outerWidth:Math.min(d.outerWidth(),h+1)},k+=d.metrics.outerWidth});var l=0;j.each(function(a){var d=c.rows[a]=b(this);d.metrics={outerHeight:d.find("td:first").outerHeight(),height:d.find("td:first").height()},l+=d.metrics.height}),g&&b.isFunction(g)&&g(),c.divs.all=b(".datagrid"),c.divs.topleft=b("#datagrid_topleft"),c.divs.left=b("#datagrid_left"),c.divs.top=b("#datagrid_top"),c.divs.data=b("#datagrid_data"),c.divs.filler=b("#datagrid_filler"),c.divs.topleft.width(c.columns[0].metrics.width+c.borderSize),c.divs.left.width(c.columns[0].metrics.width+c.borderSize),c.divs.filler.width(k-c.columns[0].metrics.width),c.divs.top.height(c.rows[0].metrics.height+c.borderSize),c.divs.topleft.height(c.rows[0].metrics.height+c.borderSize),c.divs.filler.height(l-c.rows[0].metrics.height),c._initializeListeners(),c._templateCellHTML=e.templateCellHTML,c.sizeToWindow(),b(window).resize(c.sizeToWindow);var m=c._createRow(0,!0);m.append(c._createCell(0,0,d.find("tr:first td:first"))),c.divs.topleft.children(".content:first").append(m),m=c._createRow(0),m.width(k-c.columns[0].metrics.outerWidth),d.find("tr:first").children("td:not(:first)").each(function(a){m.append(c._createCell(0,a+1,b(this)))}),c.divs.top.children(".content:first").append(m),g&&b.isFunction(g)&&g();var n=!1,o=function(a){n||(m=c._createRow(a+1,!0),m.append(c._createCell(a+1,0,b(this).find("td:first"))),c.divs.left.children(".content:first").append(m)),m=c._createRow(a+1),b(this).children("td:not(:first)").each(function(d){c._createCell(a+1,d+1,b(this)),c._placeDataCell(a+1,d+1)}),c._placeDataRow(a+1)},p=[],q=0,r=0;d.find("tr:not(:first)").each(function(a){var d=0;m=c._createRow(a+1,!0),m.append(c._createCell(a+1,0,b(this).find("td:first"))),c.divs.left.children(".content:first").append(m),m=c._createRow(a+1),m.width(k-c.columns[0].metrics.outerWidth),b(this).children("td:not(:first)").each(function(a){d+=c.columns[a+1].metrics.width}),c._placeDataRow(a+1),q+=c.rows[a+1].metrics.height,p.push(b(this))}),n=!0,c._placeDataFragment(),e&&e.onViewable&&b.isFunction(e.onViewable)&&e.onViewable.call(this);var s=0,t=function(e){try{g&&b.isFunction(g)&&e&&g();if(s<p.length){var h=s;s++,o.call(p[h],h),setTimeout(function(){t(!0)},1)}else if(e&&!t.finished){t.finished=!0,c.initialized=!0,d.hide(),c.ready&&b.isFunction(c.ready)&&c.ready(),f&&b.isFunction(f)&&f();if(a.browser.ff){var i=b("#datagrid_top"),j=i.find(".row"),k=j.add("#datagrid_data .row");function l(){var a=i.width();i.width(99999999),j.css({position:"relative",width:""});var b=j.width()+1;i.width(a),j.css("position",""),k.width(b)}l();var m;b(window).resize(function(){clearTimeout(m),m=setTimeout(l,100)})}}}catch(n){a.log_error({message:n.toString()})}};setTimeout(function(){t(!0)},5),setTimeout(function(){t(!1)},5),setTimeout(function(){t(!1)},5),setTimeout(function(){t(!1)},5);var u=c.divs.top.children(".content:first"),v=c.divs.left.children(".content:first"),w=!1;setInterval(function(){if(!w)return;u.length===0&&(u=c.divs.top.children(".content:first")),v.length===0&&(v=c.divs.left.children(".content:first")),u.css("left",0-c.divs.data.scrollLeft()),v.css("top",0-c.divs.data.scrollTop()),c.scrollCallback&&c.scrollCallback(),w=!1},100),c.divs.data.bind("scroll",function(){w=!0}),c.mouseHasMoved=!0,b(document).mousemove(function(a){c.mouseHasMoved=!0}),b(document).keycodes("up down left right tab shift+tab",function(a){if(b(a.target).closest(".ui-dialog").length>0)return;a.preventDefault(),a.stopPropagation(),a.keyString=="right"||a.keyString=="tab"?c.moveRight():a.keyString=="down"?c.moveDown():a.keyString=="up"?c.moveUp():(a.keyString=="left"||a.keyString=="shift+tab")&&c.moveLeft()})},_initializeListeners:function(){c.divs.all.delegate(".cell","mousemove",c._cellMove).delegate(".cell","mouseover",c._cellOver).delegate(".cell","mouseout",c._cellOut).delegate(".cell","click",c._cellClick)},titles:function(a){var b=[];for(var d in a){var e=c.cells["0,"+a[d]];b.push(e.find(".assignment_title").text()||"--")}},reorderColumns:function(a){var b={},d=[],e=[];for(var f=0;f<a.length;f++)e[f]=f;for(var g=0;g<a.length;g++){var h=a[g];for(var i=0;i<c.rows.length;i++){var j=c.cells[i+","+h],k=c.cells[i+","+e[g]];e[g]!=h&&(e[g]<h?c.cells[i+","+e[g]].before(j):c.cells[i+","+e[g]].after(j)),b[i+","+g]=c.cells[i+","+h],b[i+","+g].column=g,b[i+","+g].data("datagrid_position",{row:i,column:g}),b[i+","+g].data("column",g),d[g]=c.columns[h]}var l=-1;for(var f=0;f<e.length;f++)e[f]==h&&(l=f);g!=l&&(g<l?(e.splice(g,0,h),e.splice(l+1,1)):(e.splice(g,0,h),e.splice(l,1)))}c.cells=b,c.columns=d},reorderRows:function(a){var b={},d=[],e=[];for(var f=0;f<a.length;f++)e[f]=f;var g=0;for(var h=0;h<a.length;h++){var i=a[h],j=c.cells[i+",0"].parents(".row"),k=c.cells[i+",1"].parents(".row");k.css("top",g),j.css("top",g),h>0&&(g=g+c.rows[i].metrics.height+1),e[h]!=i&&(e[h]<i?(c.cells[e[h]+",0"].parents(".row").before(j),c.cells[e[h]+",1"].parents(".row").before(k)):(c.cells[e[h]+",0"].parents(".row").after(j),c.cells[e[h]+",1"].parents(".row").after(k))),d[h]=c.rows[i];for(var l=0;l<c.columns.length;l++){var m=c.cells[i+","+l];b[h+","+l]=c.cells[i+","+l],b[h+","+l].row=h,b[h+","+l].data("datagrid_position",{row:h,column:l}),b[h+","+l].data("row",h),d[h]=c.rows[i]}var n=-1;for(var f=0;f<e.length;f++)e[f]==i&&(n=f);h!=n&&(h<n?(e.splice(h,0,i),e.splice(n+1,1)):(e.splice(h,0,i),e.splice(n,1)))}c.cells=b,c.rows=d},moveColumn:function(a,b){new_order=[];if(a==0||b==0||a==b)return;for(var d=0;d<c.columns.length;d++)d==b?new_order.push(a):d>=b&&d<=a||d<=b&&d>=a?b<a?new_order.push(d-1):new_order.push(d+1):new_order.push(d);c.reorderColumns(new_order)},_placeDataCell:function(a,b){if(a<1||b<1)return;var d=c.cells[a+","+b];if(d&&d.placed)return;var e=c.dataRows[a];e&&(e.append(d),d.placed=!0)},_initializeCell:function(a,d){if(!c.cells[a+","+d]){var e=["cell"];a===0&&e.push("column_header"),d===0&&e.push("row_header"),d!==0&&a!==0&&e.push("data_cell");var f=b(["<div class='",e.join(" "),"' style='visibility: hidden; height:",c.rows[a].metrics.height,"px; width:",c.columns[d].metrics.width,"px;' data-row='",a,"' data-column='",d,"'/>"].join("")).data({row:a,column:d});f.row=a,f.column=d,c.cells[a+","+d]=f}return c.cells[a+","+d]},_createCell:function(a,b,d){var e=c._initializeCell(a,b);return e.transferred?e:(a!=0&&b!=0&&c._templateCellHTML?e.append(c._templateCellHTML(a,b)):e.append(d.children()),e.attr("id",d.attr("id")),d.attr("id","original_"+e.attr("id")),e.originalTD=d,e.addClass(d.attr("class")),e.css("visibility",""),e.transferred=!0,e)},_trigger:function(a,d,e){var f=b.Event(a);f.originalEvent=d,f.originalTarget=e,c.table.trigger(f,{cell:e,trueEvent:d&&d.originalEvent})},_cellClick:function(a){var d=c.position(b(this)),e=c.cells[d.row+","+d.column];if(c.columns[e.column].hidden){c.toggleColumn(e.column);return}c._trigger("entry_click",a,e)},_cellMove:function(a){if(c.disableHighlights)return;var d=c.position(b(this)),e=c.cells[d.row+","+d.column];c.table.trigger("entry_move",e);if(b(this).index(c.currentHover)!=-1)return;e.trigger("mouseover")},_cellOver:function(a){if(c.disableHighlights)return;if(a.originalEvent&&!c.mouseHasMoved)return;c.mouseHasMoved=!1;var d=c.position(b(this)),e=c.cells[d.row+","+d.column];e.addClass("selected"),c.currentHover&&e.index(c.currentHover)==-1&&b(c.currentHover).trigger("mouseout"),c.currentHover=e;if(e.row==0)for(var f=1;f<c.rows.length;f++)c.cells[f+","+e.column].addClass("related");else if(e.column==0)for(var f=1;f<c.columns.length;f++)c.cells[e.row+","+f].addClass("related");else c.cells[e.row+","+0].addClass("related"),c.cells["0,"+e.column].addClass("related");c._trigger("entry_over",a,e)},_cellOut:function(a){if(c.disableHighlights)return;if(b(a.target).parents("div").index(this)!=-1)return;var d=c.position(b(this)),e=c.cells[d.row+","+d.column];e.removeClass("selected");if(e.row==0)for(var f=1;f<c.rows.length;f++)c.cells[f+","+e.column].removeClass("related");else if(e.column==0)for(var f=1;f<c.columns.length;f++)c.cells[e.row+","+f].removeClass("related");else c.cells[e.row+","+0].removeClass("related"),c.cells["0,"+e.column].removeClass("related");c._trigger("entry_out",a,e)},_placeDataFragment:function(){c.dataFragment&&(c.divs.data.find(".content:first")[0].appendChild(c.dataFragment),c.dataFragment=null)},_placeDataRow:function(a){if(a<1)return;var b=c.dataRows[a]||c._createRow(a);if(b.placed)return;c.dataFragment?c.dataFragment.appendChild(b[0]):c.divs.data.find(".content:first").append(b),b.placed=!0},_createRow:function(a,d){if(c.dataRows[a])return c.dataRows[a];var e=document.createDocumentFragment(),f=b(document.createElement("div")).addClass("row");e.appendChild(f[0]),f.height(c.rows[a].metrics.height);var g=0;for(var h=1;h<a;h++)g+=c.rows[h].metrics.height+1;var i=0;return f.css({top:g,left:i}),a>0&&!d&&(c.dataRows[a]=f),f},toggleColumn:function(a,d,e){var f=!c.columns[a].hidden,g=!!c.columns[a].hidden;d?g=!0:d===!1&&(g=!1),(!e||e.callback!==!1)&&b.isFunction(c.toggleCallback)&&c.toggleCallback(a,!!g);if(f==g)return;for(var h=0;h<c.rows.length;h++)c.cells[h+","+a].width(g?c.columns[a].metrics.width:10).children().showIf(g).toggleClass("hidden_column",!g);return c.columns[a].hidden=!g,(!e||!e.skipSizeGrid)&&c.sizeGrid(),g},sizeGrid:function(){var a=0;for(var b=1;b<c.columns.length;b++)a+=c.columns[b].hidden?10:c.columns[b].metrics.width;c.divs.filler.width(a-c.columns[0].metrics.width);for(var b=0;b<c.rows.length;b++)c.cells[b+","+1].parent(".row").width(a+c.columns.length+3)},focus:function(a,b){var d=c.cells[a+","+b];if(c.currentFocus&&d.index(c.currentFocus||[])!=-1)return;c.currentFocus&&c.blur(),d.addClass("focus"),c.currentFocus=d,c._trigger("entry_focus",null,d)},blur:function(){c.currentFocus&&(c.currentFocus.removeClass("focus"),c._trigger("entry_blur",null,c.currentFocus),c.currentFocus=null)},scrollTo:function(a,b){c.disableHighlights=!0,a==0&&(a=1),b==0&&(b=1);var d=c.cells[a+","+b];c.divs.data.scrollToVisible(d).triggerHandler("scroll"),c.disableHighlights=!1;if(d&&d.filter(":visible").length>0)return d.attr("tabindex",0),!0},sizeToWindow:function(){b("html,body").css("overflow","hidden");var d=b("#content,#wide_content");if(!d.length||d.width()<100)d=b(window);var e=a.browser.ff?1:0,f=b(window).height()-e-c.divs.top.offset().top,g=d.width()-e,h=Math.floor(g-c.columns[0].metrics.outerWidth),i=Math.floor(f-c.rows[0].metrics.height-c.borderSize);c.divs.top.width(h),c.divs.data.width(h),c.divs.left.height(i),c.divs.data.height(i),c.divs.data.metrics={width:h,height:i}},_selectFirstCell:function(){var a=c.cells["1,1"];a.trigger("mouseover"),c.currentHover=a,c.scrollTo(1,1)},position:function(a){a.hasClass("cell")||(a=a.closest(".cell"));if(a.data("datagrid_position"))return a.data("datagrid_position");if(a.length==0)return{};var b={row:parseInt(a.attr("data-row"),10),column:parseInt(a.attr("data-column"),10)};return a.data("datagrid_position",b),b},moveLeft:function(){var a=c.currentHover;if(!c.currentHover){c._selectFirstCell();return}var b=a.column-1,d=c.cells[a.row+","+b];while(d&&d.hidden)b--,d=c.cells[a.row+","+b];if(!d||d.length===0)d=a;d.trigger("mouseover").focus(),c.currentHover=d,c.scrollTo(d.row,d.column)},moveRight:function(){var a=c.currentHover;if(!c.currentHover){c._selectFirstCell();return}var b=a.column+1,d=c.cells[a.row+","+b];while(d&&d.hidden)b++,d=c.cells[a.row+","+b];if(!d||d.length===0)d=a;d.trigger("mouseover").focus(),c.currentHover=d,c.scrollTo(d.row,d.column)},moveUp:function(){var a=c.currentHover;if(!c.currentHover){c._selectFirstCell();return}var b=a.row-1,d=c.cells[b+","+a.column];while(d&&d.hidden)b--,d=c.cells[b+","+a.column];if(!d||d.length===0)d=a;d.trigger("mouseover").focus(),c.currentHover=d,c.scrollTo(d.row,d.column)},moveDown:function(){var a=c.currentHover;if(!c.currentHover){c._selectFirstCell();return}var b=a.row+1,d=c.cells[b+","+a.column];while(d&&d.hidden)b++,d=c.cells[b+","+a.column];if(!d||d.length===0)d=a;d.trigger("mouseover").focus(),c.currentHover=d,c.scrollTo(d.row,d.column)}};return c}),define("message_students",["i18n!message_students","jquery","jquery.instructure_forms","jquery.instructure_jquery_patches","jquery.instructure_misc_plugins"],function(a,b){var c=b("#message_students_dialog"),d={};return window.messageStudents=function(e){d=e,c.find(".message_types").empty();for(var f in e.options){var g=b("<option/>"),h=e.options[f];g.val(f).text(h.text),c.find(".message_types").append(g)}var i=e.title,j=c.find("ul li.blank:first"),k=c.find("ul"),l={};c.find("ul li:not(.blank)").remove();for(var f in e.students){var m=j.clone(!0).removeClass("blank");m.find(".name").text(e.students[f].name),m.find(".score").text(e.students[f].score),m.data("id",e.students[f].id),m.user_data=e.students[f],k.append(m.show()),l[e.students[f].id]=m}k.show(),c.data("students_hash",l),c.find(".asset_title").text(i),c.find(".out_of").showIf(e.points_possible!=null),c.find(".send_button").text(a.t("send_message","Send Message")),c.find(".points_possible").text(e.points_possible),c.find("textarea").val(""),c.find("select")[0].selectedIndex=0,c.find("select").change(),c.dialog({width:600,modal:!0}).dialog("open").dialog("option","title",a.t("message_student","Message Students for %{course_name}",{course_name:i}))},b(document).ready(function(){c.find(".cutoff_score").bind("change blur keyup",function(){c.find("select").change()}),c.find(".cancel_button").click(function(){c.dialog("close")}),b("#message_assignment_recipients").formSubmit({processData:function(a){var c=[];return b(this).find(".student:visible").each(function(){c.push(b(this).data("id"))}),c.length==0?!1:(a.recipients=c.join(","),a)},beforeSubmit:function(c){b(this).find("button").attr("disabled",!0).filter(".send_button").text(a.t("buttons.sending_message","Sending Message..."))},success:function(c){b(this).find(".send_button").text("Message Sent!");var d=b(this);setTimeout(function(){d.find("button").attr("disabled",!1).filter(".send_button").text(a.t("buttons.send_message","Send Message")),b("#message_students_dialog").dialog("close")},2e3)},error:function(c){b(this).find("button").attr("disabled",!1).filter(".send_button").text(a.t("buttons.send_message_failed","Sending Message Failed, please try again"))}}),c.find("select").change(function(){var a=parseInt(b(this).val(),10)||0,e=d.options[a],f=c.data("students_hash"),g=parseFloat(c.find(".cutoff_score").val(),10);!g&&g!==0&&(g=null);var h=null,i=[];for(var a in f)i.push(f[a]);f&&(e&&e.callback?h=e.callback.call(window.messageStudents,g,i):d.callback&&(h=d.callback.call(window.messageStudents,e.text,g,i))),h=h||[],c.find(".cutoff_holder").showIf(e.cutoff),c.find(".student_list").toggleClass("show_score",e.cutoff||e.score),c.find("button").attr("disabled",h.length==0);var j={};for(var a in h)j[parseInt(h[a],10)||0]=!0;for(var a in f)f[a].showIf(j[a])})}),messageStudents}),define("gradebooks",["INST","i18n!gradebook","jquery","datagrid","compiled/grade_calculator","str/htmlEscape","use!underscore","jquery.ajaxJSON","jquery.dropdownList","jquery.instructure_date_and_time","jquery.instructure_forms","jquery.instructure_jquery_patches","jquery.instructure_misc_helpers","jquery.instructure_misc_plugins","jquery.keycodes","jquery.loadingImg","jquery.templateData","message_students","vendor/date","vendor/jquery.scrollTo","vendor/jquery.store","jqueryui/position","jqueryui/progressbar"],function(a,b,c,d,e,f,g){function h(a){var b=a.data("object_id");b||(b=a.find(".table_entry,.student_header,.assignment_header").attr("id"),b=b.replace(/^outer_/,"")),a.data("object_id",b);var c=object_data[b],d=b.split(/[_-]/),e=[];while(d.length>0&&isNaN(parseInt(d[0],10)))e.push(d.shift());var f=e.join("_");if(!c)e=b.split("_"),c={},e[0]=="submission"&&(c.user_id=e[1],c.assignment_id=e[2]),object_data[b]={},object_data[b][e[0]]=c;else{var g=c[f]||c.audit_student||c.user;if(!g)for(var h in c)g=c[h];g[f+"_id"]=g.id,c=g}if(f=="submission"){var i=object_data["assignment_"+c.assignment_id];i=i.assignment,c.assignment_group_id=i.assignment_group_id,c.points_possible=i.points_possible}return c}function i(a,d){var e=C.getFormData(),f=c("#submission_"+a.student_id+"_"+a.assignment_id),g=f.parent();f.loadingImage({image_size:"small"}),j({user_id:a.student_id,assignment_id:a.assignment_id,grade:a.grade}),a.id&&a.id!==""&&(e["submission[id]"]=a.id),a.comment&&(e["submission[comment]"]=a.comment),e["submission[group_comment]"]=a.group_comment?"1":"0",e["submission[assignment_id]"]=a.assignment_id,e["submission[user_id]"]=a.student_id,e["submission[grade]"]=a.grade;var h=function(a){for(var c in a){var d=a[c].submission;j(d),t(d.user_id)}a.length>1&&alert(b.t("alerts.students_updated",{one:"1 Student Updated",other:"%{count} Students Updated"},{count:a.length})),f.loadingImage("remove")},i=function(a){f.loadingImage("remove")};d&&B.find(".comment_attachments input[type='file']").length?c.ajaxJSONFiles(C.attr("action")+".text","POST",e,B.find(".comment_attachments input[type='file']"),h,i):c.ajaxJSON(C.attr("action"),"POST",e,h,i)}function j(a){if(!a)return;var b=null;if(!d.initialized){var e=x.assignmentIndexes[a.assignment_id],f=x.studentIndexes[a.user_id],g=d.cells[f+","+e];b=g&&g.find("#submission_"+a.student_id+"_"+a.assignment_id);if(!b||!b.length){x.queuedSubmissions=x.queuedSubmissions||[],x.queuedSubmissions.push(a);return}}object_data["submission_"+a.user_id+"_"+a.assignment_id]={submission:a};var h=object_data["assignment_"+a.assignment_id],h=h&&h.assignment;a.student_id=a.user_id,b=b||c("#submission_"+a.student_id+"_"+a.assignment_id),b.css("visibility","");var i=a&&c.parseFromISO(a.submitted_at).minute_timestamp,j=h&&c.parseFromISO(h.due_at).minute_timestamp;b.parent().toggleClass("late",!!(h&&a&&h.due_at&&a.submission_type&&a.submitted_at&&i>j)),a.grade!==""&&a.grade==0&&(a.grade="0");var l=b.find(".score"),m=b.find(".pending_review"),n=b.find(".turnitin"),o=b.find(".grade");l.showIf(a.score),b.fillTemplateData({data:a}),a.submission_type!="online_quiz"||a.workflow_state!="pending_review"?m.remove():m.length||(o.after(c("#gradebook_urls .pending_review").clone()),m.addClass("showable").showIf(!b.find(".grading_value:visible").length));var p=null;if(a.turnitin_data){if(a.attachments&&a.submission_type=="online_upload")for(var q in a.attachments){var r=a.attachments[q].attachment,s=a.turnitin_data&&a.turnitin_data["attachment_"+r.id];s&&(p=p||{},p.items=s.items||[],p.items.push(s))}else if(a.submission_type=="online_text_entry"){var s=a.turnitin_data&&a.turnitin_data["submission_"+a.id];s&&(p=p||{},p.items=s.items||[],p.items.push(s))}if(p){var t={failure:4,problem:3,warning:2,acceptable:1},u={0:"none",1:"acceptable",2:"warning",3:"problem",4:"failure"},v=0;for(var q=0;q<p.items.length;q++)v+=t[p.items[q].state];var w=v/p.items.length;p.state=u[Math.floor(w)]||"no"}}if(!p)n.remove();else if(!n.length){var y=c("#gradebook_urls .turnitin").clone();y.attr("src",y.attr("src").replace("turnitin_no_score","turnitin_"+p.state+"_score")),o.after(y),n.addClass("showable").show()}l.showIf(h&&h.grading_type=="letter_grade");var z=c("#outer_assignment_"+a.assignment_id).find(".grading_type").text();z=="pass_fail"&&a.grade&&a.grade!=" - "&&o.empty().append(c("#submission_entry_"+a.grade+"_image").clone()),(a.grade==null||a.grade==="")&&o.empty().append(k(a))}function k(a){var b=c("#submission_"+a.submission_type+"_image").clone().attr("id","");return b.length===0&&(b=" - "),b}function l(a,b){var d=a,e=d.parents(".table_entry");a.hasClass("grading_value")||(d=a.find(".grading_value"));var f=d.val(),g=f,j=c.trim(e.find(".grade").text());e.find(".grade img").length>0&&(j=e.find(".grade img").attr("alt").toLowerCase()),j=="-"&&(j=""),d.hasClass("pass_fail")&&(f=="pass"||f=="fail")&&(f=c("#submission_entry_"+f+"_image").clone().attr("id",""));var l={},m=C.getFormData(),n=h(e.parent());l.id=n.id||"",l.assignment_id=n.assignment_id,l.student_id=n.user_id,l.grade=g,(g!=j||g&&b)&&i(l);if(!f||f=="")l.submission_type=n.submission_type||"",f=k(l);e.find(".grade").show().empty().append(f)}function m(a,b){var d=h(a).assignment_id,e=c(".assignment_"+d);b||b!==!1&&c(e[0]).parent().hasClass("hidden_column")?e.show().parent().removeClass("hidden_column"):e.hide().parent().addClass("hidden_column")}function n(a,d){var e=a,g=object_data["assignment_"+d.assignment_id].assignment,h=c("#outer_student_"+d.user_id+" .display_name").text(),i=c("#outer_assignment_"+d.assignment_id+" .display_name").text(),j=b.t("submission_information","Submission Information"),k=e.find(".grade"),l=e.find(".score"),m=c.trim(k.text()),n=c("#student_grading_"+d.assignment_id).clone(),o=d.comment||"",p=d.points_possible,q=c(document.createElement("div")),r=c(document.createElement("div")),s=c("#gradebook_urls .view_online_submission_url").attr("href");h&&i&&(j=i+": "+h),k.find("img").length>0&&(m=k.find("img").attr("alt")),l.length>0&&(m=l.text());if(m=="_"||m=="-")m="";n[0].tagName=="SELECT"?n.val(d.grade):m!=""&&n.val(m),s=c.replaceTags(s,"assignment_id",d.assignment_id),s=c.replaceTags(s,"user_id",d.user_id),re=new RegExp('("|%22)'+d.user_id+'("|%22)'),s=s.replace(re,d.user_id),q.append(c("#submission_view_image").clone(!0).removeAttr("id")),q.append(c(" <a href='"+s+"'>"+b.t("links.submission_details","Submission Details")+"</a>")),r.css({textAlign:"center",fontWeight:"bold",fontSize:"1.2em",marginTop:5});if(d.submission_type&&d.submission_type!="online_quiz"){if(d.submission_type=="online_url"){r.append(c("#submission_"+d.submission_type+"_image").clone().removeAttr("id"));var s=d.url;r.append(" <a href='"+s+"' target='_new'>"+b.t("links.go_to_submission","Go To Submission URL")+"</a>")}else if(d.submission_type=="online_upload"){var s=c("#gradebook_urls .view_online_upload_url").attr("href");s=c.replaceTags(s,"assignment_id",d.assignment_id),s=c.replaceTags(s,"user_id",d.user_id);if(d.attachments)for(var t in d.attachments){var u=d.attachments[t].attachment,v=c.replaceTags(s,"attachment_id",u.id),x=d.turnitin_data&&d.turnitin_data["attachment_"+u.id];if(x){var y=c.replaceTags(c.replaceTags(c.replaceTags(c(".turnitin_report_url").attr("href"),"user_id",d.user_id),"asset_string","attachment_"+u.id),"assignment_id",d.assignment_id),z=c("<a/>");z.attr("href",y).addClass("turnitin_similarity_score").addClass((x&&x.state||"no")+"_score"),z.attr("title",b.t("titles.turnitin_score","Turnitin similarity score -- more information")),z.attr("target","_blank"),z.text((x.similarity_score||"--")+"%"),r.append(z)}r.append(c("#submission_"+d.submission_type+"_image").clone().removeAttr("id")),r.append(" <a href='"+v+"'>"+f(b.t("links.download_attachment","Download %{attachment}",{attachment:u.display_name}))+"</a><br/>")}}else if(d.submission_type=="online_text_entry"){var x=d.turnitin_data&&d.turnitin_data["submission_"+d.id];if(x){var y=c.replaceTags(c.replaceTags(c.replaceTags(c(".turnitin_report_url").attr("href"),"user_id",d.user_id),"asset_string","submission_"+d.id),"assignment_id",d.assignment_id),z=c("<a/>");z.attr("href",y).addClass("turnitin_similarity_score").addClass((x&&x.state||"no")+"_score"),z.attr("title",b.t("titles.turnitin_score","Turnitin similarity score -- more information")),z.attr("target","_blank"),z.text(x.similarity_score+"%"),r.append(z)}r.append(c("#submission_"+d.submission_type+"_image").clone().removeAttr("id"));var s=c("#gradebook_urls .view_online_text_entry_url").attr("href");s=c.replaceTags(s,"assignment_id",d.assignment_id),s=c.replaceTags(s,"user_id",d.user_id),r.append(" <a href='"+s+"' target='_new'>"+b.t("links.view_submission","View Submission")+"</a>")}}else if(d.quiz_submission){var s=c("#gradebook_urls .view_quiz_url").attr("href");s=c.replaceTags(s,"quiz_id",d.quiz_submission.quiz_id),s=c.replaceTags(s,"user_id",d.user_id),d.workflow_state=="pending_review"?(r.append(c("#submission_pending_review_image").clone().removeAttr("id")),r.append(" <a href='"+s+"' target='_new'>"+b.t("links.finish_scoring","Finish Scoring this Quiz")+"</a>")):(r.append(c("#submission_quiz_image").clone().removeAttr("id")),r.append(" <a href='"+s+"' target='_new'>"+b.t("links.view_quiz","View this Quiz")+"</a>"))}else if(d.submission_type=="online_text_entry"){var s=c("#gradebook_urls .view_online_text_entry_url").attr("href");s=c.replaceTags(s,"assignment_id",d.assignment_id),s=c.replaceTags(s,"user_id",d.user_id);var x=d.turnitin_data&&d.turnitin_data["submission_"+d.id];if(x){var y=c.replaceTags(c.replaceTags(c.replaceTags(c(".turnitin_report_url").attr("href"),"user_id",d.user_id),"asset_string","submission_"+d.id),"assignment_id",d.assignment_id),z=c("<a/>");z.attr("href",y).addClass("turnitin_similarity_score").addClass((x&&x.state||"no")+"_score"),z.attr("title",b.t("titles.turnitin_score","Turnitin similarity score -- more information")),z.attr("target","_blank"),z.text(x.similarity_score+"%"),r.append(z)}r.append(c("#submission_"+d.submission_type+"_image").clone().removeAttr("id")),r.append(" <a href='"+s+"' target='_new'>"+b.t("links.view_submission","View Submission")+"</a>")}B.find(".no_comments").hide().end().find(".add_comment_link").hide().end().find(".points_possible").text(p||"").end().find(".out_of").showIf(p||p==="0").end().find(".grade_entry").empty().append(n.show()).end().find("textarea.comment_text").show().val("").end().find(".submission_details").empty().append(q).append(r).show().end().find(".submission_comments").empty().end().find(".comment_attachments").empty().end().find(".save_buttons,.add_comment").showIf(!w).end().find(".group_comment").showIf(g&&g.group_category).find(":checkbox").attr("checked",!1).end().end(),w&&B.find(".grade_entry").text(m||"-"),d.student_id=d.user_id,d.id=d.id||"";var A=g.due_at&&d.submitted_at&&Date.parse(g.due_at)<Date.parse(d.submitted_at);B.find(".submitted_at_box").showIf(d.submitted_at).toggleClass("late_submission",!!A),d.submitted_at_string=c.parseFromISO(d.submitted_at).datetime_formatted,B.fillTemplateData({data:d,except:["created_at","submission_comments","submission_comment","comment","attachments","attachment"]});for(var t in d.submission_comments){var o=d.submission_comments[t].submission_comment,C=c("#submission_comment_blank").clone(!0).removeAttr("id");o.posted_at=c.parseFromISO(o.created_at).datetime_formatted,C.fillTemplateData({data:o,except:["attachments"]});if(o.attachments)for(var D in o.attachments){var u=o.attachments[D].attachment,E=c("#submission_comment_attachment_blank").clone().removeAttr("id").show();u.assignment_id=d.assignment_id,u.user_id=d.user_id,u.comment_id=o.id,E.fillTemplateData({data:u,hrefValues:["assignment_id","user_id","id","comment_id"]}),C.find(".attachments").append(E)}B.find(".submission_comments").append(C.show())}B.show().dialog("close").dialog({width:500,height:"auto",title:j,open:function(){B.find(".grading_value").focus().select(),c("#gradebook").data("disable_highlight",!0)},close:function(){c("#gradebook").data("disable_highlight",!1)},autoOpen:!1}).dialog("open").dialog("option","title",j)}function o(a){var d=a,e=h(d);if(e&&e.submission_comments)n(a,e);else{c("#loading_submission_details_dialog").dialog("close").dialog({autoOpen:!1,title:b.t("titles.loading","Loading...")}).dialog("open");var f=c("#loading_submission_details_dialog .submission_details_url").attr("href");f=c.replaceTags(c.replaceTags(f,"user_id",e.user_id),"assignment_id",e.assignment_id),c.ajaxJSON(f,"GET",{},function(b){c("#loading_submission_details_dialog").dialog("close"),b.submission.submission_comments=b.submission.submission_comments||[],object_data["submission_"+e.user_id+"_"+e.assignment_id]=b,e=h(d),n(a,e)},function(a){})}}function p(){x.updateAllStudentGrades=function(a){x.finalGradesReady=!1;if(a)for(var b in object_data)if(object_data[b].submission){var d=object_data[b].submission;S[d.user_id]=S[d.user_id]||[],S[d.user_id].push(d)}c(".outer_student_name").each(function(){var a=h(c(this));R.push(a.id)})};var a=function(){if(R.length>0){var a=R.shift();if(S[a]){for(var b in S[a])j(S[a][b]);S[a]=null}t(a)}else x.finalGradesReady=!0};setInterval(a,100),x.updateAllStudentGrades(),c("html,body").scrollTop(0),c(".outer_assignment_name").each(function(){var a=c(this),b=h(a),d={title:b.title,id:b.assignment_id,date_sortable:b.due_at,group_id:b.assignment_group_id,special_sort:"a"};d.id=d.id||a.find(".student_header").attr("id").substring(17);if(a.hasClass("final_grade"))d.special_sort="z",d.group_id="z";else if(a.hasClass("group_total")){var e=c("#groups_data .group"),f=e.index(c("#group_"+b.assignment_group_id));d.special_sort="y_"+f}a.data("assignment_object",d)})}function q(a,b,d){b=="first"?(b="before",d=h(c(".outer_assignment_name:first")).id):b=="last"&&(b="after",d=h(c(".outer_assignment_name:last")).id);if(b=="before"){var e=c(".assignment_"+d).parent(),f=c(".assignment_"+a).parent();for(var g=0;g<e.length;g++)c(e[g]).before(c(f[g]))}else if(b=="after"){var i=c(".assignment_"+d).parent(),f=c(".assignment_"+a).parent();for(var g=0;g<i.length;g++)c(i[g]).after(c(f[g]))}}function r(a){var b=0,d=c("#class_weighting_policy").attr("checked");c("#groups_data").find(".group").each(function(){var e=c(this).find(".group_weight").val(),f=parseFloat(e);isNaN(f)&&(f=0);if(a){var g=c(this).getTemplateData({textValues:["assignment_group_id"]}).assignment_group_id,h=f+"%",i=" of grade";d||(h="",i=""),c("#outer_assignment_group-"+g+",#assignment_group-"+g).find(".points_possible").text(h).end().find(".before_points_possible").text("").end().find(".after_points_possible").text(i)}b+=f}),c("#groups_data").find(".total_weight").text(b),a&&x.updateAllStudentGrades&&x.updateAllStudentGrades()}function s(a,b){if(!b)return;if(b&&b.length===0)return;var d=b.getTemplateData({textValues:["assignment_group_id","rules"]});d=c.extend(d,b.getFormData());var e=a[d.assignment_group_id]||{};e.group_weight||(e.group_weight=parseFloat(d.group_weight)/100),e.scores=e.scores||[],e.full_points=e.full_points||[],e.count=e.count||0,e.submissions=e.submissions||[],e.scored_submissions=e.scored_submissions||[],e.sorted_submissions=e.sorted_submissions||[];if(e.score_total!==null||e.full_total!==null){e.calculated_score=e.score_total/e.full_total;if(isNaN(e.calculated_score)||!isFinite(e.calculated_score))e.calculated_score=0}e.score_total=e.score_total||0,e.full_total=e.full_total||0;if(!e.rules){d.rules=d.rules||"";var f={drop_highest:0,drop_lowest:0,never_drop:[]},g=d.rules.split("\n");for(var h in g){var i=g[h].split(":"),j=null;i.length>1&&(j=parseInt(i[1],10)),j&&!isNaN(j)&&isFinite(j)&&(i[0]=="drop_lowest"?f.drop_lowest=j:i[0]=="drop_highest"?f.drop_highest=j:i[0]=="never_drop"&&f.never_drop.push(j))}e.rules=f}return a[d.assignment_group_id]=e,e}function t(a){var b=c(".table_entry.student_"+a);if(b.length===0)return;var d={},f=c("#groups_data .group");f.each(function(){s(d,c(this))}),b.each(function(){var a=c(this);if(a.find(".grade").hasClass("hard_coded"))return;var b=h(c(this).parent()),e=d[b.assignment_group_id];e||(e=s(c("#group_"+b.assignment_group_id)));if(!e)return;if(!(!K||b.grade!=null&&b.grade!==""))return;var f=parseFloat(b.score);if(!f||isNaN(f)||!isFinite(f))f=0;var g=parseFloat(b.points_possible);if(!g||isNaN(g))g=0;var i=f/g;if(isNaN(i)||!isFinite(i))i=0;b.calculated_score=f,b.calculated_possible=g,b.calculated_percent=i,e.submissions.push(b),(b.score||b.score===0)&&e.scored_submissions.push(b),d[b.assignment_group_id]=e});for(var g in d){var i=d[g];i.sorted_submissions=i.submissions.sort(function(a,b){var c=[a.calculated_percent,(object_data["assignment_"+a.assignment_id]||{}).due_at],d=[b.calculated_percent,(object_data["assignment_"+b.assignment_id]||{}).due_at];return c>d?1:c==d?0:-1});var j=0,k=0,l=i.scored_submissions.length;for(var m=0;m<i.sorted_submissions.length;m++)i.sorted_submissions[m].calculated_drop=!1;for(var m=0;m<i.sorted_submissions.length;m++){var n=i.sorted_submissions[m];!n.calculated_drop&&j<i.rules.drop_lowest&&j+k+1<l&&n.calculated_possible>0&&c.inArray(n.assignment_id,i.rules.never_drop)==-1&&(j++,n.calculated_drop=!0),i.sorted_submissions[m]=n}for(var m=i.sorted_submissions.length-1;m>=0;m--){var n=i.sorted_submissions[m];!n.calculated_drop&&k<i.rules.drop_highest&&j+k+1<l&&n.calculated_possible>0&&c.inArray(n.assignment_id,i.rules.never_drop)==-1&&(k++,n.calculated_drop=!0),i.sorted_submissions[m]=n}for(var m=0;m<i.sorted_submissions.length;m++){var n=i.sorted_submissions[m];n.calculated_drop?c("#submission_"+n.user_id+"_"+n.assignment_id).parent().addClass("dropped"):(c("#submission_"+n.user_id+"_"+n.assignment_id).parent().removeClass("dropped"),i.scores.push(n.calculated_score),i.full_points.push(n.calculated_possible),i.count++,i.score_total+=n.calculated_score,i.full_total+=n.calculated_possible)}d[g]=i}var o=0,p=0,q=0,r=0,t=0;c.each(d,function(b,e){var f=s(d,c("#group_"+b)),g=Math.round(e.calculated_score*1e3)/10;c("#submission_"+a+"_group-"+b).css("visibility","").attr("data-tip","pts: "+e.score_total+" / "+e.full_total).find(".grade").text(g).end().find(".score").hide().end().find(".pct").text(" %").show();var g=e.calculated_score*e.group_weight;if(isNaN(g)||!isFinite(g))g=0;K&&e.count>0&&(r+=e.group_weight),o+=g,t+=e.score_total,q+=e.full_total});var u=parseFloat(c("#groups_data .total_weight").text());if(!c("#class_weighting_policy").attr("checked")||isNaN(u)||!isFinite(u)||u===0)p=Math.round(1e3*t/q)/10;else{var w=parseFloat(c("#groups_data .total_weight").text())/100;if(isNaN(w)||!isFinite(w)||w===0)w=1;if(K&&r<1){var y=w<1?w:1;o=y*o/r}p=o,p=Math.round(p*1e3)/10}if(isNaN(p)||!isFinite(p))p=0;var z="";v&&(z=e.letter_grade(v,p)),c("#submission_"+a+"_final-grade").css("visibility","").attr("data-tip",x.pointCalculations?"pts: "+t+" / "+q:"").find(".grade").text(p).end().find(".score").hide().end().find(".letter_grade").showIf(v).text(z).end().find(".pct").text(" %").show()}function u(a){var b=window.location.protocol+"//"+window.location.host+window.location.pathname+"?updated="+lastGradebookUpdate;c("#datagrid_topleft").gradebookLoading(),c.ajaxJSON(b,"GET",{},function(b){a&&setTimeout(function(){u(!0)},12e4),c("#datagrid_topleft").gradebookLoading("remove");var d=lastGradebookUpdate;for(idx in b){var e=b[idx].submission;e.student_id=e.user_id,e.updated_at.substring(0,19)>lastGradebookUpdate&&(j(e),e.updated_at>d&&(d=e.updated_at.substring(0,19)))}lastGradebookUpdate=d},function(b){a&&setTimeout(function(){u(!0)},24e4),c("#datagrid_topleft").gradebookLoading("remove")})}var v=window.grading_scheme,w=window.readOnlyGradebook,x=window.gradebook,y=c("#loading_gradebook_progressbar"),z=c("#default_grade_form"),A=c("#assignment_details_dialog"),B=c("#submission_information"),C=c("#update_submission_form"),D=c("#publish_to_sis_form"),E=c("#curve_grade_dialog"),F=c("#message_students_dialog"),G=c("#information_link"),H=c("#total_tooltip").appendTo("body"),I=c("#content").offset(),J=c("#gradebook_full_content").data("context_code"),K=!0,L={},M=c(".outer_student_name .course_section"),N=c("#current_context_code").text().split("_")[1],O=c.store.userGet("grading_show_only_section"+N);M.each(function(){L[c(this).data("course_section_id")]=c(this).attr("title")});if(O){var P=!1,Q=0;c.each(id_maps,function(a,b){a.match("row_")&&delete id_maps[a]}),c(".outer_student_name .course_sections, .gradebook_table .course_sections").each(function(){var a=c(this).data("course_section_ids").toString().split(",");if(a.indexOf(O)==-1)c(this).closest("tr").remove();else{var b=c(this).closest(".student_header").attr("id");b&&(++Q,id_maps["row_"+Q]=Number(b.replace("student_",""))),P=!0}}),P||(alert(b.t("alerts.no_students_in_section","Could not find any students in that section, falling back to showing all sections.")),c.store.userRemove("grading_show_only_section"+N),window.location.reload())}x={hoverCount:-1,fileIndex:1,assignmentIndexes:{},studentIndexes:{},showInfoLink:function(a){var b=G;if(d.currentFocus)return;var c=a.find(".table_entry");if(a.hasClass("group_total")||a.hasClass("final_grade")){b.hide();if(c.attr("data-tip")){var e=a.offset();H.show().find(".text").text(c.attr("data-tip"));var f=H.outerHeight();H.css({left:e.left-2,top:e.top-f-3})}else H.hide();return}if(!c.length||c.find(".new_message,.pending_review,.turnitin").filter(":visible").length||a.hasClass("group_total")||a.hasClass("final_grade")){b.hide(),H.hide();return}H.hide(),b.appendTo(c).show()},hideInfoLink:function(){H.hide(),G.hide(),x.hoverCount=-1},populate:function(){x.updateAllStudentGrades&&x.updateAllStudentGrades()},makeAccessible:function(){var a=c("#datagrid_data .content"),d=c("#datagrid_left .display_name");a.attr("role","grid").prepend(function(){var a=c("#datagrid_top .assignment_title").map(function(){return"<div role='columnheader' id='th_"+c(this).parents(".assignment_header").attr("id")+"' tabindex='-1'>"+c(this).html()+"</div>"}).get().join("");return"<div class='hidden-readable' role='row'><div role='columnheader' tabindex='-1'>"+b.t("student_name","Student Name")+"</div>"+a+"</div>"}).find(".row").attr("role","row").prepend(function(a){return"<div id='th_"+d.eq(a).parents(".student_header").attr("id")+"' tabindex='-1' class='ui-helper-hidden-accessible' role='rowheader'>"+d.eq(a).html()+"</div>"}),a.find(".data_cell").attr({role:"gridcell",tabindex:-1,"aria-labelledby":function(){var a=c(this).find(".table_entry").attr("id").split("_"),b=a[1],d=a[2];return"th_assignment_"+d+" th_student_"+b}})}},c(document).ready(function(){x.pointCalculations=!c("#class_weighting_policy").attr("checked");var e=function(){c("#gradebook_full_content").hide(),setTimeout(function(){c("#gradebook_table").bind("entry_over",function(a,c){if(c.trueEvent){x.showInfoLink(c.cell);function e(a,b){var d=c.cell.offset();H.show().find(".text").html(a);var e=H.outerHeight();H.css({left:d.left-(b?15:2),top:d.top-e-3})}if(c.cell.hasClass("late"))e(b.t("tooltips.submitted_late","This submission was submitted late"));else if(c.cell.hasClass("dropped"))e(b.t("tooltips.submission_dropped","This submission is dropped for grading purposes"));else if(d.columns[c.cell.column].hidden){var g=h(d.cells["0,"+c.cell.column]).title;e(f(g)+"<br/><span style='font-size: 0.9em;'>"+b.t("click_to_expand","Click to expand")+"</span>",!0)}}else a&&a.originalEvent&&a.originalEvent.type&&!a.originalEvent.type.match(/mouse/)&&c.cell.find(".grade").focus().css("outline",0)}).bind("entry_out",function(a,b){x.hideInfoLink()}).bind("entry_click",function(a,b){var e=b.cell;a.originalEvent&&c(a.originalEvent.target).closest(".display_name,.assignment_title").length==0&&a.originalEvent.preventDefault();if(e.hasClass("column_header")||e.hasClass("row_header")||e.find(".grade").hasClass("hard_coded"))return;b.cell.data("from_click",!0),d.focus(e.row,e.column),b.cell.data("from_click",!1)}).bind("entry_focus",function(a,b){if(w)return d.blur(),!1;var e=b.cell.find(".table_entry"),f=e.find(".grade"),g=!0,i=c.trim(f.text());x.hideInfoLink();if(e.find(".grade img.submission_icon").length>0&&b.cell.data("from_click")){o(b.cell),d.blur();return}f.hasClass("hard_coded")&&(g=!1);if(!g)return;f.find("img.graded_icon").length?i=f.find("img.graded_icon").attr("alt").toLowerCase():e.find(".score").length>0&&(!i||!i.match(/.+%/))&&(i=c.trim(e.find(".score").text())),i=c.trim(i),i=="-"&&(i="");var j=h(b.cell);if(g){var k=b.cell.width(),l=b.cell.height(),m=j.assignment_id,n=c("#student_grading_"+m).clone(!0),p=n.children().andSelf().filter(".grading_value");f.hide().after(n),n.css("display","block"),p.attr("type")=="text"?(k-=8,l-=8):(k-=2,l-=2),n.width(k).height(l).css("margin",1),p.height(l),(p[0].tagName!="SELECT"||i!=="")&&p.val(i),n.show(),p.focus().select()}e.find(".new_message,.pending_review").hide()}).bind("entry_blur",function(a,b){var c=b.cell.find(".table_entry");c.find(".new_message,.pending_review.showable,.grade").show(),c.find(".grading_box").remove(),b.cell.triggerHandler("mouseover"),setTimeout(function(){x.showInfoLink(b.cell)},50)}),setTimeout(k,50)},1e3)},k=function(){c(".delete_comment_attachment_link").click(function(a){a.preventDefault(),c(this).parents(".comment_attachment").slideUp(function(){c(this).remove()})}),c(".attach_comment_file_link").click(function(a){a.preventDefault();var b=c(this).parents(".add_comment").find(".comment_attachment:last").clone(!0);b.find("input").attr("name","attachments["+x.fileIndex++ +"][uploaded_data]"),c(this).parents(".add_comment").find(".comment_attachments").append(b),b.slideDown()}),c(".grading_value").keycodes("esc return tab",function(a){a.preventDefault(),a.stopPropagation();if(a.keyString=="return"||a.keyString=="tab")c(this).triggerHandler("blur",!0),a.keyString=="return"?d.moveDown():d.moveRight();else if(a.keyString=="esc"){var b=c(this).parents("[role='gridcell']");d.blur(),b.focus()}}),c(".grading_value").blur(function(a,b){var e=c(this).parents(".table_entry").parents("div.cell");if(e.length>0){var f=c(this);f.parents(".grading_box").length&&(f=f.parents(".grading_box")),l(f,b),d.blur()}}),z.formSubmit({beforeSubmit:function(a){z.loadingImage().find(".cancel_button").attr("disabled",!0)},processData:function(a){var d=0;return c(".table_entry.assignment_"+a.assignment_id+":visible").each(function(){var b=c(this),e=h(b.parent()),f="submissions[submission_"+d+"]";if(!e.score&&e.score!==0||a.overwrite_existing_grades)a[f+"[assignment_id]"]=a.assignment_id,a[f+"[user_id]"]=e.user_id,a[f+"[grade]"]=a.default_grade,d++}),d===0?(alert(b.t("alerts.none_to_update","None to Update")),!1):a},success:function(a){z.loadingImage("remove");for(var c in a){var d=a[c].submission;j(d),R.push(d.user_id)}alert(b.t("alerts.scores_updated",{one:"1 Student score updated",other:"%{count} Student scores updated"},{count:a.length})),z.find(".cancel_button").attr("disabled",!1),z.dialog("close")}}).find(".cancel_button").click(function(){z.dialog("close")}),c("#gradebook_full_content,.datagrid").delegate(".assignment_dropdown","click",function(e){var g=c(this),i=g.parent(),j=g.parents(".assignment_name").find(".grade_assignment_link").attr("href"),k=g.parents(".assignment_name"),l=c(this).parents(".cell"),m={},n=h(k),o=function(a,b,c){var d='<span class="ui-icon ui-icon-'+a+'">&nbsp;</span> '+b;m[d]=c};if(!k.hasClass("group_total")&&!k.hasClass("final_grade")){object_data.submissions&&o("info",b.t("assignment_details","Assignment Details"),function(){var a=h(k),d=c(".student_assignment .assignment_"+a.assignment_id);a.url=k.find(".assignment_link").attr("href"),a.cnt=0,a.score_total=0,d.each(function(){var b=c(this),d=h(b.parent());if(d.score!==null&&d.score!==undefined&&d.score!==""){a.cnt++,a.score_total+=d.score;if(a.max==null||d.score>a.max)a.max=d.score;if(a.min==null||d.score<a.min)a.min=d.score}}),a.max=a.max||0,a.min=a.min||0,a.average=Math.round(a.score_total*10/a.cnt)/10;if(isNaN(a.average)||!isFinite(a.average))a.average=b.t("#not_applicable","N/A");var e=0,f=0,g=200;A.find(".distribution").showIf(a.average&&a.points_possible).find(".none_left").width(f=g*(a.min/a.points_possible)).css("left",(e+=f)-f).end().find(".some_left").width(f=g*((a.average-a.min)/a.points_possible)).css("left",(e+=f)-f).end().find(".some_right").width(f=g*((a.max-a.average)/a.points_possible)).css("left",(e+=f)-f-2).end().find(".none_right").width(f=g*((a.points_possible-a.max)/a.points_possible)).css("left",(e+=f)-f),A.fillTemplateData({data:a}).dialog("close").dialog({autoOpen:!1,title:b.beforeLabel("details","Details")+" "+a.title}).dialog("open").find(".assignment_link").attr("href",a.url)}),o("newwin",b.t("speed_grader","SpeedGrader"),function(){window.location.href=j});var p={elements:{assignments:{},modal:c("#mute_dialog"),rows:c("#datagrid_top .row, #datagrid_data .row")},init:function(){this.isMuted=i.data("muted"),this.label=this.isMuted?b.t("unmute_assignment","Unmute Assignment"):b.t("mute_assignment","Mute Assignment")},onClick:function(a){this.url=i.attr("href")+"/mute",this.isMuted?this.updateStatus():this.showDialog()},showDialog:function(){var a=b.t("cancel_button","Cancel"),d=b.t("mute_assignment","Mute Assignment"),e={};e[d]=c.proxy(function(){this.updateStatus(),this.elements.modal.dialog("close")},this),e[a]=c.proxy(function(){this.elements.modal.dialog("close")},this),this.elements.modal.dialog({autoOpen:!1,buttons:e,modal:!0,resizable:!1,title:this.elements.modal.data("title"),width:400}),this.elements.modal.dialog("open")},updateStatus:function(){c.ajaxJSON(this.url,"put",{status:!this.isMuted},c.proxy(this.onUpdate,this))},onUpdate:function(a){var b="assignment_"+a.assignment.id,d;i.data("muted",!this.isMuted),typeof this.elements.assignments[b]=="undefined"&&(this.elements.assignments[b]={},this.elements.assignments[b].assignment=c("#"+b),this.elements.assignments[b].cell=this.elements.assignments[b].assignment.parent(),this.elements.assignments[b].index=this.elements.assignments[b].cell.data("column"),this.elements.assignments[b].column=c(".content div[data-column="+this.elements.assignments[b].index+"]")),d=this.elements.assignments[b],this.isMuted?this.unmuteAssignment(d):this.muteAssignment(d)},muteAssignment:function(a){var d=c("<a />",{"class":"mute_icon",title:b.t("teacher_muted_title","Assignment is muted")}).append(c("<img />",{src:"/images/sound_mute.png",alt:""}));a.assignment.find("a.assignment_link.assignment_title").after(d),a.column.width(a.column.width()+20),this.elements.rows.width(this.elements.rows.width()+20)},unmuteAssignment:function(a){a.assignment.find(".mute_icon").remove(),a.column.width(a.column.width()-20),this.elements.rows.width(this.elements.rows.width()-20)}};p.init(),o("volume-on",p.label,c.proxy(p.onClick,p));if(object_data.submissions){w||(o("mail-closed",b.t("message_students_who","Message Students Who..."),function(){var a=h(k),d=a.title,e=c("#datagrid_data .assignment_"+a.id),f={};c("#datagrid_left .student_header").each(function(a){var b={};b.id=c(this).attr("id").substring(8),b.name=c(this).find(".display_name").text(),f[b.id]=b}),e.each(function(){var a=h(c(this).parent());f[a.user_id]&&(f[a.user_id].score=a.score,f[a.user_id].submitted_at=a.submitted_at,f[a.user_id].graded_at=a.graded_at)});var g=[];for(var i in f)g.push(f[i]);var j=!0;if(!a.submission_types||a.submission_types.match(/none|on_paper/))j=!1;var l=[{text:b.t("students_who.havent_submitted_yet","Haven't submitted yet")},{text:b.t("students_who.havent_been_graded","Haven't been graded")},{text:b.t("students_who.scored_less_than","Scored less than"),cutoff:!0},{text:b.t("students_who.scored_more_than","Scored more than"),cutoff:!0}];j||l.splice(0,1),window.messageStudents({options:l,title:d,points_possible:a.points_possible,students:g,callback:function(a,d,e){return e=c.grep(e,function(c,e){var f=c.user_data;if(a==b.t("students_who.not_submitted_yet","Haven't submitted yet"))return!f.submitted_at;if(a==b.t("students_who.havent_been_graded","Haven't been graded"))return f.score===null;if(a==b.t("students_who.scored_less_than","Scored less than"))return f.score!=null&&f.score!==""&&d!=null&&f.score<d;if(a==b.t("students_who.scored_more_than","Scored more than"))return f.score!=null&&f.score!==""&&d!=null&&f.score>d}),c.map(e,function(a){return a.user_data.id})}})}),o("check",b.t("set_default_grade","Set Default Grade"),function(){var a=h(k),d=a.title;z.find(".assignment_title").text(d).end(),z.find(".assignment_id").val(a.assignment_id),z.find(".out_of").showIf(a.points_possible||a.points_possible==="0"),z.find(".points_possible").text(a.points_possible);var e=c.replaceTags(z.find(".default_grade_url").attr("href"),"id",a.id);e=C.attr("action"),z.attr("action",e).attr("method","POST");var f=$box=c("#student_grading_"+a.id).clone();$box.hasClass("grading_value")||(f=$box.find(".grading_value")),f.attr("name","default_grade").show(),z.find(".grading_box_holder").empty().append($box),z.dialog("close").dialog({autoOpen:!1,width:350,height:"auto",open:function(){z.find(".grading_box").focus()}}).dialog("open").dialog("option","title",b.t("default_grade_for_course","Default Grade for %{assignment}",{assignment:d}))}),n.grading_type!="pass_fail"&&n.points_possible&&o("check",b.t("curve_grades","Curve Grades"),function(){var a=h(k),c=a.title;E.find(".assignment_title").text(c).end().find(".assignment_id").val(a.assignment_id).end().find(".out_of").showIf(a.points_possible||a.points_possible==="0").end().find("#middle_score").val(parseInt((a.points_possible||0)*.6,10)).end().find(".points_possible").text(a.points_possible).end().dialog("close").dialog({autoOpen:!1,width:350,height:"auto",open:function(){x.curve()}}).dialog("open").dialog("option","title",b.t("curve_grade_for_course","Curve Grade for %{assignment}",{assignment:c}))}));var q=h(k);q.submission_types&&q.submission_types.match(/(online_upload|online_text_entry|online_url)/)&&o("disk",b.t("download_submissions","Download Submissions"),function(){var b=c(".download_assignment_submissions_url").attr("href");b=c.replaceTags(b,"assignment_id",q.assignment_id);try{object_data["assignment_"+q.assignment_id].assignment.submissions_downloads=(q.submissions_downloads||0)+1}catch(d){}a.downloadSubmissions(b)}),q.submissions_downloads&&q.submissions_downloads>0&&!w&&o("arrowthickstop-1-n",b.t("reupload_submissions","Re-Upload Submissions"),function(){var a=c("#re_upload_submissions_form").find(".re_upload_submissions_url").attr("href");a=c.replaceTags(a,"assignment_id",q.assignment_id),c("#re_upload_submissions_form").attr("action",a),c("#re_upload_submissions_form").dialog("close").dialog({autoOpen:!1,title:b.t("reupload_submission_files","Re-Upload Submission Files"),width:350}).dialog("open")})}}o("carat-1-w",b.t("hide_column","Hide Column"),function(){d.toggleColumn(d.position(l).column)});if(k.hasClass("group_total")){var r=k.find(".assignment_title").text();o("carat-1-w",f(b.t("hide_all_things","Hide All %{things}",{things:r})),function(){var a=h(k).assignment_group_id;c(".outer_assignment_name").each(function(){var b=h(c(this)),e=b.assignment_group_id;if(a&&(a=="group-"+e||a==e)){var f=d.position(c("#assignment_"+b.id).parents(".cell")).column;d.toggleColumn(f,!1,{skipSizeGrid:!0}),d.sizeGrid()}})})}return c(this).dropdownList({options:m}),!1}),c("#re_upload_submissions_form").submit(function(){var a=c(this).getFormData();if(!a.submissions_zip)return!1;if(!a.submissions_zip.match(/\.zip$/))return c(this).formErrors({submissions_zip:b.t("errors.upload_as_zip","Please upload files as a .zip")}),!1}),c(document).keycodes("return h i r 1 2 3 4 5 6 7 8 9 0",function(a){if(d.currentFocus||!d.currentHover)return;if(c(a.target).closest(".ui-dialog").length>0)return;var b=d.currentHover;a.keyString=="return"?b.hasClass("student_assignment")&&d.focus(b.row,b.column):a.keyString=="h"?d.toggleColumn(b.column):a.keyString=="i"?(a.preventDefault(),b.hasClass("student_assignment")&&o(b)):a.keyString=="r"?u(!1):b.hasClass("student_assignment")&&d.focus(b.row,b.column)}),c("#datagrid_data").delegate("#information_link, .new_message, .pending_review, .turnitin","click",function(){return o(c(this).parents(".student_assignment")),!1}),B.find(".add_comment_link").click(function(){return c(this).parent().find(".comment_text").css("display","block").focus().select(),!1}),B.find(".cancel_button").click(function(){B.dialog("close")}),B.find(".update_button").click(function(){var a=B.getTemplateData({textValues:["id","student_id","assignment_id"]});a.comment=B.find("textarea.comment_text").val(),a.grade=B.find(".grading_value").val(),a.group_comment=B.find("#group_comment_checkbox").attr("checked"),i(a,!0),B.dialog("close")}),c(".refresh_grades_link").click(function(){return u(!1),!1}),setTimeout(function(){u(!0)},12e4),c("#hide_students_option").change(function(a){var b=c(this).attr("checked");c(".student_name").find(".display_name").showIf(!b).end().find(".hidden_name").showIf(b)}).change(),c("#groups_data").find(".group_weight").change(function(a){var b=c(this).parents(".group"),d=b.find(".assignment_group_url").attr("href"),e=b.getFormData(),f={};f["assignment_group[group_weight]"]=e.group_weight,c.ajaxJSON(d,"PUT",f,function(a){b.find(".group_weight").val(a.assignment_group.group_weight),r(!0)}),r()}).end().find(".cancel_button").click(function(){c("#groups_data").dialog("close")}).end().find("#class_weighting_policy").change(function(a){var b=c(".weighting_policy_url").attr("href"),d={},e=c(this).attr("checked"),f=c(this);d["course[group_weighting_scheme]"]=e?"percent":"equal",c.ajaxJSON(b,"PUT",d,function(a){f.attr("checked",a.course.group_weighting_scheme=="percent"),x.pointCalculations=!c("#class_weighting_policy").attr("checked"),r(!0)})}),setTimeout(p,500)},m=navigator.appName,n=parseFloat(navigator.appVersion),q=navigator.productSub||"20070000",s=c("#student_names .outer_student_name").length;isNaN(n)&&(n=null);var t=function(){c("#no_students_message, #gradebook_table, .datagrid").addClass("hidden-readable");var b=function(a,b){b.length>1&&(b=b.substring(1)),b=b.replace(/\//g,"_");if(b.indexOf("student")==0||b.indexOf("assignment")==0||b.indexOf("submission")==0){var e=c("#"+b),f=d.position(e.parent()),g=f.row,h=f.column;d.scrollTo(g,h),e.parent().trigger("mouseover")}},e=c("#gradebook_entry_template").html();d.init(c("#gradebook_table"),{templateCellHTML:function(a,b){var c=id_maps["row_"+a],d=id_maps["column_"+b],f=id_maps["hard_coded_"+b]?"hard_coded":"";return e.replace(/ASSIGNMENT_ID/g,d).replace(/USER_ID/g,c).replace(/HARD_CODED_CLASS/g,f)},scroll:function(){H.hide()},onReady:function(){function e(){var a=c(".mute_icon:visible"),b=c("#datagrid_data .row, #datagrid_top .row");a.each(function(a,b){var d=c(b),e=d.parents(".column_header");index=e.data("column"),$column=c(".content div[data-column= "+index+"]"),$column.width($column.width()+20)}),b.width(b.width()+a.length*20)}function f(a){var b=i.shift();b?(d.toggleColumn(d.position(c(b)).column,!1,{callback:!1,skipSizeGrid:!0}),a>5?setTimeout(function(){f(0)},500):f(a+1)):(d.sizeGrid(),e())}function g(){for(var a=0;a<k;a++){var b=x.queuedSubmissions&&x.queuedSubmissions.shift();b&&j(b)}x.queuedSubmissions&&x.queuedSubmissions.length?setTimeout(g,1):x.makeAccessible()}c(".table_entry.hard_coded .pct").text("%"),object_data=object_data||{},object_data.grid=!0,c(document).fragmentChange(b),c(document).fragmentChange();var h=c.grep((c.store.userGet("hidden_columns_"+J)||"").split(/,/),function(a){return a}),i=[];h.length&&c("#"+h.join(",#")).parent().each(function(){i.push(this)}),c.store.userGet("show_attendance_"+J)!="true"&&c(".cell.assignment_name.attendance").each(function(){i.push(this)}),setTimeout(function(){f(0)},50);var k=a.browser.ie?25:100;setTimeout(g,1)},tick:function(){y.progressbar("option","value",y.progressbar("option","value")+25/s)},toggle:function(a,b){var e=d.cells["0,"+a],f=e.children(".assignment_header").attr("id"),g=c.grep((c.store.userGet("hidden_columns_"+J)||"").split(/,/),function(a){return a&&(!b||a!=f)});b||g.push(f),g=c.uniq(g),c.store.userSet("hidden_columns_"+J,g.join(","))}})};m&&n&&(m.match(/Netscape/&&q<"20080000")||m.match(/Internet Explorer/)&&n<5)?setTimeout(t,50):t();var v=function(){object_data&&object_data.grid&&object_data.assignments&&object_data.students&&!v.initialized&&(v.initialized=!0,c("#gradebook_table, .datagrid, #no_students_message").removeClass("hidden-readable"),c("#loading_gradebook_message").hide(),c(window).triggerHandler("resize"),setTimeout(e,500)),object_data&&object_data.grid&&object_data.assignments&&object_data.students&&object_data.submissions?(c(".student_assignment .table_entry").css("visibility",""),y.progressbar("option","value",y.progressbar("option","value")+50),c("#sort_rows_dialog .grade_sorts").show(),c(window).triggerHandler("resize"),setTimeout(x.populate,1)):setTimeout(v,1)};setTimeout(v,1);var D=function(){function a(){var a=y.progressbar("option","value")||15;a<85&&(a=Math.min(a+1,85),y.progressbar("option","value",a))}function d(f,g,h){c.ajaxJSON(f,"GET",{},function(b){e++,object_data=object_data||{};if(g=="assignments"){y.progressbar("option","value",y.progressbar("option","value")+10);for(var d in b)x.assignmentIndexes[b[d].assignment.id]=d+1,object_data["assignment_"+b[d].assignment.id]=b[d];object_data.assignments=!0}else if(g=="students"){y.progressbar("option","value",y.progressbar("option","value")+10);for(var d in b)x.studentIndexes[b[d].user.id]=d+1,object_data["student_"+b[d].user.id]=b[d];object_data.students=!0}else{a();var f=[];for(var d in b)object_data["submission_"+b[d].submission.user_id+"_"+b[d].submission.assignment_id]=b[d],j(b[d].submission),f.push(b[d].submission.user_id);object_data.student_submissions_count=object_data.student_submissions_count||0,object_data.student_submissions_count=object_data.student_submissions_count+(h||1),f=c.uniq(f);for(var d in f)c(".table_entry.student_"+f[d]).css("visibility","");object_data.student_submissions_count>=(object_data.students_count||1)&&(object_data.submissions=!0)}},function(a){d.errors=d.errors||0,d.errors++,d.errors>10?c("#loading_gradebook_status").text(b.t("errors.failed_to_load","Gradebook failed to load, please try refreshing the page")):setTimeout(function(){d(f)},50)})}var e=0;y.progressbar("option","value",y.progressbar("option","value")+5),setInterval(function(){e<3&&a()},250);var f=location.href.split("#")[0];f+=location.href.match(/\?/)?"&":"?",d(f+"init=1&assignments=1","assignments"),d(f+"init=1&students=1","students"),object_data=object_data||{},object_data.students_count=c("#student_names .outer_student_name").length;var g=Math.round(200/(c("#assignment_names .outer_assignment_name").length||1)),h=[];setTimeout(function(){if(c("#student_names .outer_student_name .assignment_header").length===0){object_data.submissions=!0;return}c("#student_names .outer_student_name .assignment_header").each(function(){var a=(c(this).attr("id")||"").substring(14);a&&h.push(a),h.length>g&&(d(f+"init=1&submissions=1&user_ids="+h.join(","),"student_submissions",h.length),h=[])}),h.length>0&&d(f+"init=1&submissions=1&user_ids="+h.join(","),"student_submissions",h.length)},1)};if(!object_data||!object_data.pre_initialized)D();else{for(var F in object_data)object_data[F].submission&&j(object_data[F].submission);object_data.assignments=!0,object_data.students=!0,object_data.submissions=!0}setTimeout(function(){x.curve=function(){var a=0,b={},d=E.getFormData(),e=h(c("#assignment_"+d.assignment_id).parent()),f=e.points_possible,g=[],i=0,j=parseInt(c("#middle_score").val(),10);c(".table_entry.assignment_"+d.assignment_id).each(function(){var a=h(c(this).parent());if(a.score||d.assign_blanks)b[a.user_id]=a.score||0}),j/=f;if(isNaN(j))return;for(var a in b){var k=b[a];k>f&&(k=f),k<0&&(k=0),g[parseInt(k,10)]=g[parseInt(k,10)]||[],g[parseInt(k,10)].push([a,k||0]),i++}var l=[.006,.012,.028,.04,.068,.106,.159,.227,.309,.401,.5,.599,.691,.773,.841,.894,.933,.96,.977,.988,1],m=(1-j)/Math.floor(l.length/2),n=[],o=[];for(var a=0;a<l.length;a++)o.push(1-m*a),n.push(Math.round((1-m*a)*f));var p=0,q={},r=0;c("#results_list").empty(),c("#results_values").empty();var s=[];for(var a=g.length-1;a>=0;a--){var t=g[a]||[],k=Math.round(n[r]);for(var u in t){var v=t[u];q[v[0]]=k,v[1]==0&&(q[v[0]]=0),finalScore=q[v[0]],s[finalScore]=s[finalScore]||[],s[finalScore].push(v[0])}p+=t.length;while(p>l[r]*i)r++}var w=0;for(var a=s.length-1;a>=0;a--){var x=(s[a]||[]).length;x>w&&(w=x)}var y=15,z=0;for(var a=s.length-1;a>=0;a--){t=s[a];var A=0,x=0;if(t||z>f/10){t&&(A=t.length/w,x=t.length);var B=a===0?"#ee8":"#cdf";c("#results_list").prepend("<td style='padding: 1px;'><div title='"+x+" student"+(x==1?"":"s")+" will get "+a+" points' style='border: 1px solid #888; background-color: "+B+"; width: "+y+"px; height: "+100*A+"px; margin-top: "+100*(1-A)+"px;'>&nbsp;</div></td>"),c("#results_values").prepend("<td style='text-align: center;'>"+a+"</td>"),z=0}else z++}return c("#results_list").prepend("<td><div style='height: 100px; position: relative; width: 30px; font-size: 0.8em;'><img src='/images/number_of_students.png' alt='# of students'/><div style='position: absolute; top: 0; right: 3px;'>"+w+"</div><div style='position: absolute; bottom: 0; right: 3px;'>0</div></div></td>"),c("#results_values").prepend("<td>&nbsp;</td>"),q},c("#middle_score").bind("blur change keyup focus",function(){x.curve()}),c("#assign_blanks").change(function(){x.curve()}),A.find(".close_button").click(function(){A.dialog("close")}),E.formSubmit({processData:function(a){var c=0;curves=x.curve();for(var d in curves){var e="submissions[submission_"+d+"]";a[e+"[assignment_id]"]=a.assignment_id,a[e+"[user_id]"]=d,a[e+"[grade]"]=curves[d],c++}return c===0?(E.errorBox(b.t("errors.none_to_update","None to Update")),!1):a},beforeSubmit:function(a){E.loadingImage().find(".cancel_button").attr("disabled",!0)},success:function(a){E.loadingImage("remove");for(var c in a){var d=a[c].submission;j(d),R.push(d.user_id)}alert(b.t("alerts.scores_updated",{one:"1 Student score updated",other:"%{count} Student scores updated"},{count:a.length})),E.find(".cancel_button").attr("disabled",!1).dialog("close")},error:function(a){E.loadingImage("remove")}}).find(".cancel_button").click(function(){E.dialog("close")})},1500),c("#gradebook_options").live("click",function(a){a.preventDefault(),a.stopPropagation();var d={},e=function(a,b,c){var e='<span class="ui-icon ui-icon-'+a+'" /> '+b;d[e]=c};e("carat-2-e-w",b.t("sort_columns_by","Sort Columns By..."),function(){c(".sort_gradebook").each(function(){c(this).attr("disabled",!1).text(c(this).attr("title"))}),c("#sort_columns_dialog").dialog("close").dialog({autoOpen:!1,width:400,height:300}).dialog("open")}),e("carat-2-n-s",b.t("sort_rows_by","Sort Rows By..."),function(){c(".sort_gradebook").each(function(){c(this).attr("disabled",!1).text(c(this).attr("title"))}),c("#sort_rows_dialog").dialog("close").dialog({autoOpen:!1,width:400,height:300}).dialog("open")}),e("pencil",b.t("set_group_weights","Set Group Weights"),function(){c("#groups_data").dialog("close").dialog({title:b.t("titles.assignment_groups","Assignment Groups"),autoOpen:!1}).dialog("open").show()}),e("clock",b.t("view_grading_history","View Grading History"),function(){window.location.href=c(".gradebook_history_url").attr("href")}),e("disk",b.t("download_scores","Download Scores (%{format})",{format:".csv"}),function(){window.location.href=c(".gradebook_csv_url").attr("href")}),e("clock",b.t("upload_scores","Upload Scores (from %{format})",{format:".csv"}),function(){var a={bgiframe:!0,autoOpen:!1,modal:!0,width:410,resizable:!1,buttons:{}};a.buttons[b.t("buttons.upload_data","Upload Data")]=function(){c(this).submit()},c("#upload_modal").dialog(a).dialog("open")});var f=c("#hide_students_option").attr("checked");e("person",f?b.t("show_student_name","Show Student Names"):b.t("hide_student_name","Hide Student Names"),function(){c("#hide_students_option").attr("checked",!f).change()}),e("check",K?b.t("include_ungraded","Include Ungraded Assignments"):b.t("ignore_ungraded","Ignore Ungraded Assignments"),function(){K=!K,x.updateAllStudentGrades()});if(g.size(L)>1){var h=O?b.t("showing_section","Showing Section: %{section}",{section:L[O]}):b.t("showing_all_sections","Showing All Sections");e("search",h,function(){var a={modal:!0,resizable:!1,buttons:{}};a.buttons[b.t("buttons.change_section","Change Section")]=function(){var a=c("#section_to_show_dialog select").val();c.store[a=="all"?"userRemove":"userSet"]("grading_show_only_section"+N,a),window.location.reload()};var d=c("#section_to_show_dialog").dialog(a),e=d.find("select");e.find("[value != all]").remove();for(var f in L)e.append('<option value="'+f+'" '+(O==f?"selected":"")+" >"+L[f]+"</option>")})}sisPublishEnabled&&e("gear",'<a href="details#tab-grade-publishing">'+b.t("publish_to_sis","Publish grades to SIS")+"</a>",function(){}),c(this).dropdownList({options:d})}),c(".sort_gradebook").click(function(a){a.preventDefault();var d=c(this);if(d.hasClass("by_grade")&&!x.finalGradesReady){d.attr("disabled",!0).text(b.t("computing_grades","Computing Grades...")),setTimeout(function(){d.filter(":visible").length>0&&d.click()},1e3);return}d.attr("disabled",!1),d.text(d.attr("title")),d.hasClass("sort_rows")?sortStudentRows(function(a){return d.hasClass("by_secondary_identifier")?[a.secondary_identifier,a.display_name,a.course_section]:d.hasClass("by_section")?[a.course_section,a.display_name,a.secondary_identifier]:d.hasClass("by_grade_desc")?[-a.grade,a.display_name,a.secondary_identifier,a.course_section]:d.hasClass("by_grade_asc")?[a.grade,a.display_name,a.secondary_identifier,a.course_section]:[a.display_name,a.secondary_identifier,a.course_section]}):sortAssignmentColumns(function(a){var b=[a.special_sort,a.date_sortable||"1050-12-12T99:99",a.title];return d.hasClass("by_group")&&b.unshift(parseInt(a.groupData[a.group_id||a.id.toString().substring(6)],10)),b}),c("#sort_rows_dialog").dialog("close"),c("#sort_columns_dialog").dialog("close")}),c("#content").delegate(".mute_icon","click.mute",function(a){var d=c(a.currentTarget),e=d.siblings("a.assignment_link.assignment_title"),f=b.t("cancel_button","Cancel"),g=b.t("unmute_button","Unmute Assignment"),h={},i=c("#unmute_dialog"),j=c("#datagrid_data .row, #datagrid_top .row"),k=e.attr("href")+"/mute";h[g]=function(){i.dialog("close"),c.ajaxJSON(k,"put",{status:!1},function(a){var b="assignment_"+a.assignment.id,d=c("#"+b),e=d.parent(),f=e.data("column"),g=c(".content div[data-column="+f+"]");d.find("a.assignment_link.assignment_options").data("muted",!1),d.find(".mute_icon").remove(),g.width(g.width()-20),j.width(j.width()-20)})},h[f]=function(){i.dialog("close")},i.dialog({buttons:h,modal:!0,resizable:!1,title:i.data("title"),width:400})})});var R=[];x.finalGradesReady=!0;var S={};window.sortStudentRows=function(a){var b=c(".outer_student_name"),e=[];b.each(function(){var a=c(this).getTemplateData({textValues:["display_name","secondary_identifier","course_section"]});a.display_name=(a.display_name||"zzzzzzz").toLowerCase(),a.secondary_identifier=(a.secondary_identifier||"zzzzzzz").toLowerCase(),a.course_section=(a.course_section||"zzzzzzz").toLowerCase(),a.id=c(this).find(".assignment_header").attr("id").substring(14),a.grade=parseFloat(c(".student_"+a.id+".assignment_final-grade .grade").text())||0,e.push(a)});var f=[];for(var g in e){var h=e[g],i=a(h);i.student=h,f.push(i)}f=f.sort(function(a,b){for(var c in a){var d=a[c],e=b[c];if(d<e)return-1;if(d>e)return 1}return 0}),e=[];for(var g in f)e.push(f[g].student);var j=[0],k=["--"];c.each(e,function(a,b){var e=c("#student_"+b.id).parents(".cell");j.push(d.position(e).row),k.push(e.find(".display_name").text());return}),d.reorderRows(j)},window.reverseRows=function(){var a=[0];for(var b=d.rows.length-1;b>0;b--)a.push(b);d.reorderRows(a)},window.sortAssignmentColumns=function(a){var b=c(".outer_assignment_name"),e=[],f={};c("#groups_data .group").each(function(a){var b=c(this).find(".assignment_group_id").text();f[b]=a}),b.each(function(){var a=c(this),b=a.data("assignment_object");b.groupData=f,e.push(b)});var g=[];for(var h in e){var i=e[h],j=a(i);j.assignment=i,g.push(j)}g=g.sort(),e=[];for(var h in g)e.push(g[h].assignment);var k=[0],l=["--"];c.each(e,function(a,b){var e=c("#assignment_"+b.id).parents(".cell");k.push(d.position(e).column),l.push(e.find(".assignment_title").text());return}),d.reorderColumns(k)},c(document).ready(function(){c(document).bind("update_student_grades",function(a,b){t(b)})}),c.fn.gradebookLoading=function(a){this.find(".refresh_grades_link").find(".static").showIf(a).end().find(".animated").showIf(!a)}}),function(){require(["gradebooks","message_students","compiled/grade_calculator"])}.call(this),define("compiled/bundles/gradebooks",function(){})