(function(){var a=Object.prototype.hasOwnProperty,b=function(b,c){function e(){this.constructor=b}for(var d in c)a.call(c,d)&&(b[d]=c[d]);return e.prototype=c.prototype,b.prototype=new e,b.__super__=c.prototype,b};define(["jquery","use!underscore","compiled/backbone-ext/Backbone","compiled/str/splitAssetString"],function(a,c,d,e){var f;return f=function(){function f(){f.__super__.constructor.apply(this,arguments)}return b(f,d.Model),f.prototype.urlRoot="/api/v1/calendar_events/",f.prototype.dateAttributes=["created_at","end_at","start_at","updated_at"],f.prototype._filterAttributes=function(a){var b,d,e,f,g;d={},g=["start_at","end_at","title","description","context_code"];for(e=0,f=g.length;e<f;e++)b=g[e],d[b]=a[b];return a.use_section_dates&&a.child_event_data&&(d.child_event_data=c.chain(a.child_event_data).compact().filter(this._hasValidInputs).map(this._filterAttributes).value()),d},f.prototype._hasValidInputs=function(a){return a.start_date&&!!a.start_time==!!a.end_time},f.prototype.toJSON=function(a){var b;return b=f.__super__.toJSON.apply(this,arguments),a?b:{calendar_event:this._filterAttributes(b)}},f.prototype.fetch=function(b){var e,g,h,i,j,k;return b==null&&(b={}),b=c.clone(b),h=this,j=b.success,delete b.success,g=d.wrapError(b.error,h,b),delete b.error,this.get("id")&&(k=(this.sync||d.sync).call(this,"read",this,b)),this.get("sections_url")&&(i=a.getJSON(this.get("sections_url"))),e=function(a,c){var d,e,g,i,k;return a==null&&(a=[]),c==null&&(c=[]),g=a[0],i=a[1],k=a[2],e=c[0],d=f.mergeSectionsIntoCalendarEvent(g,e),h.set(h.parse(d,k),b)?typeof j=="function"?j(h,d):void 0:!1},a.when(k,i).fail(g).done(e)},f.mergeSectionsIntoCalendarEvent=function(a,b){var d;return a==null&&(a={}),a.course_sections=b,a.use_section_dates=(d=a.child_events)!=null?!!d.length:!!void 0,c(a.child_events).each(function(d,g){var h,i;return d=a.child_events[g]=f.prototype.parse(d),i=e(d.context_code)[1],h=c(b).find(function(a){return a.id===i}),h.event=d}),a},f}()})}).call(this)